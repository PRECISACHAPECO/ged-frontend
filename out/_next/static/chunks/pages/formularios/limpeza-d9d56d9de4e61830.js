(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1132],{94156:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/formularios/limpeza",function(){return a(60603)}])},93250:function(e,t,a){"use strict";var s=a(85893),n=a(49837),o=a(91359),i=a(95722);let l=e=>{let{result:t,columns:a,btnNew:l=!0,btnPrint:r=!0,btnBack:d,openModal:c}=e;return(0,s.jsx)(n.Z,{children:(0,s.jsx)(o.Z,{sx:{pt:"0"},children:(0,s.jsx)(i.Z,{rows:t,columns:a,buttonsHeader:{btnNew:l,btnPrint:r,btnBack:d,openModal:c}})})})};t.Z=l},96351:function(e,t,a){"use strict";a.d(t,{Z:function(){return c}});var s=a(85893),n=a(67294),o=a(99070),i=a(40874),l=a(60664);let r=e=>{let[t,a]=(0,n.useState)([]);return(0,n.useEffect)(()=>{let t=async()=>{await l.h.post("relatorio/recebimentoMp/dadosRecebimentoMp",{data:e}).then(e=>a(e.data))};t()},[e]),t},d=e=>{var t,a,l,d,c,u,x,m,p;let{params:h}=e,b=r(h);return console.log(" data recebimento",b),(0,s.jsx)(s.Fragment,{children:b&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.G7,{style:i.W.containerFields,children:null===(t=b.fields)||void 0===t?void 0:t.map((e,t)=>(0,s.jsxs)(n.Fragment,{children:[(0,s.jsxs)(o.G7,{style:[i.W.fields,{width:"33%"}],children:[(0,s.jsx)(o.xv,{style:i.W.fieldTitle,children:null!==(d=e.title)&&void 0!==d?d:"NI"}),(0,s.jsx)(o.xv,{style:i.W.fieldValue,children:null!==(c=e.value)&&void 0!==c?c:"NI"})]}),(t+1)%3==0&&(0,s.jsx)(o.G7,{style:i.W.separator})]},t))}),(0,s.jsx)(o.G7,{style:i.W.separator}),(0,s.jsx)(o.xv,{style:[i.W.blockTitle,{paddingTop:20}],children:"Produtos"}),(0,s.jsxs)(o.G7,{style:i.W.table,children:[(0,s.jsxs)(o.G7,{style:i.W.tableTitle,children:[(0,s.jsx)(o.xv,{style:[i.W.tableTitlecolumn,{width:"60%"}],children:"Produto"}),(0,s.jsx)(o.xv,{style:[i.W.tableTitlecolumn,{width:"20%",borderLeft:"1px solid #ddd"}],children:"Apresenta\xe7\xe3o"}),(0,s.jsx)(o.xv,{style:[i.W.tableTitlecolumn,{width:"20%",borderLeft:"1px solid #ddd"}],children:"Atividade"})]}),null===(a=b.produtos)||void 0===a?void 0:a.map((e,t)=>(0,s.jsx)(o.G7,{children:(0,s.jsxs)(o.G7,{style:i.W.tableContainer,children:[(0,s.jsx)(o.G7,{style:[i.W.tableContent,{width:"60%"}],children:(0,s.jsx)(o.xv,{style:i.W.tableContentcolumn,children:e.produto})}),(0,s.jsx)(o.G7,{style:[i.W.tableContent,{width:"20%"}],children:(0,s.jsx)(o.xv,{style:i.W.tableContentcolumn,children:null!==(u=e.apresentacao)&&void 0!==u?u:"--"})}),(0,s.jsx)(o.G7,{style:[i.W.tableContent,{width:"20%"}],children:(0,s.jsx)(o.xv,{style:i.W.tableContentcolumn,children:null!==(x=e.atividade)&&void 0!==x?x:"--"})})]})},t))]}),(0,s.jsx)(o.G7,{style:i.W.separator}),null===(l=b.blocos)||void 0===l?void 0:l.map((e,t)=>(0,s.jsxs)(o.G7,{style:e,children:[(0,s.jsx)(o.xv,{style:[i.W.blockTitle,{paddingTop:20}],children:e.nome}),(0,s.jsxs)(o.G7,{style:i.W.table,children:[(0,s.jsxs)(o.G7,{style:i.W.tableTitle,children:[(0,s.jsx)(o.xv,{style:[i.W.tableTitlecolumn,{width:"60%"}],children:"Item"}),(0,s.jsx)(o.xv,{style:[i.W.tableTitlecolumn,{width:"20%",borderLeft:"1px solid #ddd"}],children:"Resposta"}),(0,s.jsx)(o.xv,{style:[i.W.tableTitlecolumn,{width:"20%",borderLeft:"1px solid #ddd"}],children:"Observa\xe7\xe3o"})]}),e.itens.map((e,t)=>(0,s.jsxs)(o.G7,{style:i.W.tableContainer,children:[(0,s.jsx)(o.G7,{style:[i.W.tableContent,{width:"60%"}],children:(0,s.jsx)(o.xv,{style:i.W.tableContentcolumn,children:e.nome})}),(0,s.jsx)(o.G7,{style:[i.W.tableContent,{width:"20%"}],children:(0,s.jsx)(o.xv,{style:i.W.tableContentcolumn,children:null!==(m=e.resposta)&&void 0!==m?m:"--"})}),(0,s.jsx)(o.G7,{style:[i.W.tableContent,{width:"20%"}],children:(0,s.jsx)(o.xv,{style:i.W.tableContentcolumn,children:null!==(p=e.obsResposta)&&void 0!==p?p:"--"})})]}))]})]},t))]})})};var c=d},60603:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return G}});var s=a(85893),n=a(67294),o=a(60664),i=a(93250),l=a(87536),r=a(56531),d=a(79139),c=a(34282),u=a(96351),x=a(29308),m=a(19604),p=a(49837),h=a(91359),b=a(79072),f=a(55343),v=a(29630),j=a(11163),g=a.n(j),y=a(46749),C=a(36188),D=a(60565),w=a(83830),I=a(40039),Z=a(39976),S=a(47842),W=a(86501),z=a(66136),N=a(80377);let P=e=>{let{id:t}=e,{user:a,loggedUnity:i}=(0,n.useContext)(I.V),[j,D]=(0,n.useState)(!1),[P,k]=(0,n.useState)(!1),[G,T]=(0,n.useState)(!1),[E,F]=(0,n.useState)(!0),[M,L]=(0,n.useState)(null),{createNewNotification:_}=(0,n.useContext)(Z.u),[O,H]=(0,n.useState)(!1),[R,V]=(0,n.useState)([]),[A,B]=(0,n.useState)(null),[X,U]=(0,n.useState)([]),[J,K]=(0,n.useState)(""),[q,Q]=(0,n.useState)(!1),[Y,$]=(0,n.useState)({status:!1,errors:[]}),{settings:ee}=(0,n.useContext)(z.J6),{setId:et}=(0,n.useContext)(w.X),[ea,es]=(0,n.useState)({status:!1,message:"Voc\xea n\xe3o tem permiss\xf5es",messageType:"info"}),en=g(),eo=t&&t>0?"edit":"new",ei=en.pathname,{reset:el,register:er,getValues:ed,setValue:ec,control:eu,watch:ex,handleSubmit:em,clearErrors:ep,setError:eh,formState:{errors:eb}}=(0,l.cI)(),ef=async e=>{let s={status:e,auth:{usuarioID:a.usuarioID,papelID:a.papelID,unidadeID:i.unidadeID}};try{k(!0),await o.h.post("".concat(ei,"/changeFormStatus/").concat(t),s).then(t=>{W.ZP.success(y.OD.successUpdate),k(!1),eI(e,null,null)})}catch(n){console.log(n)}},ev=[{id:1,name:"Dados do Recebimento de MP",component:(0,s.jsx)(u.Z,{params:{id:t,unidadeID:1}}),route:"/relatorio/recebimentoMp/dadosRecebimentoMp",papelID:a.papelID,identification:"01",params:{fornecedorID:t}},{id:2,name:"Declara\xe7\xe3o de prolifici\xeancia",component:(0,s.jsx)(u.Z,{params:{id:t,unidadeID:1}}),route:"/relatorio/recebimentoMp/dadosRecebimentoMp",papelID:a.papelID,identification:"02",params:{fornecedorID:t}}],ej=async()=>{try{await o.h.post("".concat(ei,"/verifyFormPending/").concat(t),{parFormularioID:4}).then(e=>{F(e.data) //! true/false
})}catch(e){console.log(e)}},eg=()=>{try{D(!0),o.h.post("".concat((0,y.g_)(ei),"/new/getData"),{unidadeID:i.unidadeID}).then(e=>{console.log("getNewData: ",e.data),V(e.data.fields),U(e.data.blocos),K(e.data.info),el(e.data),es({status:!0,message:'Esse formul\xe1rio j\xe1 foi conclu\xeddo! Para alter\xe1-lo \xe9 necess\xe1rio atualizar seu Status para "Em preenchimento" atrav\xe9s do bot\xe3o "Status"!',messageType:"info"}),D(!1)})}catch(e){console.log("\uD83D\uDE80 ~ error:",e)}},ey=()=>{D(!0),t&&o.h.post("".concat(ei,"/getData/").concat(t),{type:eo,unidadeID:i.unidadeID}).then(e=>{var t,a,s,n;console.log("getData: ",e.data),V(e.data.fields),U(e.data.blocos),K(e.data.info),el(e.data),L(y.WR[null==e?void 0:null===(t=e.data)||void 0===t?void 0:null===(a=t.info)||void 0===a?void 0:a.status]),es({status:(null==e?void 0:null===(s=e.data)||void 0===s?void 0:null===(n=s.info)||void 0===n?void 0:n.status)<40,message:'Esse formul\xe1rio j\xe1 foi conclu\xeddo! Para alter\xe1-lo \xe9 necess\xe1rio atualizar seu Status para "Em preenchimento" atrav\xe9s do bot\xe3o "Status"!',messageType:"info"}),ej(),D(!1)})},eC=()=>{ep();let e=!1,t=[];null==R||R.forEach((a,s)=>{let n=a.tabela?"fields[".concat(s,"].").concat(a.tabela):"fields[".concat(s,"].").concat(a.nomeColuna),o=ed(n);1!==a.obrigatorio||o||(eh(n,{type:"manual",message:"Campo obrigat\xf3rio"}),t.push(null==a?void 0:a.nomeCampo),e=!0)}),X.forEach((a,s)=>{a.itens.forEach((a,n)=>{let o=ed("blocos[".concat(s,"].itens[").concat(n,"].resposta"));(null==a?void 0:a.obrigatorio)!==1||o||(eh("blocos[".concat(s,"].itens[").concat(n,"].resposta"),{type:"manual",message:"Campo obrigat\xe1rio"}),t.push(null==a?void 0:a.nome),e=!0)})}),$({status:e,errors:t})},eD=()=>{eC(),Q(!0),T(!0)},ew=async e=>{e.conclusion=!0,await em(eZ)(e)},eI=(e,s,n)=>{let o=30==e?"Em preenchimento":40==e?"Conclu\xeddo":50==e?"Reprovado":60==e?"Aprovado parcialmente":70==e?"Aprovado":"Pendente",l={titulo:"Formul\xe1rio de Limpeza ".concat(o),descricao:"O formul\xe1rio de Limpeza #".concat(t," est\xe1 ").concat(o,"."),url:"/formularios/limpeza/",urlID:t,tipoNotificacaoID:6,usuarioGeradorID:a.usuarioID,usuarioID:0,unidadeID:i.unidadeID,papelID:1};if(l&&(_(l),s)){let r={titulo:"Limpeza gerada",descricao:"O formul\xe1rio de Limpeza #".concat(t," est\xe1 ").concat(o," e gerou uma n\xe3o conformidade."),url:"/formularios/limpeza/nao-conformidade/",urlID:n,tipoNotificacaoID:5,usuarioGeradorID:a.usuarioID,usuarioID:0,unidadeID:i.unidadeID,papelID:1};_(r)}},eZ=async function(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!0===s.conclusion&&s.status>10&&(e.status=s.status,e.obsConclusao=s.obsConclusao);let n={form:e,auth:{usuarioID:a.usuarioID,papelID:a.papelID,unidadeID:i.unidadeID}};try{"edit"==eo?(k(!0),await o.h.post("".concat(ei,"/updateData/").concat(t),n).then(t=>{W.ZP.success(y.OD.successUpdate),k(!1);let a=null;t.data&&t.data.naoConformidade&&t.data.id>0&&(en.push("/formularios/limpeza/nao-conformidade/"),et(t.data.id),a=t.data.id),eI(e.status,e.naoConformidade,a)})):"new"==eo?await o.h.post("".concat((0,y.g_)(ei),"/insertData"),n).then(e=>{en.push("".concat((0,y.g_)(ei))),et(e.data),W.ZP.success(y.OD.successNew)}):W.ZP.error(y.OD.error)}catch(l){console.log(l)}};return(0,n.useEffect)(()=>{"new"==eo?eg():ey()},[t,P]),(0,n.useEffect)(()=>{eC()},[]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(S.Z,{show:j}),(0,s.jsxs)("form",{onSubmit:em(eZ),children:[!ea.status&&(0,s.jsx)(m.Z,{severity:ea.messageType,sx:{mb:2},children:ea.message}),(0,s.jsxs)(p.Z,{children:[(0,s.jsx)(C.Z,{btnCancel:!0,btnSave:(null==J?void 0:J.status)<40||"new"==eo,btnSend:"edit"==eo&&(null==J?void 0:J.status)<50,btnPrint:"edit"==eo,generateReport:y.OE,actionsData:ev,actions:!0,handleSubmit:()=>em(eZ),handleSend:eD,iconConclusion:"mdi:check-bold",titleConclusion:"Aprovar Limpeza",title:"Limpeza",btnStatus:"edit"==eo,handleBtnStatus:()=>H(!0),type:eo,status:M}),(0,s.jsx)(h.Z,{children:(0,s.jsx)(r.Z,{register:er,errors:eb,setValue:ec,control:eu,fields:R,values:R,disabled:!ea.status})})]}),X&&X.map((e,t)=>(0,s.jsx)(d.Z,{index:t,blockKey:"parLimpezaModeloBlocoID",values:e,control:eu,register:er,setValue:ec,errors:eb,disabled:!ea.status},t)),J&&(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(p.Z,{sx:{mt:4},children:(0,s.jsx)(h.Z,{children:(0,s.jsx)(b.ZP,{container:!0,spacing:4,children:(0,s.jsx)(b.ZP,{item:!0,xs:12,md:12,children:(0,s.jsxs)(f.Z,{fullWidth:!0,children:[(0,s.jsx)(v.Z,{variant:"subtitle1",sx:{fontWeight:600,mb:2},children:"Observa\xe7\xf5es (campo de uso exclusivo da validadora)"}),(0,s.jsx)(x.Z,{title:"Observa\xe7\xe3o (opcional)",name:"info.obs",multiline:!0,rows:4,value:J.obs,disabled:!ea.status,control:eu})]})})})})})}),O&&(0,s.jsx)(c.Z,{id:t,parFormularioID:2,formStatus:J.status,hasFormPending:E,canChangeStatus:J.status>30&&!E,openModal:O,handleClose:()=>H(!1),title:"Hist\xf3rico do Formul\xe1rio",text:"Listagem do hist\xf3rico das movimenta\xe7\xf5es do formul\xe1rio ".concat(t," de Limpeza e Higieniza\xe7\xe3o."),btnCancel:!0,btnConfirm:!0,handleSubmit:ef}),(0,s.jsx)(N.Z,{openModal:q,handleClose(){Q(!1),T(!1)},title:"Concluir Formul\xe1rio",text:"Deseja realmente concluir este formul\xe1rio?",info:J,canChange:!E,register:er,setValue:ec,getValues:ed,btnCancel:!0,btnConfirm:!0,btnConfirmColor:"primary",conclusionForm:ew,listErrors:Y})]})]})},k=()=>{let{user:e,loggedUnity:t}=(0,n.useContext)(I.V),[a,l]=(0,n.useState)(null),r=(0,j.useRouter)(),d=r.pathname,{setTitle:c}=(0,n.useContext)(D.f),{id:u}=(0,n.useContext)(w.X),x=async()=>{await o.h.get("".concat(d,"/getList/").concat(t.unidadeID)).then(e=>{l(e.data),c({title:"Limpeza e Higieniza\xe7\xe3o",subtitle:{id:u,count:e.data.length,new:!1}})})};(0,n.useEffect)(()=>{x()},[u]);let m=(0,y.OL)(d,[{headerName:"ID",field:"id",size:.1},{headerName:"Data",field:"data",size:.1},{headerName:"Profissional",field:"profissional",size:.2},{headerName:"Modelo",field:"modelo",size:.2},{headerName:"Status",field:"status",size:.2}]);return(0,s.jsx)(s.Fragment,{children:a?u&&u>0?(0,s.jsx)(P,{id:u}):(0,s.jsx)(i.Z,{result:a,columns:m}):(0,s.jsx)(S.Z,{show:!0})})};var G=k},84242:function(e,t,a){"use strict";a.d(t,{Z:function(){return y}});var s=a(85893),n=a(61953),o=a(67836),i=a(80562),l=a(50853),r=a(11163),d=a.n(r),c=a(75084),u=a(41664),x=a.n(u),m=a(40039),p=a(67294),h=a(83830),b=a(46749),f=a(21609);let v=e=>{let{btnNew:t,btnPrint:a,btnSave:n,btnBack:o,handleSave:i,hasListChange:l,openModal:r}=e,u=d(),{setId:v}=(0,p.useContext)(h.X),{routes:j}=(0,p.useContext)(m.V);return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between my-2 w-full",children:[(0,s.jsx)("div",{}),(0,s.jsxs)("div",{className:"flex items-center gap-4 ",children:[(0,s.jsx)("div",{children:o&&(0,s.jsx)(c.Z,{onClick(){u.push((0,b.g_)(u.pathname)),v(null)},type:"button",variant:"outlined",color:"primary",size:"medium",children:(0,s.jsx)(f.Z,{icon:"material-symbols:arrow-back-rounded"})})}),(0,s.jsx)("div",{children:a&&(0,s.jsxs)(c.Z,{onClick:()=>window.print(),type:"button",variant:"outlined",color:"primary",size:"medium",sx:{display:"flex",gap:2},children:[(0,s.jsx)(f.Z,{icon:"mdi:printer"}),(0,s.jsx)("span",{className:"hidden sm:block",children:"Imprimir"})]})}),(0,s.jsx)("div",{className:"",children:t&&j.find(e=>e.rota===u.pathname&&e.inserir)&&(0,s.jsx)(x(),{href:r?"":"".concat(u.pathname,"/novo"),children:(0,s.jsxs)(c.Z,{type:"button",variant:"outlined",color:"primary",size:"medium",onClick:r||null,sx:{display:"flex",gap:2},children:[(0,s.jsx)(f.Z,{icon:"ic:outline-plus"}),(0,s.jsx)("span",{className:"hidden sm:block",children:"Novo"})]})})}),(0,s.jsx)("div",{children:n&&(0,s.jsxs)(c.Z,{onClick:i,disabled:!l,type:"button",variant:"outlined",color:"primary",size:"medium",sx:{display:"flex",gap:2},children:[(0,s.jsx)(f.Z,{icon:"mdi:check-bold"}),(0,s.jsx)("span",{className:"hidden sm:block",children:"Salvar"})]})})]})]})})};var j=a(61225);let g=e=>((0,j.Z)("(min-width:640px)"),(0,s.jsxs)(n.Z,{sx:{display:"flex",flexDirection:"row",gap:2,alignItems:"baseline",justifyContent:"space-between",p:e=>e.spacing(8,0,0,0)},children:[(0,s.jsxs)(n.Z,{sx:{display:"flex",gap:"8px",textAlig:"end"},children:[(0,s.jsx)(o.Z,{size:"medium",value:e.value,onChange:e.onChange,placeholder:"Buscar…",variant:"standard",InputProps:{startAdornment:(0,s.jsx)(n.Z,{sx:{mr:2,display:"flex"},children:(0,s.jsx)(f.Z,{icon:"mdi:magnify",fontSize:20})}),endAdornment:(0,s.jsx)(i.Z,{size:"medium",title:"Clear","aria-label":"Clear",onClick:e.clearSearch,children:(0,s.jsx)(f.Z,{icon:"mdi:close",fontSize:20})})},sx:{width:{xs:1,sm:"auto"},"& .MuiInputBase-root > svg":{mr:2}}}),(0,s.jsx)("div",{className:"hidden sm:block",children:(0,s.jsx)(l.M,{})})]}),(0,s.jsx)(v,{btnNew:e.buttonsHeader.btnNew,btnPrint:e.buttonsHeader.btnPrint,btnBack:e.buttonsHeader.btnBack,btnSave:e.buttonsHeader.btnSave,handleSave:e.buttonsHeader.handleSave,hasListChange:e.hasChange,openModal:e.buttonsHeader.openModal})]}));var y=g},95722:function(e,t,a){"use strict";var s=a(85893),n=a(67294),o=a(87630),i=a(75680),l=a(84242),r=a(60565),d=a(83830);let c=e=>{let{rows:t,columns:a,buttonsHeader:c}=e,{handleSearch:u,pageSize:x,setPageSize:m,searchText:p,filteredData:h,setData:b,data:f}=(0,n.useContext)(r.f),{setId:v}=(0,n.useContext)(d.X);return b(t),(0,s.jsx)(o._,{localeText:i.F.components.MuiDataGrid.defaultProps.localeText,autoHeight:!0,columns:a,pageSize:x,rowsPerPageOptions:[10,20,30,40,50,100],components:{Toolbar:l.Z},rows:p?h:f,onCellClick(e,t){v(e.row.id)},onPageSizeChange:e=>m(e),sx:{"& .MuiDataGrid-cell":{cursor:"pointer",overflow:"scroll"}},componentsProps:{toolbar:{value:p,clearSearch:()=>u(""),onChange:e=>u(e.target.value),buttonsHeader:c}}})};t.Z=c}},function(e){e.O(0,[4186,1445,1111,5999,7536,6668,2187,7630,9516,1515,2708,5348,676,9774,2888,179],function(){return e(e.s=94156)}),_N_E=e.O()}]);