(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3742],{13860:function(t){var e;e=function(){"use strict";var t="millisecond",e="second",n="minute",o="hour",a="week",s="month",r="quarter",i="year",u="date",l="Invalid Date",c=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,d=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,m=function(t,e,n){var o=String(t);return!o||o.length>=e?t:""+Array(e+1-o.length).join(n)+t},h="en",f={};f[h]={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(t){var e=["th","st","nd","rd"],n=t%100;return"["+t+(e[(n-20)%10]||e[n]||"th")+"]"}};var p=function(t){return t instanceof g},x=function t(e,n,o){var a;if(!e)return h;if("string"==typeof e){var s=e.toLowerCase();f[s]&&(a=s),n&&(f[s]=n,a=s);var r=e.split("-");if(!a&&r.length>1)return t(r[0])}else{var i=e.name;f[i]=e,a=i}return!o&&a&&(h=a),a||!o&&h},v=function(t,e){if(p(t))return t.clone();var n="object"==typeof e?e:{};return n.date=t,n.args=arguments,new g(n)},D={s:m,z:function(t){var e=-t.utcOffset(),n=Math.abs(e);return(e<=0?"+":"-")+m(Math.floor(n/60),2,"0")+":"+m(n%60,2,"0")},m:function t(e,n){if(e.date()<n.date())return-t(n,e);var o=12*(n.year()-e.year())+(n.month()-e.month()),a=e.clone().add(o,s),r=n-a<0,i=e.clone().add(o+(r?-1:1),s);return+(-(o+(n-a)/(r?a-i:i-a))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(l){return({M:s,y:i,w:a,d:"day",D:u,h:o,m:n,s:e,ms:t,Q:r})[l]||String(l||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}};D.l=x,D.i=p,D.w=function(t,e){return v(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var g=function(){function m(t){this.$L=x(t.locale,null,!0),this.parse(t)}var h=m.prototype;return h.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if(D.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var o=e.match(c);if(o){var a=o[2]-1||0,s=(o[7]||"0").substring(0,3);return n?new Date(Date.UTC(o[1],a,o[3]||1,o[4]||0,o[5]||0,o[6]||0,s)):new Date(o[1],a,o[3]||1,o[4]||0,o[5]||0,o[6]||0,s)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},h.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},h.$utils=function(){return D},h.isValid=function(){return this.$d.toString()!==l},h.isSame=function(t,e){var n=v(t);return this.startOf(e)<=n&&n<=this.endOf(e)},h.isAfter=function(t,e){return v(t)<this.startOf(e)},h.isBefore=function(t,e){return this.endOf(e)<v(t)},h.$g=function(t,e,n){return D.u(t)?this[e]:this.set(n,t)},h.unix=function(){return Math.floor(this.valueOf()/1e3)},h.valueOf=function(){return this.$d.getTime()},h.startOf=function(t,r){var l=this,c=!!D.u(r)||r,d=D.p(t),m=function(t,e){var n=D.w(l.$u?Date.UTC(l.$y,e,t):new Date(l.$y,e,t),l);return c?n:n.endOf("day")},h=function(t,e){return D.w(l.toDate()[t].apply(l.toDate("s"),(c?[0,0,0,0]:[23,59,59,999]).slice(e)),l)},f=this.$W,p=this.$M,x=this.$D,v="set"+(this.$u?"UTC":"");switch(d){case i:return c?m(1,0):m(31,11);case s:return c?m(1,p):m(0,p+1);case a:var g=this.$locale().weekStart||0,b=(f<g?f+7:f)-g;return m(c?x-b:x+(6-b),p);case"day":case u:return h(v+"Hours",0);case o:return h(v+"Minutes",1);case n:return h(v+"Seconds",2);case e:return h(v+"Milliseconds",3);default:return this.clone()}},h.endOf=function(t){return this.startOf(t,!1)},h.$set=function(a,r){var l,c=D.p(a),d="set"+(this.$u?"UTC":""),m=((l={}).day=d+"Date",l[u]=d+"Date",l[s]=d+"Month",l[i]=d+"FullYear",l[o]=d+"Hours",l[n]=d+"Minutes",l[e]=d+"Seconds",l[t]=d+"Milliseconds",l)[c],h="day"===c?this.$D+(r-this.$W):r;if(c===s||c===i){var f=this.clone().set(u,1);f.$d[m](h),f.init(),this.$d=f.set(u,Math.min(this.$D,f.daysInMonth())).$d}else m&&this.$d[m](h);return this.init(),this},h.set=function(t,e){return this.clone().$set(t,e)},h.get=function(t){return this[D.p(t)]()},h.add=function(t,r){var u,l=this;t=Number(t);var c=D.p(r),d=function(e){var n=v(l);return D.w(n.date(n.date()+Math.round(e*t)),l)};if(c===s)return this.set(s,this.$M+t);if(c===i)return this.set(i,this.$y+t);if("day"===c)return d(1);if(c===a)return d(7);var m=((u={})[n]=6e4,u[o]=36e5,u[e]=1e3,u)[c]||1,h=this.$d.getTime()+t*m;return D.w(h,this)},h.subtract=function(t,e){return this.add(-1*t,e)},h.format=function(t){var e=this,n=this.$locale();if(!this.isValid())return n.invalidDate||l;var o=t||"YYYY-MM-DDTHH:mm:ssZ",a=D.z(this),s=this.$H,r=this.$m,i=this.$M,u=n.weekdays,c=n.months,m=function(t,n,a,s){return t&&(t[n]||t(e,o))||a[n].slice(0,s)},h=function(t){return D.s(s%12||12,t,"0")},f=n.meridiem||function(t,e,n){var o=t<12?"AM":"PM";return n?o.toLowerCase():o},p={YY:String(this.$y).slice(-2),YYYY:this.$y,M:i+1,MM:D.s(i+1,2,"0"),MMM:m(n.monthsShort,i,c,3),MMMM:m(c,i),D:this.$D,DD:D.s(this.$D,2,"0"),d:String(this.$W),dd:m(n.weekdaysMin,this.$W,u,2),ddd:m(n.weekdaysShort,this.$W,u,3),dddd:u[this.$W],H:String(s),HH:D.s(s,2,"0"),h:h(1),hh:h(2),a:f(s,r,!0),A:f(s,r,!1),m:String(r),mm:D.s(r,2,"0"),s:String(this.$s),ss:D.s(this.$s,2,"0"),SSS:D.s(this.$ms,3,"0"),Z:a};return o.replace(d,function(t,e){return e||p[t]||a.replace(":","")})},h.utcOffset=function(){return-(15*Math.round(this.$d.getTimezoneOffset()/15))},h.diff=function(t,u,l){var c,d=D.p(u),m=v(t),h=(m.utcOffset()-this.utcOffset())*6e4,f=this-m,p=D.m(this,m);return p=((c={})[i]=p/12,c[s]=p,c[r]=p/3,c[a]=(f-h)/6048e5,c.day=(f-h)/864e5,c[o]=f/36e5,c[n]=f/6e4,c[e]=f/1e3,c)[d]||f,l?p:D.a(p)},h.daysInMonth=function(){return this.endOf(s).$D},h.$locale=function(){return f[this.$L]},h.locale=function(t,e){if(!t)return this.$L;var n=this.clone(),o=x(t,e,!0);return o&&(n.$L=o),n},h.clone=function(){return D.w(this.$d,this)},h.toDate=function(){return new Date(this.valueOf())},h.toJSON=function(){return this.isValid()?this.toISOString():null},h.toISOString=function(){return this.$d.toISOString()},h.toString=function(){return this.$d.toUTCString()},m}(),b=g.prototype;return v.prototype=b,[["$ms",t],["$s",e],["$m",n],["$H",o],["$W","day"],["$M",s],["$y",i],["$D",u]].forEach(function(t){b[t[1]]=function(e){return this.$g(e,t[0],t[1])}}),v.extend=function(t,e){return t.$i||(t(e,g,v),t.$i=!0),v},v.locale=x,v.isDayjs=p,v.unix=function(t){return v(1e3*t)},v.en=f[h],v.Ls=f,v.p={},v},t.exports=e()},57548:function(t,e,n){var o;o=function(t){"use strict";var e={name:"pt-br",weekdays:"domingo_segunda-feira_ter\xe7a-feira_quarta-feira_quinta-feira_sexta-feira_s\xe1bado".split("_"),weekdaysShort:"dom_seg_ter_qua_qui_sex_s\xe1b".split("_"),weekdaysMin:"Do_2\xaa_3\xaa_4\xaa_5\xaa_6\xaa_S\xe1".split("_"),months:"janeiro_fevereiro_mar\xe7o_abril_maio_junho_julho_agosto_setembro_outubro_novembro_dezembro".split("_"),monthsShort:"jan_fev_mar_abr_mai_jun_jul_ago_set_out_nov_dez".split("_"),ordinal:function(t){return t+"\xba"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY [\xe0s] HH:mm",LLLL:"dddd, D [de] MMMM [de] YYYY [\xe0s] HH:mm"},relativeTime:{future:"em %s",past:"h\xe1 %s",s:"poucos segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um m\xeas",MM:"%d meses",y:"um ano",yy:"%d anos"}};return(t&&"object"==typeof t&&"default"in t?t:{default:t}).default.locale(e,null,!0),e},t.exports=o(n(13860))},53742:function(t,e,n){"use strict";n.d(e,{Z:function(){return L}});var o=n(85893),a=n(67294),s=n(87536),r=n(21609);n(49540);var i=n(56531),u=n(84220),l=n(29308);let c=t=>{var e,n,a,s,r;let{field:i,data:c,name:d,indexData:m,disabled:h,control:f,register:p,setValue:x,errors:v}=t;return console.log("\uD83D\uDE80 ~ errors Product field:",v),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("input",{type:"hidden",name:"produtos[".concat(m,"].recebimentompProdutoID"),defaultValue:null==i?void 0:i.recebimentompProdutoID,...p("produtos[".concat(m,"].recebimentompProdutoID"))}),i&&"int"===i.tipo&&i.tabela&&(0,o.jsx)(u.Z,{xs:12,md:12,title:i.nomeCampo,name:d,value:null!==(r=null==c?void 0:c[i.tabela])&&void 0!==r?r:null,multiple:!1,disabled:h,required:!0,options:i.options,register:p,setValue:x,control:f,errors:null==v?void 0:null===(e=v.products)||void 0===e?void 0:null===(n=e[m])||void 0===n?void 0:n[i.tabela]},m),i&&"string"===i.tipo&&(0,o.jsx)(l.Z,{title:i.nomeCampo,name:d,value:null==c?void 0:c[i.nomeColuna],type:i.nomeColuna,disabled:h,control:f,errors:null==v?void 0:null===(a=v.produtos)||void 0===a?void 0:null===(s=a[m])||void 0===s?void 0:s[i.nomeColuna]})]})};var d=n(79139),m=n(34282),h=n(88475);n(7071);var f=n(19604),p=n(49837),x=n(91359),v=n(29630),D=n(61953),g=n(75084),b=n(79072),y=n(55343),$=n(11163),S=n.n($),_=n(46749),M=n(60664),j=n(14155),w=n(60565),C=n(83830),I=n(40039),Z=n(47842),O=n(86501),P=n(66136),Y=n(11935);n(30381),n(13860),n(57548);let E=t=>{var e;let{id:n}=t,{user:u,loggedUnity:$}=(0,a.useContext)(I.V),[E,L]=(0,a.useState)(!1),[H,T]=(0,a.useState)(!1),[k,F]=(0,a.useState)(!1),[W,R]=(0,a.useState)(!0),[V,N]=(0,a.useState)(null),[A,U]=(0,a.useState)(!1),[z,q]=(0,a.useState)([]),[J,B]=(0,a.useState)([]),[K,Q]=(0,a.useState)([]);console.log("\uD83D\uDE80 ~ products:",K);let[X,G]=(0,a.useState)(null),[tt,te]=(0,a.useState)([]),[tn,to]=(0,a.useState)([]),[ta,ts]=(0,a.useState)([]),[tr,ti]=(0,a.useState)(""),[tu,tl]=(0,a.useState)(!1),[tc,td]=(0,a.useState)({status:!1,errors:[]}),{settings:tm}=(0,a.useContext)(P.J6),{setId:th}=(0,a.useContext)(C.X),[tf,tp]=(0,a.useState)({status:!1,message:"Voc\xea n\xe3o tem permiss\xf5es",messageType:"info"}),{setTitle:tx,setStorageId:tv,getStorageId:tD}=(0,a.useContext)(w.f),tg=S(),tb=n&&n>0?"edit":"new";console.log("\uD83D\uDE80 ~~~ type:",tb,n);let ty=tg.pathname,{trigger:t$,reset:tS,register:t_,getValues:tM,setValue:tj,control:tw,handleSubmit:tC,clearErrors:tI,setError:tZ,formState:{errors:tO}}=(0,s.cI)(),tP=async t=>{let e={status:t,auth:{usuarioID:u.usuarioID,papelID:u.papelID,unidadeID:$.unidadeID}};try{T(!0),await M.h.post("".concat(ty,"/changeFormStatus/").concat(n),e).then(t=>{O.ZP.success(_.OD.successUpdate),T(!1)})}catch(o){console.log(o)}},tY=()=>{let t=[...K,{recebimentompProdutoID:0,recebimentompID:n}];Q(t)},tE=[{id:1,name:"recebimentoMP",identification:"01",route:"relatorio/recebimentoMP",params:{recebimentompID:n,unidadeID:$.unidadeID}},{id:2,name:"Recep\xe7\xe3o",identification:"02",route:"/relatorio/recepcao"}],tL=async()=>{try{await M.h.post("".concat(ty,"/verifyFormPending/").concat(n),{parFormularioID:2}).then(t=>{R(t.data) //! true/false
})}catch(t){console.log(t)}},tH=()=>{try{L(!0),M.h.post("".concat((0,_.g_)(ty),"/new/getData"),{unidadeID:$.unidadeID}).then(t=>{console.log("getNewData: ",t.data),q(t.data.fields),Q(t.data.products),B(t.data.fieldsProduct),ts(t.data.blocos),ti(t.data.info),tS(t.data),tp({status:!0,message:'Esse formul\xe1rio j\xe1 foi conclu\xeddo! Para alter\xe1-lo \xe9 necess\xe1rio atualizar seu Status para "Em preenchimento" atrav\xe9s do bot\xe3o "Status"!',messageType:"info"}),L(!1)})}catch(t){console.log("\uD83D\uDE80 ~ error:",t)}},tT=()=>{L(!0),n&&M.h.post("".concat(ty,"/getData/").concat(n),{type:tb,unidadeID:$.unidadeID}).then(t=>{var e,n,o,a;console.log("getData: ",t.data),q(t.data.fields),Q(t.data.products),B(t.data.fieldsProduct),ts(t.data.blocos),ti(t.data.info),tS(t.data),N(_.WR[null==t?void 0:null===(e=t.data)||void 0===e?void 0:null===(n=e.info)||void 0===n?void 0:n.status]),tp({status:(null==t?void 0:null===(o=t.data)||void 0===o?void 0:null===(a=o.info)||void 0===a?void 0:a.status)<40,message:'Esse formul\xe1rio j\xe1 foi conclu\xeddo! Para alter\xe1-lo \xe9 necess\xe1rio atualizar seu Status para "Em preenchimento" atrav\xe9s do bot\xe3o "Status"!',messageType:"info"}),tL(),L(!1)})},tk=(t,e)=>{if(1==K.length){O.ZP.error("O formul\xe1rio deve conter pelo menos um produto!");return}(null==t?void 0:t.recebimentompProdutoID)>0&&to([...tn,null==t?void 0:t.recebimentompProdutoID]);let n=[...K];n.splice(e,1),Q(n),tS({...tM(),products:n}),t$(),O.ZP.success("Produto pr\xe9-removido. Salve para concluir!")},tF=()=>{tI();let t=!1,e=[];null==z||z.forEach((n,o)=>{let a=n.tabela?"fields[".concat(o,"].").concat(n.tabela):"fields[".concat(o,"].").concat(n.nomeColuna),s=tM(a);console.log("\uD83D\uDE80 ~ checkErrors:",a,s),1!==n.obrigatorio||s||(tZ(a,{type:"manual",message:"Campo obrigat\xf3rio"}),e.push(null==n?void 0:n.nomeCampo),t=!0)}),K.forEach((n,o)=>{J&&J.forEach((n,a)=>{let s=n.tabela?"products[".concat(o,"].").concat(n.tabela):"products[".concat(o,"].").concat(n.nomeColuna),r=tM(s);console.log("\uD83D\uDE80 ~ checkErrors produto:",s),1!==n.obrigatorio||r||(tZ(s,{type:"manual",message:"Campo obrigat\xe1rio"}),e.push(null==n?void 0:n.nomeCampo),t=!0)})}),ta.forEach((n,o)=>{n.itens.forEach((n,a)=>{let s=tM("blocos[".concat(o,"].itens[").concat(a,"].resposta"));(null==n?void 0:n.obrigatorio)!==1||s||(tZ("blocos[".concat(o,"].itens[").concat(a,"].resposta"),{type:"manual",message:"Campo obrigat\xe1rio"}),e.push(null==n?void 0:n.nome),t=!0)})}),td({status:t,errors:e})},tW=()=>{tF(),tl(!0),F(!0)},tR=async t=>{t.conclusion=!0,await tC(tV)(t)},tV=async function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!0===e.conclusion&&e.status>10&&(t.status=e.status,t.obsConclusao=e.obsConclusao);let o={form:t,auth:{usuarioID:u.usuarioID,papelID:u.papelID,unidadeID:$.unidadeID}};o.form.removedProducts=tn,console.log("\uD83D\uDE80 ~ onSubmit:",o);try{"edit"==tb?(T(!0),await M.h.post("".concat(ty,"/updateData/").concat(n),o).then(t=>{O.ZP.success(_.OD.successUpdate),T(!1)})):"new"==tb?await M.h.post("".concat((0,_.g_)(ty),"/insertData"),o).then(t=>{tg.push("".concat((0,_.g_)(ty))),th(t.data),O.ZP.success(_.OD.successNew)}):O.ZP.error(_.OD.error)}catch(a){console.log(a)}};return(0,a.useEffect)(()=>{"new"==tb?tH():tT()},[n,H]),(0,a.useEffect)(()=>{tF()},[]),(0,o.jsx)(o.Fragment,{children:E?(0,o.jsx)(Z.Z,{}):(0,o.jsxs)("form",{onSubmit:tC(tV),children:[!tf.status&&(0,o.jsx)(f.Z,{severity:tf.messageType,sx:{mb:2},children:tf.message}),(0,o.jsxs)(p.Z,{children:[(0,o.jsx)(j.Z,{btnCancel:!0,btnSave:(null==tr?void 0:tr.status)<40||"new"==tb,btnSend:"edit"==tb,btnPrint:!0,generateReport:_.OE,dataReports:tE,handleSubmit:()=>tC(tV),handleSend:tW,iconConclusion:"mdi:check-bold",titleConclusion:"Aprovar Recebimento",title:"Recebimento MP",btnStatus:"edit"==tb,handleBtnStatus:()=>U(!0),type:tb,status:V}),(0,o.jsx)(x.Z,{children:(0,o.jsx)(i.Z,{register:t_,errors:tO,setValue:tj,control:tw,fields:z,values:z,disabled:!tf.status})})]}),(0,o.jsx)(p.Z,{sx:{mt:4},children:(0,o.jsxs)(x.Z,{children:[(0,o.jsx)(v.Z,{color:"primary",variant:"subtitle1",sx:{fontWeight:700,mb:5},children:"PRODUTOS"}),K&&K.map((t,n)=>(0,o.jsxs)(D.Z,{display:"flex",justifyContent:"space-between",gap:4,sx:{mb:4},children:[J&&J.length>0&&J.map((a,s)=>(0,o.jsx)(D.Z,{flex:1,children:(0,o.jsx)(c,{name:"products[".concat(n,"].").concat(null!==(e=a.tabela)&&void 0!==e?e:a.nomeColuna),field:a,data:t,indexData:n,disabled:!tf.status,register:t_,control:tw,setValue:tj,errors:tO})},s)),(0,o.jsx)(h.Z,{xs:12,md:1,title:"Remover",index:n,removeItem:tk,item:t,pending:!tf.status,textSuccess:"Remover este item",textError:"Este item n\xe3o pode mais ser removido pois j\xe1 foi respondido em um formul\xe1rio"})]},n)),(0,o.jsx)(g.Z,{variant:"outlined",color:"primary",disabled:!tf.status,sx:{mt:1},startIcon:(0,o.jsx)(r.Z,{icon:"material-symbols:add-circle-outline-rounded"}),onClick(){tY()},children:"Inserir produto"})]})}),ta&&ta.map((t,e)=>(0,o.jsx)(d.Z,{index:e,blockKey:"parRecebimentompBlocoID",values:t,control:tw,register:t_,setValue:tj,errors:tO,disabled:!tf.status},e)),tr&&(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(p.Z,{sx:{mt:4},children:(0,o.jsx)(x.Z,{children:(0,o.jsx)(b.ZP,{container:!0,spacing:4,children:(0,o.jsx)(b.ZP,{item:!0,xs:12,md:12,children:(0,o.jsxs)(y.Z,{fullWidth:!0,children:[(0,o.jsx)(v.Z,{variant:"subtitle1",sx:{fontWeight:600,mb:2},children:"Observa\xe7\xf5es (campo de uso exclusivo da validadora)"}),(0,o.jsx)(l.Z,{title:"Observa\xe7\xe3o (opcional)",name:"info.obs",multiline:!0,rows:4,value:tr.obs,disabled:!tf.status,control:tw})]})})})})})}),A&&(0,o.jsx)(m.Z,{id:n,parFormularioID:2,formStatus:tr.status,hasFormPending:W,canChangeStatus:tr.status>30&&!W,openModal:A,handleClose:()=>U(!1),title:"Hist\xf3rico do Formul\xe1rio",text:"Listagem do hist\xf3rico das movimenta\xe7\xf5es do formul\xe1rio ".concat(n," de Recebimento de MP."),btnCancel:!0,btnConfirm:!0,handleSubmit:tP}),(0,o.jsx)(Y.Z,{openModal:tu,handleClose(){tl(!1),F(!1)},title:"Concluir Formul\xe1rio",text:"Deseja realmente concluir este formul\xe1rio?",info:tr,btnCancel:!0,btnConfirm:!0,btnConfirmColor:"primary",conclusionForm:tR,listErrors:tc})]})})};var L=E}}]);