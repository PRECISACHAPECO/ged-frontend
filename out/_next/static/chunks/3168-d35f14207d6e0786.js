"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3168],{53168:function(e,o,t){t.d(o,{Z:function(){return W}});var i=t(85893),l=t(67294),n=t(87536),s=t(49837),a=t(91359),r=t(79072),d=t(85214),c=t(29630),m=t(61953),u=t(75084),x=t(83830),v=t(11163),h=t.n(v),p=t(60664),j=t(86887),b=t(40039),Z=t(86501),g=t(46749),f=t(47842),k=t(21609),I=t(29308),C=t(67569),S=t(3893),D=t(72389),P=t(80562),w=t(88475),y=t(84220),N=t(1948),M=t(95398),q=t(44642),B=t(1890),O=t(77745);let E=e=>{let{title:o,description:t,setOpenModal:n,openModal:s,handleSave:a,children:r,size:d}=e;return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(B.Z,{open:s,onClose:()=>n(!1),fullWidth:!!d,maxWidth:d||null,children:[(0,i.jsx)(O.Z,{id:"form-dialog-title",children:o}),(0,i.jsx)(M.Z,{children:(0,i.jsx)(q.Z,{sx:{py:2},children:l.cloneElement(r,{handleSave:a})})})]})})},F=e=>{var o;let{blocks:t,errors:l,control:n,register:d,getValues:x,removeItem:v,addItem:h,removeBlock:p,setValue:j,watch:b,allOptions:Z,openModalConfirmScore:g,setOpenModalConfirmScore:f,itemScore:S,setItemScore:M,createNew:q,viewItem:B}=e;return(0,i.jsx)(i.Fragment,{children:x("blocks")&&t&&x("blocks").map((e,Z)=>{var O,E,F,A,V,W,z,R,T;return(0,i.jsx)(s.Z,{md:12,sx:{mt:4},children:(0,i.jsxs)(a.Z,{children:[(0,i.jsxs)(r.ZP,{container:!0,spacing:4,children:[(0,i.jsx)(I.Z,{className:"order-1",xs:10,md:1,title:"Sequ\xeancia",name:"blocks.[".concat(Z,"].dados.ordem"),value:e.dados.ordem,required:!0,control:n,errors:null==l?void 0:null===(O=l.blocks)||void 0===O?void 0:null===(E=O[Z])||void 0===E?void 0:null===(F=E.dados)||void 0===F?void 0:F.ordem}),(0,i.jsx)(I.Z,{className:"order-3 md:order-2",xs:10,md:9,title:"Nome do Bloco",name:"blocks.[".concat(Z,"].dados.nome"),value:e.dados.nome,required:!0,control:n,errors:null==l?void 0:null===(A=l.blocks)||void 0===A?void 0:null===(V=A[Z])||void 0===V?void 0:null===(W=V.dados)||void 0===W?void 0:W.nome}),(0,i.jsx)(C.Z,{className:"order-2 md:order-3",xs:2,md:1,title:"Ativo",name:"blocks.[".concat(Z,"].dados.status"),value:null===(z=t[Z])||void 0===z?void 0:null===(R=z.dados)||void 0===R?void 0:R.status,register:d}),(0,i.jsx)(C.Z,{className:"order-4 ",xs:2,md:1,title:"Observa\xe7\xe3o",name:"blocks.[".concat(Z,"].dados.obs"),value:null===(T=t[Z])||void 0===T?void 0:T.dados.obs,register:d})]}),(0,i.jsx)(c.Z,{variant:"subtitle1",sx:{fontWeight:600,mt:4},children:"Itens"}),e.itens&&e.itens.map((e,s)=>{var a,u,h,p,g,f,S,N,M,O,E,F,A,V,W,z,R,T,_;return(0,i.jsxs)(r.ZP,{id:"item-".concat(Z,"-").concat(s),container:!0,spacing:2,sx:{my:1},children:[(0,i.jsx)(I.Z,{xs:12,md:1,title:"Sequ\xeancia",name:"blocks.[".concat(Z,"].itens.[").concat(s,"].ordem"),value:e.ordem,required:!0,control:n,errors:null==l?void 0:null===(a=l.blocks)||void 0===a?void 0:null===(u=a[Z])||void 0===u?void 0:null===(h=u.itens)||void 0===h?void 0:null===(p=h[s])||void 0===p?void 0:p.ordem}),(0,i.jsx)(y.Z,{xs:12,md:7,createNew:()=>q(Z),title:(null===(f=null===(g=t[Z])||void 0===g?void 0:g.itens[s])||void 0===f?void 0:f.itemID)?"Item [".concat(null===(N=null===(S=t[Z])||void 0===S?void 0:S.itens[s])||void 0===N?void 0:N.itemID,"]"):"Item",name:"blocks.[".concat(Z,"].itens.[").concat(s,"].item"),value:null!==(o=null===(O=null===(M=t[Z])||void 0===M?void 0:M.itens[s])||void 0===O?void 0:O.item)&&void 0!==o?o:null,required:!0,disabled:1==e.hasPending,options:null===(E=t[Z].optionsBlock)||void 0===E?void 0:E.itens,register:d,setValue:j,control:n,errors:null==l?void 0:null===(F=l.blocks)||void 0===F?void 0:null===(A=F[Z])||void 0===A?void 0:null===(V=A.itens)||void 0===V?void 0:null===(W=V[s])||void 0===W?void 0:W.item}),(0,i.jsx)(r.ZP,{item:!0,xs:12,md:1,children:(0,i.jsxs)(m.Z,{height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",children:[0==s&&(0,i.jsx)(c.Z,{variant:"caption",children:"Detalhes"}),(0,i.jsx)(D.Z,{title:b("blocks.[".concat(Z,"].itens.[").concat(s,"].item"))?"Ver mais detalhes do item selecionado":"Selecione o item",children:(0,i.jsx)(P.Z,{color:"primary",size:"small",onClick(){b("blocks.[".concat(Z,"].itens.[").concat(s,"].item"))&&B(x("blocks.[".concat(Z,"].itens.[").concat(s,"].item")))},sx:{opacity:b("blocks.[".concat(Z,"].itens.[").concat(s,"].item"))?1:.5,disabled:!b("blocks.[".concat(Z,"].itens.[").concat(s,"].item"))},children:(0,i.jsx)(k.Z,{icon:"octicon:info-16",width:"18"})})})]})}),(0,i.jsx)(C.Z,{xs:2,md:1,title:"Ativo",index:s,name:"blocks.[".concat(Z,"].itens.[").concat(s,"].status"),value:null===(R=null===(z=t[Z])||void 0===z?void 0:z.itens[s])||void 0===R?void 0:R.status,register:d}),(0,i.jsx)(C.Z,{xs:2,md:1,title:"Obrigat\xf3rio",index:s,name:"blocks.[".concat(Z,"].itens.[").concat(s,"].obrigatorio"),value:null===(_=null===(T=t[Z])||void 0===T?void 0:T.itens[s])||void 0===_?void 0:_.obrigatorio,register:d}),(0,i.jsx)(w.Z,{xs:2,md:1,title:0==s?"Remover":"",index:Z,removeItem:()=>v(e,Z,s),item:e,pending:e.hasPending,textSuccess:"Remover este item",textError:"Este item n\xe3o pode mais ser removido pois j\xe1 foi respondido em um formul\xe1rio"})]},s)}),g&&S&&(0,i.jsx)(N.Z,{openModal:g,setOpenModalConfirmScore:f,itemScore:S,setItemScore:M}),(0,i.jsx)(r.ZP,{container:!0,spacing:4,sx:{mt:4},children:(0,i.jsxs)(r.ZP,{item:!0,xs:12,md:12,children:[(0,i.jsx)(u.Z,{variant:"outlined",color:"primary",startIcon:(0,i.jsx)(k.Z,{icon:"material-symbols:add-circle-outline-rounded"}),onClick(){h(Z)},children:"Inserir Item"}),(0,i.jsx)(u.Z,{variant:"outlined",color:"error",startIcon:(0,i.jsx)(k.Z,{icon:"tabler:trash-filled"}),onClick(){p(e,Z)},sx:{ml:2},children:"Remover Bloco"})]})})]})},Z)})})};var A=t(82350);t(53934);let V=e=>{var o,t;let{id:v}=e,{setId:D}=(0,l.useContext)(x.X),{loggedUnity:P}=(0,l.useContext)(b.V),[w,y]=(0,l.useState)(),[N,M]=(0,l.useState)(),[q,B]=(0,l.useState)(null),[O,V]=(0,l.useState)(),[W,z]=(0,l.useState)(),[R,T]=(0,l.useState)(!1),[_,H]=(0,l.useState)(),[U,L]=(0,l.useState)(!1),[X,G]=(0,l.useState)([]),[J,K]=(0,l.useState)([]),[Q,Y]=(0,l.useState)(!1),[$,ee]=(0,l.useState)(!1),[eo,et]=(0,l.useState)(!1),[ei,el]=(0,l.useState)(null),[en,es]=(0,l.useState)(!1),[ea,er]=(0,l.useState)(null),ed=e=>{ee(!0),er(e)},ec=e=>{e&&e.id>0&&(console.log("\uD83D\uDE80 ~ item:",e),el(e.id),et(!0))},em=e=>{ee(!1),ew(),setTimeout(()=>{eC(ea),console.log("\uD83D\uDE80 ~ indexNewItem depois do settimerout:",ea)},1e3)},eu=h(),ex=v&&v>0?"edit":"new";eu.pathname;let{setValue:ev,register:eh,handleSubmit:ep,reset:ej,getValues:eb,control:eZ,watch:eg,formState:{errors:ef}}=(0,n.cI)(),ek=async e=>{var o,t,i;let l={id:null!=v?v:null,unidadeID:P.unidadeID,model:e.model,header:null!==(o=e.header)&&void 0!==o?o:null,blocks:null!==(t=e.blocks)&&void 0!==t?t:[],arrRemovedBlocks:null!=J?J:[],arrRemovedItems:null!=X?X:[],orientacoes:null!==(i=e.orientations)&&void 0!==i?i:null};console.log("\uD83D\uDE80 ~ onSubmit:",l),M(null);try{"new"===ex?await p.h.put("/configuracoes/formularios/fornecedor/insertData",l).then(e=>{Z.ZP.success(g.OD.successUpdate),eu.push("/configuracoes/formularios/fornecedor/"),setTimeout(()=>{D(e.data.id)},1e3)}):await p.h.put("/configuracoes/formularios/fornecedor/updateData",l).then(e=>{Z.ZP.success(g.OD.successUpdate),L(!U),$&&setOutsideLink(!0)})}catch(n){console.log(n)}},eI=(e,o,t,i)=>{let l=i.itens;l=l.filter(o=>{let t=e.itens.some(e=>e.item&&o.id===e.item.id);return!t});let n=[...t];n[o].optionsBlock.itens=l,V(n)},eC=e=>{var o;let t=[...O];t[e].itens.push({ordem:(null===(o=t[e].itens)||void 0===o?void 0:o.length)+1,obs:1,status:1,obrigatorio:1}),V(t),ev("blocks.[".concat(e,"].itens.[").concat(t[e].itens.length-1,"].new"),!0),eI(t[e],e,O,q)},eS=(e,o,t)=>{if(1===O[o].itens.length){Z.ZP.error("Voc\xea deve ter ao menos um item!");return}let i=[...X];i.push(e),G(i);let l=[...eb("blocks")];l[o].itens.splice(t,1),ev("blocks",l),V(l),eI(O[o],o,O,q),Y(!Q)},eD=(e,o)=>{let t=!0;if(e&&e.itens.map(e=>{1==e.hasPending&&(t=!1)}),!t){Z.ZP.error("Este bloco n\xe3o pode ser removido pois possui itens respondidos em um formul\xe1rio");return}let i=[...J];i.push(e.dados.parFornecedorModeloBlocoID),K(i);let l=[...O];l.splice(o,1),V(l),ev("blocks",l),Z.ZP.success("Bloco pr\xe9-removido. Salve para concluir!")},eP=()=>{let e=[...eb("blocks")];e.push({dados:{ordem:e.length+1,nome:"",status:1},categorias:[],atividades:[],optionsBlock:{itens:[...q.itens]},itens:[{parFormularioID:1,new:!0,ordem:"1",nome:"",status:1,item:null}]}),ev("blocks",e),V(e)},ew=()=>{try{"new"===ex?y({nome:"",ciclo:"",cabecalho:"",status:1}):p.h.post("/configuracoes/formularios/fornecedor/getData/".concat(v),{unidadeID:P.unidadeID}).then(e=>{var o;console.log("\uD83D\uDE80 ~ getData: ",e.data),y(e.data.model),M(e.data.header),V(e.data.blocks),B({itens:null===(o=e.data.options)||void 0===o?void 0:o.itens}),z(e.data.orientations),ej(e.data),setTimeout(()=>{e.data.blocks&&e.data.blocks.map((o,t)=>{eI(o,t,e.data.blocks,e.data.options)})},3e3)})}catch(e){console.log(e)}};(0,l.useEffect)(()=>{ew()},[v,U]);let ey=async e=>{es(!0),ee(!1)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(f.Z,{show:!w}),(0,i.jsxs)("form",{onSubmit:ep(ek),children:[w&&(0,i.jsxs)(s.Z,{children:[(0,i.jsx)(j.Z,{partialRoute:!0,btnCancel:!0,btnSave:!0,handleSubmit:()=>ep(ek),type:ex}),(0,i.jsx)(a.Z,{children:(0,i.jsxs)(r.ZP,{container:!0,spacing:4,children:[(0,i.jsx)(I.Z,{className:"order-1",xs:12,md:8,title:"Modelo",name:"model.nome",value:w.nome,required:!0,control:eZ,errors:null==ef?void 0:null===(o=ef.model)||void 0===o?void 0:o.nome}),(0,i.jsx)(I.Z,{className:"order-1",xs:12,md:3,type:"number",title:"Ciclo (dias)",name:"model.ciclo",value:w.ciclo,required:!0,control:eZ,helpText:"Ciclo de vencimento deste formul\xe1rio.",errors:null==ef?void 0:null===(t=ef.model)||void 0===t?void 0:t.ciclo}),(0,i.jsx)(C.Z,{className:"order-2 md:order-3",xs:2,md:1,title:"Ativo",name:"model.status",value:w.status,register:eh}),(0,i.jsx)(I.Z,{xs:12,md:12,className:"order-4",title:"Cabe\xe7alho",name:"model.cabecalho",required:!1,value:w.cabecalho,multiline:!0,rows:4,control:eZ,helpText:"Texto que ser\xe1 exibido no cabe\xe7alho do formul\xe1rio. Adicione aqui instru\xe7\xf5es e orienta\xe7\xf5es para auxiliar o preenchimento pelo fornecedor."})]})})]}),N&&(0,i.jsx)(s.Z,{sx:{mt:4},children:(0,i.jsx)(a.Z,{children:(0,i.jsx)(d.Z,{component:"nav","aria-label":"main mailbox",children:(0,i.jsxs)(r.ZP,{container:!0,spacing:2,children:[(0,i.jsx)(r.ZP,{item:!0,md:4,xs:4,children:(0,i.jsx)(c.Z,{variant:"subtitle1",sx:{fontWeight:600},children:"Nome do Campo"})}),(0,i.jsx)(r.ZP,{item:!0,md:3,xs:4,children:(0,i.jsx)(c.Z,{variant:"subtitle1",sx:{fontWeight:600},children:"Mostra no Formul\xe1rio"})}),(0,i.jsx)(r.ZP,{item:!0,md:3,xs:4,children:(0,i.jsx)(c.Z,{variant:"subtitle1",sx:{fontWeight:600},children:"Obrigat\xf3rio"})}),N.map((e,o)=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.ZP,{item:!0,md:4,xs:6,children:(0,i.jsx)(m.Z,{display:"flex",alignItems:"center",sx:{gap:2},children:(0,i.jsx)("p",{children:e.nomeCampo})})}),(0,i.jsx)(r.ZP,{item:!0,md:3,xs:3,children:(0,i.jsx)(S.Z,{title:"",name:"header.[".concat(o,"].mostra"),register:eh,value:e.mostra})}),(0,i.jsx)(r.ZP,{item:!0,md:3,xs:3,children:(0,i.jsx)(S.Z,{title:"",name:"header.[".concat(o,"].obrigatorio"),value:"cnpj"==e.nomeColuna||"razaoSocial"==e.nomeColuna||"dataAvaliacao"==e.nomeColuna||e.obrigatorio,register:eh,disabled:"cnpj"==e.nomeColuna||"razaoSocial"==e.nomeColuna||"dataAvaliacao"==e.nomeColuna})})]}))]})})})}),!O&&(0,i.jsx)(f.Z,{}),O&&(0,i.jsx)(F,{blocks:O,errors:ef,control:eZ,register:eh,watch:eg,removeItem:eS,addItem:eC,getValues:eb,removeBlock:eD,setValue:ev,allOptions:q,openModalConfirmScore:R,setOpenModalConfirmScore:T,itemScore:_,setItemScore:!0,createNew:ed,viewItem:ec},Q),"edit"===ex&&w&&(0,i.jsx)(r.ZP,{item:!0,xs:12,md:12,sx:{mt:4},children:(0,i.jsx)(u.Z,{variant:"outlined",color:"primary",startIcon:(0,i.jsx)(k.Z,{icon:"material-symbols:add-circle-outline-rounded"}),onClick(){eP()},children:"Inserir Bloco"})}),W&&(0,i.jsx)(s.Z,{md:12,sx:{mt:4},children:(0,i.jsx)(a.Z,{children:(0,i.jsx)(r.ZP,{container:!0,spacing:4,children:(0,i.jsx)(I.Z,{xs:12,md:12,title:"Orienta\xe7\xf5es",name:"orientations.obs",required:!1,value:null==W?void 0:W.obs,multiline:!0,rows:4,control:eZ})})})})]}),(0,i.jsx)(E,{title:"Novo item",size:"md",openModal:$,setOpenModal:ee,handleSave:ey,children:(0,i.jsx)(A.Z,{setNewChange:es,btnClose:!0,handleModalClose:()=>ee(!1),newChange:en,outsideID:v,handleConfirmNew:em})}),(0,i.jsx)(E,{title:"Detalhes do Item",size:"md",openModal:eo,setOpenModal:et,children:(0,i.jsx)(A.Z,{id:ei,btnClose:!0,handleModalClose:()=>et(!1)})})]})};var W=V},1948:function(e,o,t){var i=t(85893),l=t(75084),n=t(1890),s=t(77745),a=t(95398),r=t(76779),d=t(44642),c=t(60664),m=t(61953),u=t(22416),x=t(22841),v=t(16056),h=t(79072),p=t(55343),j=t(67836),b=t(87536),Z=t(86501);let g=e=>{let{openModal:o,setOpenModalConfirmScore:t,itemScore:g,setItemScore:f}=e,k=()=>{t(!1)},{handleSubmit:I,register:C}=(0,b.cI)({}),S=e=>{let o={alternativaID:null==g?void 0:g.alternativaID,pontuacao:(null==e?void 0:e.pontuacao)?1:0,parFornecedorBlocoItemID:null==g?void 0:g.parFornecedorBlocoItemID,alternatives:null==g?void 0:g.alternatives.map((o,t)=>({alternativaItemID:null==o?void 0:o.alternativaItemID,score:e[null==o?void 0:o.nome]}))};c.h.post("/formularios/fornecedor/saveItemScore",{data:o}).then(e=>{t(!1),Z.Am.success("Pontua\xe7\xe3o salva com sucesso!")})};return(0,i.jsx)(i.Fragment,{children:(null==g?void 0:g.alternatives)&&(0,i.jsx)(n.Z,{open:o,onClose:k,"aria-labelledby":"form-dialog-title",children:(0,i.jsxs)("form",{onSubmit:I(S),children:[(0,i.jsx)(s.Z,{id:"form-dialog-title",children:"Pontua\xe7\xe3o das respostas"}),(0,i.jsxs)(a.Z,{children:[(0,i.jsx)(d.Z,{sx:{mb:3},children:"Defina a pontua\xe7\xe3o para cada alternativa"}),(0,i.jsx)(m.Z,{sx:{mb:4},children:(0,i.jsx)(u.Z,{row:!0,children:(0,i.jsx)(x.Z,{label:"Habilitar pontua\xe7\xe3o",control:(0,i.jsx)(v.Z,{name:"pontuacao",...C("pontuacao"),checked:(null==g?void 0:g.pontuacao)==1,onChange(e){f({...g,pontuacao:e.target.checked?1:0})}})})})}),g&&(null==g?void 0:g.alternatives.map((e,o)=>(0,i.jsx)(h.ZP,{md:12,sx:{mb:4},children:(0,i.jsx)("grid",{item:!0,md:12,children:(0,i.jsx)(p.Z,{fullWidth:!0,children:(0,i.jsx)(j.Z,{disabled:1!=g.pontuacao,id:"outlined-basic",label:null==e?void 0:e.nome,...C("".concat(null==e?void 0:e.nome)),name:"".concat(null==e?void 0:e.nome),defaultValue:null==e?void 0:e.score,variant:"outlined",size:"small",type:"number",title:0!=g.pontuacao||"Habilite a pontua\xe7\xe3o para preencher"})})})},o)))]}),(0,i.jsxs)(r.Z,{className:"dialog-actions-dense",children:[(0,i.jsx)(l.Z,{variant:"outlined",color:"primary",onClick:k,children:"Cancelar"}),(0,i.jsx)(l.Z,{variant:"contained",color:"primary",onClick:I(S),children:"Confirmar"})]})]})})})};o.Z=g}}]);