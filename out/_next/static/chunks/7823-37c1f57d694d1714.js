"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7823],{27823:function(e,o,n){n.d(o,{Z:function(){return B}});var l=n(85893),t=n(67294),i=n(87536),a=n(49837),s=n(91359),r=n(79072),d=n(85214),c=n(29630),m=n(30120),u=n(75084),x=n(83830),v=n(11163),h=n.n(v),p=n(60664),j=n(86887),Z=n(40039),b=n(86501),f=n(46749),g=n(47842),C=n(21609),k=n(84220),I=n(29308),S=n(67569),P=n(3893),D=n(72389),y=n(80562),w=n(88475),N=n(1948),q=n(1322);let O=e=>{var o;let{blocks:n,errors:t,control:i,register:d,getValues:x,removeItem:v,addItem:h,removeBlock:p,setValue:j,watch:Z,allOptions:b,openModalConfirmScore:f,setOpenModalConfirmScore:g,itemScore:P,setItemScore:q,createNew:O,viewItem:A}=e;return(0,l.jsx)(l.Fragment,{children:x("blocks")&&n&&x("blocks").map((e,b)=>{var M,B,F,V,z,W,E,T,R;return(0,l.jsx)(a.Z,{md:12,sx:{mt:4},children:(0,l.jsxs)(s.Z,{children:[(0,l.jsxs)(r.ZP,{container:!0,spacing:4,children:[(0,l.jsx)(I.Z,{className:"order-1",xs:10,md:1,title:"Sequ\xeancia",name:"blocks.[".concat(b,"].dados.ordem"),value:e.dados.ordem,required:!0,control:i,errors:null==t?void 0:null===(M=t.blocks)||void 0===M?void 0:null===(B=M[b])||void 0===B?void 0:null===(F=B.dados)||void 0===F?void 0:F.ordem}),(0,l.jsx)(I.Z,{className:"order-3 md:order-2",xs:10,md:9,title:"Nome do Bloco",name:"blocks.[".concat(b,"].dados.nome"),value:e.dados.nome,required:!0,control:i,errors:null==t?void 0:null===(V=t.blocks)||void 0===V?void 0:null===(z=V[b])||void 0===z?void 0:null===(W=z.dados)||void 0===W?void 0:W.nome}),(0,l.jsx)(S.Z,{className:"order-2 md:order-3",xs:2,md:1,title:"Ativo",name:"blocks.[".concat(b,"].dados.status"),value:null===(E=n[b])||void 0===E?void 0:null===(T=E.dados)||void 0===T?void 0:T.status,register:d}),(0,l.jsx)(S.Z,{className:"order-4 ",xs:2,md:1,title:"Observa\xe7\xe3o",name:"blocks.[".concat(b,"].dados.obs"),value:null===(R=n[b])||void 0===R?void 0:R.dados.obs,register:d})]}),(0,l.jsx)(c.Z,{variant:"subtitle1",sx:{fontWeight:600,mt:4},children:"Itens"}),e.itens&&e.itens.map((e,a)=>{var s,u,h,p,f,g,P,N,q,M,B,F,V,z,W,E,T,R,_;return(0,l.jsxs)(r.ZP,{id:"item-".concat(b,"-").concat(a),container:!0,spacing:2,sx:{my:1},children:[(0,l.jsx)(I.Z,{xs:12,md:1,title:"Sequ\xeancia",name:"blocks.[".concat(b,"].itens.[").concat(a,"].ordem"),value:e.ordem,required:!0,control:i,errors:null==t?void 0:null===(s=t.blocks)||void 0===s?void 0:null===(u=s[b])||void 0===u?void 0:null===(h=u.itens)||void 0===h?void 0:null===(p=h[a])||void 0===p?void 0:p.ordem}),(0,l.jsx)(k.Z,{xs:12,md:7,createNew:()=>O(b,a),title:(null===(g=null===(f=n[b])||void 0===f?void 0:f.itens[a])||void 0===g?void 0:g.itemID)?"Item [".concat(null===(N=null===(P=n[b])||void 0===P?void 0:P.itens[a])||void 0===N?void 0:N.itemID,"]"):"Item",name:"blocks.[".concat(b,"].itens.[").concat(a,"].item"),value:null!==(o=null===(M=null===(q=n[b])||void 0===q?void 0:q.itens[a])||void 0===M?void 0:M.item)&&void 0!==o?o:null,required:!0,disabled:1==e.hasPending,options:null===(B=n[b].optionsBlock)||void 0===B?void 0:B.itens,register:d,setValue:j,control:i,errors:null==t?void 0:null===(F=t.blocks)||void 0===F?void 0:null===(V=F[b])||void 0===V?void 0:null===(z=V.itens)||void 0===z?void 0:null===(W=z[a])||void 0===W?void 0:W.item}),(0,l.jsx)(r.ZP,{item:!0,xs:12,md:1,children:(0,l.jsxs)(m.Z,{height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",children:[0==a&&(0,l.jsx)(c.Z,{variant:"caption",children:"Detalhes"}),(0,l.jsx)(D.Z,{title:Z("blocks.[".concat(b,"].itens.[").concat(a,"].item"))?"Ver mais detalhes do item selecionado":"Selecione o item",children:(0,l.jsx)(y.Z,{color:"primary",size:"small",onClick(){Z("blocks.[".concat(b,"].itens.[").concat(a,"].item"))&&A(x("blocks.[".concat(b,"].itens.[").concat(a,"].item")))},sx:{opacity:Z("blocks.[".concat(b,"].itens.[").concat(a,"].item"))?1:.5,disabled:!Z("blocks.[".concat(b,"].itens.[").concat(a,"].item"))},children:(0,l.jsx)(C.Z,{icon:"octicon:info-16",width:"18"})})})]})}),(0,l.jsx)(S.Z,{xs:2,md:1,title:"Ativo",index:a,name:"blocks.[".concat(b,"].itens.[").concat(a,"].status"),value:null===(T=null===(E=n[b])||void 0===E?void 0:E.itens[a])||void 0===T?void 0:T.status,register:d}),(0,l.jsx)(S.Z,{xs:2,md:1,title:"Obrigat\xf3rio",index:a,name:"blocks.[".concat(b,"].itens.[").concat(a,"].obrigatorio"),value:null===(_=null===(R=n[b])||void 0===R?void 0:R.itens[a])||void 0===_?void 0:_.obrigatorio,register:d}),(0,l.jsx)(w.Z,{xs:2,md:1,title:0==a?"Remover":"",index:b,removeItem:()=>v(e,b,a),item:e,pending:e.hasPending,textSuccess:"Remover este item",textError:"Este item n\xe3o pode mais ser removido pois j\xe1 foi respondido em um formul\xe1rio"})]},a)}),f&&P&&(0,l.jsx)(N.Z,{openModal:f,setOpenModalConfirmScore:g,itemScore:P,setItemScore:q}),(0,l.jsx)(r.ZP,{container:!0,spacing:4,sx:{mt:4},children:(0,l.jsxs)(r.ZP,{item:!0,xs:12,md:12,children:[(0,l.jsx)(u.Z,{variant:"outlined",color:"primary",startIcon:(0,l.jsx)(C.Z,{icon:"material-symbols:add-circle-outline-rounded"}),onClick(){h(b)},children:"Inserir Item"}),(0,l.jsx)(u.Z,{variant:"outlined",color:"error",startIcon:(0,l.jsx)(C.Z,{icon:"tabler:trash-filled"}),onClick(){p(e,b)},sx:{ml:2},children:"Remover Bloco"})]})})]})},b)})})};var A=n(82350);n(53934);let M=e=>{var o,n,v,D;let{id:y}=e,{setId:w}=(0,t.useContext)(x.X),{loggedUnity:N}=(0,t.useContext)(Z.V),[M,B]=(0,t.useState)(),[F,V]=(0,t.useState)(),[z,W]=(0,t.useState)(null),[E,T]=(0,t.useState)(null),[R,_]=(0,t.useState)(),[H,U]=(0,t.useState)(),[L,X]=(0,t.useState)(!1),[G,J]=(0,t.useState)(),[K,Q]=(0,t.useState)(!1),[Y,$]=(0,t.useState)([]),[ee,eo]=(0,t.useState)([]),[en,el]=(0,t.useState)(!1),[et,ei]=(0,t.useState)(!1),[ea,es]=(0,t.useState)(!1),[er,ed]=(0,t.useState)(null),[ec,em]=(0,t.useState)(!1),[eu,ex]=(0,t.useState)(null),[ev,eh]=(0,t.useState)(null),ep=(e,o)=>{ei(!0),ex(e),eh(o)},ej=e=>{e&&e.id>0&&(ed(e.id),es(!0))},eZ=e=>{ei(!1),eg("blocks.[".concat(eu,"].itens.[").concat(ev,"].item"),e)},eb=h(),ef=y&&y>0?"edit":"new";eb.pathname;let{setValue:eg,register:eC,handleSubmit:ek,reset:eI,getValues:eS,control:eP,watch:eD,formState:{errors:ey}}=(0,i.cI)(),ew=async e=>{var o,n,l;let t={id:null!=y?y:null,unidadeID:N.unidadeID,model:e.model,header:null!==(o=e.header)&&void 0!==o?o:null,blocks:null!==(n=e.blocks)&&void 0!==n?n:[],arrRemovedBlocks:null!=ee?ee:[],arrRemovedItems:null!=Y?Y:[],orientacoes:null!==(l=e.orientations)&&void 0!==l?l:null};V(null);try{"new"===ef?await p.h.put("/configuracoes/formularios/fornecedor/insertData",t).then(e=>{b.ZP.success(f.OD.successUpdate),eb.push("/configuracoes/formularios/fornecedor/"),setTimeout(()=>{w(e.data.id)},1e3)}):await p.h.put("/configuracoes/formularios/fornecedor/updateData",t).then(e=>{b.ZP.success(f.OD.successUpdate),Q(!K),et&&setOutsideLink(!0)})}catch(i){console.log(i)}},eN=(e,o,n,l)=>{let t=l.itens;t=t.filter(o=>{let n=e.itens.some(e=>e.item&&o.id===e.item.id);return!n});let i=[...n];i[o].optionsBlock.itens=t,_(i)},eq=e=>{var o;let n=[...R];n[e].itens.push({ordem:(null===(o=n[e].itens)||void 0===o?void 0:o.length)+1,obs:1,status:1,obrigatorio:1}),_(n),eg("blocks.[".concat(e,"].itens.[").concat(n[e].itens.length-1,"].new"),!0),eN(n[e],e,R,z)},eO=(e,o,n)=>{if(1===R[o].itens.length){b.ZP.error("Voc\xea deve ter ao menos um item!");return}let l=[...Y];l.push(e),$(l);let t=[...eS("blocks")];t[o].itens.splice(n,1),eg("blocks",t),_(t),eN(R[o],o,R,z),el(!en)};console.log("allOptions:",z);let eA=(e,o)=>{let n=!0;if(e&&e.itens.map(e=>{1==e.hasPending&&(n=!1)}),!n){b.ZP.error("Este bloco n\xe3o pode ser removido pois possui itens respondidos em um formul\xe1rio");return}let l=[...ee];l.push(e.dados.parFornecedorModeloBlocoID),eo(l);let t=[...R];t.splice(o,1),_(t),eg("blocks",t),b.ZP.success("Bloco pr\xe9-removido. Salve para concluir!")},eM=()=>{let e=[...eS("blocks")];e.push({dados:{ordem:e.length+1,nome:"",status:1},categorias:[],atividades:[],optionsBlock:{itens:[...z.itens]},itens:[{parFormularioID:1,new:!0,ordem:"1",nome:"",status:1,item:null}]}),eg("blocks",e),_(e)},eB=async()=>{let e=await p.h.post("/cadastros/profissional/getProfissionaisAssinatura",{formularioID:1,modeloID:y}),o={...M};o.profissionaisPreenchem=e.data.preenche,o.profissionaisAprovam=e.data.aprova,eI({...eS(),model:o})},eF=()=>{try{"new"===ef?B({nome:"",ciclo:"",cabecalho:"",status:1}):p.h.post("/configuracoes/formularios/fornecedor/getData/".concat(y),{unidadeID:N.unidadeID}).then(e=>{var o,n;console.log("\uD83D\uDE80 ~ getData: ",e.data),B(e.data.model),V(e.data.header),_(e.data.blocks),W({itens:null===(o=e.data.options)||void 0===o?void 0:o.itens}),T(null===(n=e.data.options)||void 0===n?void 0:n.profissionais),U(e.data.orientations),eI(e.data),eB(),setTimeout(()=>{e.data.blocks&&e.data.blocks.map((o,n)=>{eN(o,n,e.data.blocks,e.data.options)})},3e3)})}catch(e){console.log(e)}};(0,t.useEffect)(()=>{eF()},[y,K]);let eV=async e=>{em(!0),eF(),ei(!1)};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(g.Z,{show:!M}),(0,l.jsxs)("form",{onSubmit:ek(ew),children:[M&&(0,l.jsxs)(a.Z,{children:[(0,l.jsx)(j.Z,{partialRoute:!0,btnCancel:!0,btnSave:!0,handleSubmit:()=>ek(ew),type:ef}),(0,l.jsx)(s.Z,{children:(0,l.jsxs)(r.ZP,{container:!0,spacing:4,children:[(0,l.jsx)(I.Z,{className:"order-1",xs:12,md:8,title:"Modelo",name:"model.nome",value:M.nome,required:!0,control:eP,errors:null==ey?void 0:null===(o=ey.model)||void 0===o?void 0:o.nome}),(0,l.jsx)(I.Z,{className:"order-1",xs:12,md:3,type:"number",title:"Ciclo (dias)",name:"model.ciclo",value:M.ciclo,required:!0,control:eP,helpText:"Ciclo de vencimento deste formul\xe1rio.",errors:null==ey?void 0:null===(n=ey.model)||void 0===n?void 0:n.ciclo}),(0,l.jsx)(S.Z,{className:"order-2 md:order-3",xs:2,md:1,title:"Ativo",name:"model.status",value:M.status,register:eC}),(0,l.jsx)(I.Z,{xs:12,md:12,className:"order-4",title:"Cabe\xe7alho",name:"model.cabecalho",required:!1,value:M.cabecalho,multiline:!0,rows:4,control:eP,helpText:"Texto que ser\xe1 exibido no cabe\xe7alho do formul\xe1rio. Adicione aqui instru\xe7\xf5es e orienta\xe7\xf5es para auxiliar o preenchimento pelo fornecedor."}),E&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(k.Z,{xs:12,md:6,className:"order-5",multiple:!0,title:"Profissionais que preenchem",name:"model.profissionaisPreenchem",options:null!=E?E:[],value:null!==(v=null==M?void 0:M.profissionaisPreenchem)&&void 0!==v?v:[],register:eC,setValue:eg,control:eP}),(0,l.jsx)(k.Z,{xs:12,md:6,className:"order-5",multiple:!0,title:"Profissionais que aprovam",name:"model.profissionaisAprovam",options:null!=E?E:[],value:null!==(D=null==M?void 0:M.profissionaisAprovam)&&void 0!==D?D:[],register:eC,setValue:eg,control:eP})]})]})})]}),F&&(0,l.jsx)(a.Z,{sx:{mt:4},children:(0,l.jsx)(s.Z,{children:(0,l.jsx)(d.Z,{component:"nav","aria-label":"main mailbox",children:(0,l.jsxs)(r.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(r.ZP,{item:!0,md:6,children:(0,l.jsx)(c.Z,{variant:"subtitle1",sx:{fontWeight:600},children:"Nome do Campo"})}),(0,l.jsx)(r.ZP,{item:!0,md:2,children:(0,l.jsx)(c.Z,{variant:"subtitle1",sx:{fontWeight:600},children:"Mostra"})}),(0,l.jsx)(r.ZP,{item:!0,md:2,children:(0,l.jsx)(c.Z,{variant:"subtitle1",sx:{fontWeight:600},children:"Obrigat\xf3rio"})}),(0,l.jsx)(r.ZP,{item:!0,md:2,children:(0,l.jsx)(c.Z,{variant:"subtitle1",sx:{fontWeight:600},children:"Ordem"})}),eS("header").map((e,o)=>(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.ZP,{item:!0,md:6,children:(0,l.jsx)(m.Z,{display:"flex",alignItems:"center",sx:{gap:2},children:(0,l.jsx)("p",{children:e.nomeCampo})})}),(0,l.jsx)(P.Z,{xs:"12",md:"2",title:"",name:"header.[".concat(o,"].mostra"),value:"cnpj"==e.nomeColuna||"razaoSocial"==e.nomeColuna||"nome"==e.nomeColuna||"dataAvaliacao"==e.nomeColuna||"responsavel"==e.nomeColuna||e.mostra,register:eC,helpText:"cnpj"==e.nomeColuna||"razaoSocial"==e.nomeColuna||"nome"==e.nomeColuna||"dataAvaliacao"==e.nomeColuna||"responsavel"==e.nomeColuna?"Campo obrigat\xf3rio":null}),(0,l.jsx)(P.Z,{xs:"12",md:"2",title:"",name:"header.[".concat(o,"].obrigatorio"),value:"cnpj"==e.nomeColuna||"razaoSocial"==e.nomeColuna||"nome"==e.nomeColuna||"dataAvaliacao"==e.nomeColuna||"responsavel"==e.nomeColuna||e.obrigatorio,register:eC,helpText:"cnpj"==e.nomeColuna||"razaoSocial"==e.nomeColuna||"nome"==e.nomeColuna||"dataAvaliacao"==e.nomeColuna||"responsavel"==e.nomeColuna?"Campo obrigat\xf3rio":null}),(0,l.jsx)(I.Z,{xs:"12",md:"2",title:"",name:"header.[".concat(o,"].ordem"),value:e.ordem,register:eC,control:eP,type:"number"})]}))]})})})}),!R&&(0,l.jsx)(g.Z,{}),R&&(0,l.jsx)(O,{blocks:R,errors:ey,control:eP,register:eC,watch:eD,removeItem:eO,addItem:eq,getValues:eS,removeBlock:eA,setValue:eg,allOptions:z,openModalConfirmScore:L,setOpenModalConfirmScore:X,itemScore:G,setItemScore:!0,createNew:ep,viewItem:ej},en),"edit"===ef&&M&&(0,l.jsx)(r.ZP,{item:!0,xs:12,md:12,sx:{mt:4},children:(0,l.jsx)(u.Z,{variant:"outlined",color:"primary",startIcon:(0,l.jsx)(C.Z,{icon:"material-symbols:add-circle-outline-rounded"}),onClick(){eM()},children:"Inserir Bloco"})}),H&&(0,l.jsx)(a.Z,{md:12,sx:{mt:4},children:(0,l.jsx)(s.Z,{children:(0,l.jsx)(r.ZP,{container:!0,spacing:4,children:(0,l.jsx)(I.Z,{xs:12,md:12,title:"Orienta\xe7\xf5es",name:"orientations.obs",required:!1,value:null==H?void 0:H.obs,multiline:!0,rows:4,control:eP})})})})]}),(0,l.jsx)(q.Z,{title:"Novo item",size:"md",openModal:et,setOpenModal:ei,handleSave:eV,children:(0,l.jsx)(A.Z,{btnClose:!0,handleModalClose:()=>ei(!1),setNewChange:em,newChange:ec,outsideID:y,handleConfirmNew:eZ})}),(0,l.jsx)(q.Z,{title:"Detalhes do Item",size:"md",openModal:ea,setOpenModal:es,children:(0,l.jsx)(A.Z,{id:er,btnClose:!0,handleModalClose:()=>es(!1)})})]})};var B=M},1948:function(e,o,n){var l=n(85893),t=n(75084),i=n(1890),a=n(77745),s=n(95398),r=n(76779),d=n(44642),c=n(60664),m=n(30120),u=n(22416),x=n(22841),v=n(16056),h=n(79072),p=n(55343),j=n(67836),Z=n(87536),b=n(86501);let f=e=>{let{openModal:o,setOpenModalConfirmScore:n,itemScore:f,setItemScore:g}=e,C=()=>{n(!1)},{handleSubmit:k,register:I}=(0,Z.cI)({}),S=e=>{let o={alternativaID:null==f?void 0:f.alternativaID,pontuacao:(null==e?void 0:e.pontuacao)?1:0,parFornecedorBlocoItemID:null==f?void 0:f.parFornecedorBlocoItemID,alternatives:null==f?void 0:f.alternatives.map((o,n)=>({alternativaItemID:null==o?void 0:o.alternativaItemID,score:e[null==o?void 0:o.nome]}))};c.h.post("/formularios/fornecedor/saveItemScore",{data:o}).then(e=>{n(!1),b.Am.success("Pontua\xe7\xe3o salva com sucesso!")})};return(0,l.jsx)(l.Fragment,{children:(null==f?void 0:f.alternatives)&&(0,l.jsx)(i.Z,{open:o,onClose:C,"aria-labelledby":"form-dialog-title",children:(0,l.jsxs)("form",{onSubmit:k(S),children:[(0,l.jsx)(a.Z,{id:"form-dialog-title",children:"Pontua\xe7\xe3o das respostas"}),(0,l.jsxs)(s.Z,{children:[(0,l.jsx)(d.Z,{sx:{mb:3},children:"Defina a pontua\xe7\xe3o para cada alternativa"}),(0,l.jsx)(m.Z,{sx:{mb:4},children:(0,l.jsx)(u.Z,{row:!0,children:(0,l.jsx)(x.Z,{label:"Habilitar pontua\xe7\xe3o",control:(0,l.jsx)(v.Z,{name:"pontuacao",...I("pontuacao"),checked:(null==f?void 0:f.pontuacao)==1,onChange(e){g({...f,pontuacao:e.target.checked?1:0})}})})})}),f&&(null==f?void 0:f.alternatives.map((e,o)=>(0,l.jsx)(h.ZP,{md:12,sx:{mb:4},children:(0,l.jsx)("grid",{item:!0,md:12,children:(0,l.jsx)(p.Z,{fullWidth:!0,children:(0,l.jsx)(j.Z,{disabled:1!=f.pontuacao,id:"outlined-basic",label:null==e?void 0:e.nome,...I("".concat(null==e?void 0:e.nome)),name:"".concat(null==e?void 0:e.nome),defaultValue:null==e?void 0:e.score,variant:"outlined",size:"small",type:"number",title:0!=f.pontuacao||"Habilite a pontua\xe7\xe3o para preencher"})})})},o)))]}),(0,l.jsxs)(r.Z,{className:"dialog-actions-dense",children:[(0,l.jsx)(t.Z,{variant:"outlined",color:"primary",onClick:C,children:"Cancelar"}),(0,l.jsx)(t.Z,{variant:"contained",color:"primary",onClick:k(S),children:"Confirmar"})]})]})})})};o.Z=f},1322:function(e,o,n){var l=n(85893),t=n(95398),i=n(44642),a=n(1890),s=n(77745);n(67294);let r=e=>{let{title:o,description:n,setOpenModal:r,openModal:d,children:c,size:m}=e;return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(a.Z,{open:d,onClose:()=>r(!1),fullWidth:!!m,maxWidth:m||null,children:[(0,l.jsx)(s.Z,{id:"form-dialog-title",children:o}),(0,l.jsx)(t.Z,{children:(0,l.jsx)(i.Z,{sx:{py:2},children:c})})]})})};o.Z=r}}]);