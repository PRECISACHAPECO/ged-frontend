(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7463],{59424:function(e,o,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/formularios/fornecedor",function(){return a(33740)}])},93250:function(e,o,a){"use strict";var t=a(85893),n=a(49837),r=a(91359),i=a(69175);let l=e=>{let{result:o,columns:a,btnNew:l=!0,btnPrint:s=!0,btnBack:d,openModal:c,modaLog:u}=e;return(0,t.jsx)(n.Z,{children:(0,t.jsx)(r.Z,{sx:{pt:"0"},children:(0,t.jsx)(i.Z,{rows:o,columns:a,modaLog:u,buttonsHeader:{btnNew:l,btnPrint:s,btnBack:d,openModal:c}})})})};o.Z=l},52189:function(e,o,a){"use strict";var t=a(85893),n=a(64004);a(67294);var r=a(42404),i=a(17844);let l=()=>{var e,o,a,l,s,d,c,u,p;let m=(0,i.Z)(),x=null==m?void 0:null===(e=m.header)||void 0===e?void 0:e.filter(e=>"Nome Fantasia"===e.name)[0].value;return m&&(0,t.jsxs)(n.G7,{style:{width:"100%"},children:[(0,t.jsx)(n.G7,{style:{padding:3,backgroundColor:"#eee",marginTop:20,border:"1px solid #ddd"},children:(0,t.jsx)(n.xv,{style:{width:"100%",textAlign:"center",fontSize:12},children:"QUALIFICA\xc7\xc3O DE FORNECEDORES"})}),(0,t.jsx)(n.G7,{style:{marginTop:20},children:(0,t.jsxs)(n.xv,{style:{fontSize:10},children:["A empresa ",(0,t.jsx)(n.xv,{children:null==m?void 0:m.unidade})," possui como norma de BPF a avalia\xe7\xe3o de seus fornecedores quanto as mat\xe9rias primas e ingredientes por estes fornecidos."]})}),"Fornecedor",(0,t.jsx)(n.G7,{style:{marginTop:20},children:(0,t.jsxs)(n.xv,{style:{fontSize:10},children:["Fornecedor: ",(0,t.jsx)(n.xv,{style:{fontWeight:"bold",fontSize:10},children:x})]})}),(0,t.jsx)(n.G7,{style:{marginTop:20},children:(0,t.jsxs)(n.xv,{style:{fontSize:10},children:[(null==m?void 0:null===(o=m.produtos)||void 0===o?void 0:o.length)>1?"Produtos fornecidos: ":"Produto fornecido: ",null==m?void 0:null===(a=m.produtos)||void 0===a?void 0:a.map((e,o)=>(0,t.jsxs)(n.xv,{children:[(0,t.jsx)(n.xv,{style:{fontWeight:"bold",fontSize:10},children:e.produtos}),o!==m.produtos.length-1&&", "]},o))]})}),(0,t.jsx)(n.G7,{style:{marginTop:20},children:(0,t.jsx)(n.G7,{style:r.W.containerFields,children:null===(l=m.header)||void 0===l?void 0:l.map((e,o)=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.G7,{style:[r.W.fields,{width:"33%"}],children:[(0,t.jsx)(n.xv,{style:r.W.fieldTitle,children:null!==(d=e.name)&&void 0!==d?d:"NI"}),(0,t.jsx)(n.xv,{style:r.W.fieldValue,children:null!==(c=e.value)&&void 0!==c?c:"NI"})]}),(o+1)%3==0&&(0,t.jsx)(n.G7,{style:r.W.separator})]}))})}),null===(s=m.blocks)||void 0===s?void 0:s.map((e,o)=>(0,t.jsx)(n.G7,{style:[e,{marginTop:30}],children:(0,t.jsxs)(n.G7,{style:r.W.table,children:[(0,t.jsxs)(n.G7,{style:r.W.tableTitle,children:[(0,t.jsx)(n.xv,{style:[r.W.tableTitlecolumn,{width:"60%"}],children:e.nome}),(0,t.jsx)(n.xv,{style:[r.W.tableTitlecolumn,{width:"20%",borderLeft:"1px solid #ddd"}],children:"Resposta"}),(0,t.jsx)(n.xv,{style:[r.W.tableTitlecolumn,{width:"20%",borderLeft:"1px solid #ddd"}],children:"Observa\xe7\xe3o"})]}),e.itens.map((e,o)=>(0,t.jsxs)(n.G7,{style:r.W.tableContainer,children:[(0,t.jsx)(n.G7,{style:[r.W.tableContent,{width:"60%"}],children:(0,t.jsx)(n.xv,{style:r.W.tableContentcolumn,children:e.nome})}),(0,t.jsx)(n.G7,{style:[r.W.tableContent,{width:"20%"}],children:(0,t.jsx)(n.xv,{style:r.W.tableContentcolumn,children:null!==(u=e.resposta)&&void 0!==u?u:""})}),(0,t.jsx)(n.G7,{style:[r.W.tableContent,{width:"20%"}],children:(0,t.jsx)(n.xv,{style:r.W.tableContentcolumn,children:null!==(p=e.obsResposta)&&void 0!==p?p:""})})]}))]})},o))]})};o.Z=l},17844:function(e,o,a){"use strict";var t=a(60664),n=a(67294);let r=()=>{let[e,o]=(0,n.useState)([]),a=localStorage.getItem("report"),r=JSON.parse(a),i=async()=>{let e={...r.params.data};try{let a=await t.h.post("relatorio/".concat(r.params.route),e);o(a.data)}catch(n){console.log(n)}};return(0,n.useEffect)(()=>{r&&i()},[]),e};o.Z=r},42404:function(e,o,a){"use strict";a.d(o,{W:function(){return n}});var t=a(64004);let n=t.mM.create({page:{flexDirection:"column",backgroundColor:"#FFF",justifyContent:"start",paddingTop:15,paddingBottom:30},title:{},header:{position:"fixed",top:-10,left:0,right:0,margin:"0 auto",fontSize:12,height:50,width:"92%",display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},content:{marginHorizontal:10,fontSize:11,padding:15,flex:1},footer:{position:"absolute",bottom:20,color:"grey",width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-between",paddingHorizontal:25,fontSize:10},blockTitle:{paddingVertical:5},containerFields:{display:"flex",flexDirection:"row",flexWrap:"wrap",width:"100%",paddingTop:2},fields:{display:"flex",flexDirection:"column",gap:"2px",paddingBottom:5,paddingTop:5},fieldTitle:{fontSize:8,opacity:"0.8"},fieldValue:{fontSize:10},separator:{height:"1px",width:"100%",borderBottom:"1px solid #ddd"},table:{width:"100%",display:"flex",flexDirection:"column",borderRight:"1px solid #ddd",borderTop:"1px solid #ddd",borderBottom:"1px solid #ddd",borderTopLeftRadius:3,borderTopRightRadius:3,borderBottomLeftRadius:3,borderBottomRightRadius:3},tableTitle:{display:"flex",flexDirection:"row",width:"100%",fontSize:8,backgroundColor:"#EEE",borderTopLeftRadius:2,borderTopRightRadius:2,borderLeft:"1px solid #ddd"},tableTitlecolumn:{padding:8},tableContainer:{display:"flex",flexDirection:"row",width:"100%"},tableContent:{padding:8,borderLeft:"1px solid #ddd",borderTop:"1px solid #ddd"},tableContentcolumn:{fontSize:9}})},99384:function(e,o,a){"use strict";var t=a(67294),n=a(46749);let r=()=>{let[e,o]=(0,t.useState)({}),a=(e,a,t,r)=>{let i=new Date(t),l=(0,n.HD)(e,i,r);o(e=>({...e,[a]:l}))};return{setDateFormat:a,dateStatus:e}};o.Z=r},33740:function(e,o,a){"use strict";a.r(o),a.d(o,{default:function(){return Q}});var t=a(85893),n=a(67294),r=a(60664),i=a(93250),l=a(87536),s=a(56531),d=a(99734),c=a(34282),u=a(7071),p=a(29308),m=a(23895),x=a(19604),f=a(61953),h=a(49837),v=a(91359),g=a(29630),D=a(79072),I=a(55343),b=a(11163),j=a.n(b),y=a(46749);a(86887);var C=a(83830),Z=a(40039),F=a(39976),S=a(47842),w=a(86501),E=a(66136),P=a(80377),A=a(22416),N=a(22841),z=a(16056);let T=e=>{let{xs:o,md:a,title:n,index:r,name:i,typePage:l,value:s,disabled:d,register:c,...u}=e;return(0,t.jsx)(D.ZP,{item:!0,xs:o,md:a,children:(0,t.jsx)(f.Z,{display:"flex",flexDirection:"column",alignItems:"start",children:(0,t.jsx)(N.Z,{control:(0,t.jsx)(z.Z,{...u,name:i,...c(i),defaultChecked:s,disabled:d,onChange(e){u.onChange&&u.onChange(e.target.checked,r,i,l)}}),label:n,size:"small",sx:{"&:hover":{"& .MuiFormControlLabel-label":{color:"primary.main"}}}})})})},k=e=>{let{data:o,control:a,setValue:r,register:i,errors:l}=e,[s,d]=(0,n.useState)(!0);return r("emailDestinatario",o.email),(0,t.jsxs)("div",{className:"flex flex-col gap-2 pt-2",children:[s&&(0,t.jsx)(p.Z,{name:"emailDestinatario",type:"email",title:"E-mail do destinat\xe1rio",required:!0,control:a,errors:l.emailDestinatario}),(0,t.jsx)(p.Z,{name:"assunto",title:"Assunto",required:!0,register:i,control:a,defaultValue:"",errors:l.assunto}),(0,t.jsx)(p.Z,{name:"descricao",title:"Descri\xe7\xe3o",multiline:!0,rows:4,required:!0,control:a,defaultValue:"",errors:l.descricao}),(0,t.jsxs)(A.Z,{row:!0,children:[(0,t.jsx)(T,{name:"email",title:"E-mail",value:!0,register:i,onChange:()=>d(!s)}),(0,t.jsx)(T,{name:"alerta",title:"Alerta",value:!0,register:i})]})]})};var R=a(27304),W=a(44373);a(80587);var G=a(92945);let H=e=>{let{values:o,handleFileSelect:a,handleRemove:r,loadingFile:i,disabled:l,errors:s}=e,{settings:d}=(0,n.useContext)(E.J6),c=d.mode,[u,p]=(0,n.useState)(null),m=(0,n.useRef)(null),x=e=>{m.current.click(),p(e)};return(0,n.useEffect)(()=>{m.current&&(m.current.value="")},[a]),(0,t.jsx)("div",{className:"flex flex-col gap-2",children:o&&o.map((e,n)=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(D.ZP,{container:!0,spacing:2,children:(0,t.jsx)(D.ZP,{item:!0,xs:12,sm:6,children:(0,t.jsxs)(f.Z,{display:"flex",alignItems:"center",sx:{gap:1},children:[(0,t.jsx)(g.Z,{color:"primary",variant:"subtitle1",sx:{fontWeight:700},children:e.nome}),(0,t.jsx)(g.Z,{variant:"body2",children:"(".concat(e.unidadeMedida,")")})]})})},n),e.produtoAnexosDescricao&&e.produtoAnexosDescricao.length>0&&(0,t.jsx)(D.ZP,{container:!0,spacing:4,children:e.produtoAnexosDescricao.map((e,o)=>(0,t.jsx)(G.Z,{modeTheme:c,handleFileClick:x,selectedItem:u,inputRef:m,item:e,loadingFile:i,indexBlock:n,indexItem:o,handleFileSelect:a,folder:"produto",handleRemove:r,error:s,disabled:l},"".concat(n,"-").concat(o)))}),e.anexos&&0===e.anexos.length&&(0,t.jsx)(g.Z,{variant:"body2",sx:{mb:2},children:"Este produto n\xe3o exige anexos"}),n<o.length-1&&(0,t.jsx)(W.Z,{sx:{my:4}})]}))})};var M=a(50287),O=a(99384);let L=e=>{var o,a,i,l,d,c,u;let{modeloID:m,values:x,fields:f,disabled:h,register:v,errors:g,setValue:I,control:b,getAddressByCep:j}=e,[C,Z]=(0,n.useState)([]),{setDateFormat:F,dateStatus:S}=(0,O.Z)(),w=async()=>{let e=await r.h.post("/cadastros/profissional/getProfissionaisAssinatura",{formularioID:1,modeloID:m});Z(e.data.preenche)};return(0,n.useEffect)(()=>{w(),x&&!x.data&&I("fieldsHeader.data",(0,y.Ux)()),x&&!x.hora&&I("fieldsHeader.hora",(0,y.Xn)())},[x]),(0,t.jsxs)(D.ZP,{container:!0,spacing:4,children:[(0,t.jsx)(M.Z,{xs:12,md:2,title:"Data da avalia\xe7\xe3o",name:"fieldsHeader.data",type:"date",value:null!==(c=null==x?void 0:x.data)&&void 0!==c?c:(0,y.Ux)(),disabled:h,register:v,control:b,setDateFormat:F,typeValidation:"dataPassado",daysValidation:365,dateStatus:S,errors:null==g?void 0:null===(o=g.fieldsHeader)||void 0===o?void 0:o.data}),(0,t.jsx)(p.Z,{xs:12,md:2,title:"Hora da avalia\xe7\xe3o",name:"fieldsHeader.hora",value:null!==(u=null==x?void 0:x.data)&&void 0!==u?u:(0,y.Xn)(),type:"time",disabled:h,register:v,control:b,errors:null==g?void 0:null===(a=g.fieldsHeader)||void 0===a?void 0:a.hora}),(0,t.jsx)(p.Z,{xs:12,md:4,title:"CNPJ",name:"fieldsHeader.cnpj",type:"string",mask:"cnpj",disabled:h,register:v,control:b,errors:null==g?void 0:null===(i=g.fieldsHeader)||void 0===i?void 0:i.cnpj}),(0,t.jsx)(p.Z,{xs:12,md:4,title:"Raz\xe3o Social",name:"fieldsHeader.razaoSocial",type:"string",disabled:h,register:v,control:b,errors:null==g?void 0:null===(l=g.fieldsHeader)||void 0===l?void 0:l.razaoSocial}),(0,t.jsx)(p.Z,{xs:12,md:4,title:"Nome Fantasia",name:"fieldsHeader.nomeFantasia",type:"string",disabled:h,register:v,control:b,errors:null==g?void 0:null===(d=g.fieldsHeader)||void 0===d?void 0:d.nomeFantasia}),(0,t.jsx)(s.Z,{register:v,errors:g,setValue:I,control:b,fields:f,values:f,getAddressByCep:j,disabled:h})]})};a(84220);var B=a(41088),V=a(92629);a(64004),a(52189),a(30140),a(15758);let q=e=>{var o;let a;let{id:i,makeFornecedor:s}=e,{menu:b,user:A,loggedUnity:N}=(0,n.useContext)(Z.V),[z,T]=(0,n.useState)(!1),[W,G]=(0,n.useState)(!1),[M,O]=(0,n.useState)(!1),[q,_]=(0,n.useState)(!1),[J,U]=(0,n.useState)(!1),[X,Q]=(0,n.useState)(!1),[K,Y]=(0,n.useState)(!0),[$,ee]=(0,n.useState)(!0),[eo,ea]=(0,n.useState)(null),[et,en]=(0,n.useState)([]),[er,ei]=(0,n.useState)([]),[el,es]=(0,n.useState)(null),{createNewNotification:ed}=(0,n.useContext)(F.u),[ec,eu]=(0,n.useState)(!1),[ep,em]=(0,n.useState)([]),[ex,ef]=(0,n.useState)([]),[eh,ev]=(0,n.useState)([]),[eg,eD]=(0,n.useState)(null),[eI,eb]=(0,n.useState)([]),[ej,ey]=(0,n.useState)(null),[eC,eZ]=(0,n.useState)(""),[eF,eS]=(0,n.useState)(!1),[ew,eE]=(0,n.useState)(!1),[eP,eA]=(0,n.useState)({status:!1,errors:[]}),{settings:eN}=(0,n.useContext)(E.J6),{setId:ez}=(0,n.useContext)(C.X),[eT,ek]=(0,n.useState)([]),[eR,eW]=(0,n.useState)(!1),[eG,eH]=(0,n.useState)(null),[eM,eO]=(0,n.useState)({status:!1,message:"Voc\xea n\xe3o tem permiss\xf5es",messageType:"info"}),eL=j(),eB=i&&i>0?"edit":"new",eV=eL.pathname;console.log("\uD83D\uDE80 ~ staticUrl:",eV);let{startLoading:eq,stopLoading:e_}=(0,B.Z)(),{reset:eJ,register:eU,getValues:eX,setValue:eQ,control:eK,watch:eY,handleSubmit:e$,clearErrors:e0,setError:e1,formState:{errors:e2}}=(0,l.cI)();console.log("formFornecedor errors: ",e2);let e3=async(e,o)=>{let a={status:e,observacao:o,auth:{usuarioID:A.usuarioID,papelID:A.papelID,unidadeID:N.unidadeID}};try{U(!0),await r.h.post("".concat(eV,"/changeFormStatus/").concat(i),a).then(o=>{w.ZP.success(y.OD.successUpdate),U(!1),od(e,null,null)})}catch(t){console.log(t)}},e7=async e=>{try{if(!e.email&&!e.alerta)return w.ZP.error("Selecione ao menos um tipo de notifica\xe7\xe3o!");let o={titulo:e.assunto,descricao:e.descricao,url:"/formularios/fornecedor/",urlID:i,tipoNotificacaoID:3,usuarioGeradorID:A.usuarioID,usuarioID:0,unidadeID:eo.fornecedor.unidadeID,papelID:2,email:e.email,alerta:e.alerta};if(console.log("\uD83D\uDE80 ~ data dat notifica\xe7\xe3o:",o),ed(o),e.email){let a={values:e,auth:{id:i,usuarioID:A.usuarioID,papelID:A.papelID,unidadeID:N.unidadeID}};await r.h.post("".concat(eV,"/sendNotification"),a)}let t=e.alerta&&e.email?"E-mail e alerta enviados com sucesso!":e.alerta&&!e.email?"Alerta criado com sucesso!":!e.alerta&&e.email?"E-mail enviado com sucesso!":null;w.ZP.success(t)}catch(n){console.log(n)}},e4=()=>{navigator.clipboard.writeText(eg),w.ZP.success("Link copiado com sucesso!")},e8=()=>{ez(eo.parFornecedorModeloID),eL.push("/configuracoes/formularios/fornecedor/")},e9={id:1,name:"Gerar novo formul\xe1rio",description:"Gerar um novo formul\xe1rio de preenchimento para este fornecedor.",component:(0,t.jsx)(R.Z,{cnpj:null==ep?void 0:ep.cnpj}),route:null,type:null,modal:!0,action:s,size:"lg",icon:"fluent:form-new-20-regular",identification:null},e5={id:2,name:"Gerar notifica\xe7\xe3o",description:"Gerar uma nova notifica\xe7\xe3o para o fornecedor, podendo ser um e-mail e/ou alerta do sistema.",component:(0,t.jsx)(k,{data:{email:null===(o=eh.find(e=>"email"==e.nomeColuna))||void 0===o?void 0:o.email}}),route:null,type:null,modal:!0,action:e7,icon:"cil:bell",identification:null},e6={id:3,name:"Copiar link do formul\xe1rio",description:"Copiar o link deste formul\xe1rio.",component:(0,t.jsx)(R.Z,{}),route:null,type:null,action:e4,modal:!1,icon:"solar:copy-outline",identification:null},oe={id:4,name:"Formul\xe1rio do fornecedor",nameComponent:"DadosFornecedor",type:"report",params:{data:{id:i,unidadeID:N.unidadeID,papelID:A.papelID,usuarioID:A.usuarioID},route:"fornecedor/dadosFornecedor"},icon:"fluent:print-24-regular"},oo=[];1==A.papelID&&oo.push(e9),oo.push(e5),oo.push(e6),oo.push(oe),1==A.papelID&&(a=!1,b.map(e=>{e.menu.map(e=>{e.submenu&&e.submenu.length>0&&e.submenu.map(e=>{"/configuracoes/formularios"==e.rota&&(a=!0)})})}),a)&&oo.push({id:5,name:"Configura\xe7\xf5es do formul\xe1rio",description:"Alterar as configura\xe7\xf5es do modelo de formul\xe1rio.",route:null,type:null,action:e8,modal:!1,icon:"bi:gear",identification:null});let oa=async()=>{try{await r.h.post("".concat(eV,"/verifyFormPending/").concat(i),{parFormularioID:1}).then(e=>{Y(e.data) //! true/false
})}catch(e){console.log(e)}},ot=()=>{T(!0);try{r.h.post("".concat(eV,"/getData/").concat(i),{type:eB,unidadeID:N.unidadeID}).then(e=>{var o,a,t;console.log("getData: ",e.data),T(!1),em(e.data.fieldsHeader),ef(e.data.fieldsFooter),ev(e.data.fields),en(e.data.produtos),eb(e.data.blocos),ei(e.data.grupoAnexo),eZ(e.data.info),ea(e.data.unidade),eD(e.data.link),ey(e.data.ultimaMovimentacao),oi(e.data.blocos),eJ(e.data);let n=[];for(let r=0;r<e.data.fields.length;r++){let i=e.data.fields[r].nomeColuna,l=e.data.fields[r].nomeCampo;for(let s in N){if("telefone"==i){let d=null!==(t=N.telefone1)&&void 0!==t?t:N.telefone2;eQ("fields[".concat(r,"].").concat(i),null!=d?d:"")}s!==i||eX("fields[".concat(r,"].").concat(i),N[s])||(eQ("fields[".concat(r,"].").concat(i),N[s]),null!==N[s]&&""!==N[s]&&n.push({name:l,value:N[s]}))}}ek(n);let c=y.WR[null==e?void 0:null===(o=e.data)||void 0===o?void 0:null===(a=o.info)||void 0===a?void 0:a.status];es(c),eO({status:A.papelID==e.data.unidade.quemPreenche,message:2==A.papelID&&e.data.info.status>=40?"Esse formul\xe1rio j\xe1 foi conclu\xeddo e enviado pra f\xe1brica, n\xe3o \xe9 mais poss\xedvel alterar as informa\xe7\xf5es!":1==A.papelID&&e.data.info.status<40?"Somente o fornecedor pode alterar as informa\xe7\xf5es deste formul\xe1rio!":1==A.papelID&&40==e.data.info.status?"Este formul\xe1rio est\xe1 aguardando aprova\xe7\xe3o":null,messageType:2==A.papelID?"warning":"info"}),oa()}).catch(e=>{console.log("\uD83D\uDE80 ~ error:",e),T(!1)})}catch(e){console.log("\uD83D\uDE80 ~ error:",e),T(!1)}},on=()=>{e0();let e=!1,o=[];null==eh||eh.forEach((a,t)=>{let n=a.tabela?"fields[".concat(t,"].").concat(a.tabela):"fields[".concat(t,"].").concat(a.nomeColuna),r=eX(n);1!==a.obrigatorio||r||(e1(n,{type:"manual",message:"Campo obrigat\xf3rio"}),o.push(null==a?void 0:a.nomeCampo),e=!0)}),et&&et.length>0&&et.forEach((a,t)=>{a.produtoAnexosDescricao.forEach((n,r)=>{1===n.obrigatorio&&0==n.anexos.length&&(e1("produtos[".concat(t,"].produtoAnexosDescricao[").concat(r,"].anexos"),{type:"manual",message:"Campo obrigat\xf3rio"}),o.push("Anexo: ".concat(null==a?void 0:a.nome," / ").concat(null==n?void 0:n.nome)),e=!0)})}),eI.forEach((a,t)=>{a.itens.forEach((a,n)=>{let r=eX("blocos[".concat(t,"].itens[").concat(n,"].resposta"));(null==a?void 0:a.obrigatorio)!==1||r||(e1("blocos[".concat(t,"].itens[").concat(n,"].resposta"),{type:"manual",message:"Campo obrigat\xe1rio"}),o.push(null==a?void 0:a.nome),e=!0),a.respostaConfig&&1==a.respostaConfig.anexo&&a.respostaConfig.anexosSolicitados.length>0&&a.respostaConfig.anexosSolicitados.forEach((r,i)=>{1==r.obrigatorio&&r.anexos&&0==r.anexos.length&&(e1("blocos[".concat(t,"].itens[").concat(n,"].respostaConfig.anexosSolicitados[").concat(i,"].anexos"),{type:"manual",message:"Campo obrigat\xe1rio"}),o.push("Anexo: ".concat(null==a?void 0:a.nome," / ").concat(null==r?void 0:r.nome)),e=!0)})})}),er&&er.length>0&&er.forEach((a,t)=>{a.itens.forEach((n,r)=>{1===n.obrigatorio&&0==n.anexos.length&&(e1("grupoAnexo[".concat(t,"].itens[").concat(r,"].anexos"),{type:"manual",message:"Campo obrigat\xe1rio"}),o.push("Anexo: ".concat(null==a?void 0:a.nome," / ").concat(null==n?void 0:n.nome)),e=!0)})}),eA({status:e,errors:o})},or=async e=>{if(9===e.length){let o=e.replace(/[^0-9]/g,"");try{let a=await r.h.get("https://viacep.com.br/ws/".concat(o,"/json/"));a.data.localidade?(eh.forEach(async(e,o)=>{("logradouro"===e.nomeColuna||"bairro"===e.nomeColuna||"cidade"===e.nomeColuna||"estado"===e.nomeColuna)&&(await eQ("fields[".concat(o,"].logradouro"),a.data.logradouro),await eQ("fields[".concat(o,"].bairro"),a.data.bairro),await eQ("fields[".concat(o,"].cidade"),a.data.localidade),await eQ("fields[".concat(o,"].estado"),a.data.uf))}),w.ZP.success("Endere\xe7o encontrado!")):w.ZP.error("Endere\xe7o n\xe3o encontrado!")}catch(t){console.error(t)}}};(0,n.useEffect)(()=>{let e={id:4,name:"Formul\xe1rio do fornecedor",nameComponent:"DadosFornecedor",type:"report",params:{data:{id:i,unidadeID:N.unidadeID,papelID:A.papelID},route:"fornecedor/dadosFornecedor"},icon:"fluent:print-24-regular"};localStorage.setItem("report",JSON.stringify(e))},[]);let oi=e=>{let o=!0;e.forEach(e=>{e.itens.forEach(e=>{e.respostaConfig&&1==e.respostaConfig.bloqueiaFormulario&&(o=!1)})}),ee(o)},ol=async()=>{let e=new FormData;e.append("files[]",eG,"".concat(i,"-fornecedor.pdf"));try{await r.h.post("/formularios/fornecedor/saveRelatorio/".concat(i,"/").concat(A.usuarioID,"/").concat(N.unidadeID),e)}catch(o){console.log(o)}},os=async e=>{ol(),e.conclusion=!0,await e$(oc)(e)},od=(e,o,a)=>{let t=30==e?"Em preenchimento":40==e?"Conclu\xeddo":50==e?"Reprovado":60==e?"Aprovado parcialmente":70==e?"Aprovado":"Pendente",n={titulo:"Formul\xe1rio de Fornecedor ".concat(t),descricao:"O formul\xe1rio de Fornecedor #".concat(i," est\xe1 ").concat(t,"."),url:"/formularios/fornecedor/",urlID:i,tipoNotificacaoID:6,usuarioGeradorID:A.usuarioID,usuarioID:0,unidadeID:N.unidadeID,papelID:1};if(n&&(ed(n),o)){let r={titulo:"Fornecedor gerado",descricao:"O formul\xe1rio de Fornecedor #".concat(i," est\xe1 ").concat(t," e gerou uma n\xe3o conformidade."),url:"/formularios/fornecedor/nao-conformidade/",urlID:a,tipoNotificacaoID:5,usuarioGeradorID:A.usuarioID,usuarioID:0,unidadeID:N.unidadeID,papelID:1};ed(r)}};console.log("\uD83D\uDE80 ~ isLoadingaaaaaaaaaaaaaaaaaaa:",z);let oc=async function(e){let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log("\uD83D\uDE80 ~ param:",o),eq(),console.log("fun\xe7\xe3o ativada inicio"),!0===o.conclusion&&(e.status=A&&1==A.papelID?o.status:40,e.obsConclusao=o.obsConclusao);let a={form:e,auth:{usuarioID:A.usuarioID,papelID:A.papelID,unidadeID:N.unidadeID}};console.log("\uD83D\uDE80 ~ data:",a);try{"edit"==eB?(U(!0),await r.h.post("".concat(eV,"/updateData/").concat(i),a).then(o=>{w.ZP.success(y.OD.successUpdate),U(!1);let a=null;o.data&&o.data.naoConformidade&&o.data.id>0&&(eL.push("/formularios/fornecedor/nao-conformidade/"),ez(o.data.id),a=o.data.id),od(e.status,e.naoConformidade,a)})):"new"==eB?await r.h.post("".concat((0,y.g_)(eV),"/insertData"),a).then(e=>{eL.push("".concat((0,y.g_)(eV))),ez(e.data),w.ZP.success(y.OD.successNew)}):w.ZP.error(y.OD.error)}catch(t){console.log(t)}finally{e_(),console.log("fun\xe7\xe3o ativada fim finally")}},ou=async(e,o)=>{O(!0);let a=e.target.files;if(a&&a.length>0){var t;let n=new FormData;for(let l=0;l<a.length;l++)n.append("files[]",a[l]);n.append("usuarioID",A.usuarioID),n.append("unidadeID",N.unidadeID),n.append("produtoAnexoID",null!==(t=o.produtoAnexoID)&&void 0!==t?t:null),await r.h.post("".concat(eV,"/saveAnexo/").concat(i,"/produto/").concat(A.usuarioID,"/").concat(eo.unidadeID),n).then(e=>{O(!1);let o=eX();oc(o)}).catch(e=>{var o,a,t;O(!1),w.ZP.error(null!==(t=null===(o=e.response)||void 0===o?void 0:null===(a=o.data)||void 0===a?void 0:a.message)&&void 0!==t?t:"Erro ao atualizar anexo, tente novamente!")})}},op=async(e,o)=>{G(!0);let a=e.target.files;if(a&&a.length>0){var t;let n=new FormData;for(let l=0;l<a.length;l++)n.append("files[]",a[l]);n.append("usuarioID",A.usuarioID),n.append("unidadeID",N.unidadeID),n.append("grupoAnexoItemID",null!==(t=o.grupoAnexoItemID)&&void 0!==t?t:null),await r.h.post("".concat(eV,"/saveAnexo/").concat(i,"/grupo-anexo/").concat(A.usuarioID,"/").concat(eo.unidadeID),n).then(e=>{G(!1);let o=eX();oc(o)}).catch(e=>{var o,a,t;G(!1),w.ZP.error(null!==(t=null===(o=e.response)||void 0===o?void 0:null===(a=o.data)||void 0===a?void 0:a.message)&&void 0!==t?t:"Erro ao atualizar anexo, tente novamente!")})}},om=async(e,o)=>{_(!0);let a=e.target.files;if(a&&a.length>0){var t,n;let l=new FormData;for(let s=0;s<a.length;s++)l.append("files[]",a[s]);l.append("usuarioID",A.usuarioID),l.append("unidadeID",N.unidadeID),l.append("parFornecedorModeloBlocoID",null!==(t=o.parFornecedorModeloBlocoID)&&void 0!==t?t:null),l.append("itemOpcaoAnexoID",null!==(n=o.itemOpcaoAnexoID)&&void 0!==n?n:null),await r.h.post("".concat(eV,"/saveAnexo/").concat(i,"/item/").concat(A.usuarioID,"/").concat(eo.unidadeID),l).then(e=>{_(!1);let o=eX();oc(o)}).catch(e=>{var o,a,t;_(!1),w.ZP.error(null!==(t=null===(o=e.response)||void 0===o?void 0:null===(a=o.data)||void 0===a?void 0:a.message)&&void 0!==t?t:"Erro ao atualizar anexo, tente novamente!!!!")})}},ox=async e=>{try{let o=await r.h.post("/cadastros/item/getItemConfigs",{itemID:e.itemID,alternativaItemID:e.alternativa.id}),a=eI.map(a=>({...a,itens:a.itens.map(a=>a.itemID==e.itemID?{...a,respostaConfig:{...o.data}}:a)}));eb(a)}catch(t){console.log("error",t)}},of=async e=>{e&&await r.h.delete("".concat(eV,"/deleteAnexo/").concat(i,"/").concat(e.anexoID,"/").concat(eo.unidadeID,"/").concat(A.usuarioID,"/produto")).then(e=>{let o=eX();oc(o)}).catch(e=>{var o,a,t;w.ZP.error(null!==(t=null===(o=e.response)||void 0===o?void 0:null===(a=o.data)||void 0===a?void 0:a.message)&&void 0!==t?t:"Erro ao remover anexo, tente novamente!")})},oh=async e=>{e&&await r.h.delete("".concat(eV,"/deleteAnexo/").concat(i,"/").concat(e.anexoID,"/").concat(eo.unidadeID,"/").concat(A.usuarioID,"/grupo-anexo")).then(e=>{let o=eX();oc(o)}).catch(e=>{var o,a,t;w.ZP.error(null!==(t=null===(o=e.response)||void 0===o?void 0:null===(a=o.data)||void 0===a?void 0:a.message)&&void 0!==t?t:"Erro ao remover anexo, tente novamente!")})},ov=async e=>{e&&await r.h.delete("".concat(eV,"/deleteAnexo/").concat(i,"/").concat(e.anexoID,"/").concat(eo.unidadeID,"/").concat(A.usuarioID,"/item")).then(e=>{let o=eX();oc(o)}).catch(e=>{var o,a,t;w.ZP.error(null!==(t=null===(o=e.response)||void 0===o?void 0:null===(a=o.data)||void 0===a?void 0:a.message)&&void 0!==t?t:"Erro ao remover anexo, tente novamente!")})};return(0,n.useEffect)(()=>{"edit"==eB&&ot()},[i,J]),(0,n.useEffect)(()=>{on()},[]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(S.Z,{show:z}),(0,t.jsxs)("form",{onSubmit:e$(oc),children:[eT&&eT.length>0&&(0,t.jsxs)(x.Z,{severity:"info",sx:{mb:2},children:[(0,t.jsxs)("h1",{children:["Os seguintes campos foram copiados de ",(0,t.jsx)("strong",{children:"Meus Dados"}),":"]}),(0,t.jsx)("div",{className:"pt-2",children:eT.map(e=>(0,t.jsx)("div",{className:"flex opacity-80",children:(0,t.jsx)("p",{children:"- ".concat(e.name," (").concat(e.value,")")})}))})]}),(0,t.jsxs)(f.Z,{display:"flex",flexDirection:"column",sx:{gap:4},children:[eC&&""!=eC.cabecalhoModelo&&(0,t.jsx)(h.Z,{children:(0,t.jsx)(v.Z,{children:(0,t.jsx)(g.Z,{variant:"subtitle1",sx:{mb:2},children:eC.cabecalhoModelo})})}),(0,t.jsxs)(h.Z,{children:[(0,t.jsx)(V.Z,{title:"Excluir Formul\xe1rio",description:"Tem certeza que deseja exluir o formulario?",params:{route:"formularios/fornecedor/delete/".concat(i),messageSucceded:"Formul\xe1rio exclu\xeddo com sucesso!",MessageError:"Dado possui pend\xeancia!"},open:eR,handleClose:()=>eW(!1)}),(0,t.jsx)(v.Z,{children:eo&&(0,t.jsxs)(f.Z,{display:"flex",flexDirection:"column",sx:{gap:1},children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)(g.Z,{variant:"caption",children:"Aberto por ".concat(ep.abertoPor.profissional.nome," em ").concat(ep.abertoPor.dataInicio," ").concat(ep.abertoPor.horaInicio," ")}),(0,t.jsx)(u.Z,{size:"small",skin:"light",color:"primary",label:(1==eo.quemPreenche?"F\xe1brica":"Fornecedor")+" preenche"})]}),(0,t.jsx)(L,{modeloID:eo.parFornecedorModeloID,values:ep,fields:eh,disabled:!eM.status||K,register:eU,errors:e2,setValue:eQ,control:eK,getAddressByCep:or})]})})]}),eo&&(null==eo?void 0:eo.obrigatorioProdutoFornecedor)&&et&&et.length>0&&(0,t.jsx)(h.Z,{children:(0,t.jsx)(v.Z,{children:(0,t.jsx)(H,{values:et,handleFileSelect:ou,handleRemove:of,loadingFile:M,disabled:!eM.status||K,errors:null==e2?void 0:e2.produtos},M)})}),eI&&eI.map((e,o)=>(0,t.jsx)(d.Z,{index:o,blockKey:"parFornecedorModeloBlocoID",handleFileSelect:om,setItemResposta:ox,handleRemoveAnexoItem:ov,setBlocos:eb,values:e,control:eK,register:eU,setValue:eQ,errors:null==e2?void 0:e2.blocos,disabled:!eM.status||K},o)),er&&er.map((e,o)=>(0,t.jsx)(m.Z,{values:{grupo:e,loadingFile:W,indexGrupo:o,handleFileSelect:op,handleRemove:oh,folder:"grupo-anexo",disabled:!eM.status,error:e2}},o)),eC&&(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(h.Z,{children:(0,t.jsx)(v.Z,{children:(0,t.jsx)(D.ZP,{container:!0,spacing:4,children:(0,t.jsx)(D.ZP,{item:!0,xs:12,md:12,children:(0,t.jsxs)(I.Z,{fullWidth:!0,children:[(0,t.jsx)(g.Z,{variant:"subtitle1",sx:{fontWeight:600,mb:2},children:"Observa\xe7\xf5es (campo de uso exclusivo da validadora)"}),(0,t.jsx)(p.Z,{title:"Observa\xe7\xe3o (opcional)",name:"info.obs",multiline:!0,rows:4,value:eC.obs,disabled:!eM.status||K,control:eK})]})})})})})}),ex&&ex.concluded&&(0,t.jsx)(g.Z,{variant:"caption",children:"Conclu\xeddo por ".concat(ex.profissionalAprova.nome," em ").concat(ex.dataFim," ").concat(ex.horaFim,".")}),ec&&(0,t.jsx)(c.Z,{title:"Hist\xf3rico do Formul\xe1rio",text:"Listagem do hist\xf3rico das movimenta\xe7\xf5es do formul\xe1rio ".concat(i," do Fornecedor."),id:i,parFormularioID:1,formStatus:eC.status,hasFormPending:K,canChangeStatus:!K&&2==eo.quemPreenche&&eC.status>=40,openModal:ec,handleClose:()=>eu(!1),btnCancel:!0,btnConfirm:!0,handleSubmit:e3}),(0,t.jsx)(P.Z,{openModal:eF,handleClose(){eS(!1),Q(!1)},title:"Concluir Formul\xe1rio",text:"Deseja realmente concluir este formul\xe1rio?",info:eC,canChange:!K,register:eU,setValue:eQ,getValues:eX,btnCancel:!0,btnConfirm:!0,btnConfirmColor:"primary",conclusionForm:os,listErrors:eP,canApprove:$}),eM.message&&(0,t.jsx)(x.Z,{severity:"warning",children:eM.message}),ej&&(0,t.jsxs)(x.Z,{severity:"info",children:["\xdaltima movimenta\xe7\xe3o: Profissional ".concat(ej.nome," do(a) ").concat(ej.nomeFantasia," movimentou o formul\xe1rio de ").concat(ej.statusAnterior," para ").concat(ej.statusAtual," em ").concat(ej.dataHora,"."),ej.observacao&&(0,t.jsxs)("p",{children:[(0,t.jsx)("br",{}),'Mensagem: "',ej.observacao,'"']})]})]})]})]})};var _=a(60565),J=a(72819);let U=e=>{let{values:o}=e;return(0,t.jsxs)(f.Z,{display:"flex",flexDirection:"column",sx:{gap:4},children:[(0,t.jsxs)(g.Z,{variant:"body2",children:[(0,t.jsx)("strong",{children:"E-mail enviado para: "})," ",null==o?void 0:o.email]}),(0,t.jsxs)(g.Z,{variant:"body2",children:[(0,t.jsx)("strong",{children:"Link do formul\xe1rio: "})," ",null==o?void 0:o.link]})]})},X=()=>{let{user:e,loggedUnity:o}=(0,n.useContext)(Z.V),[a,l]=(0,n.useState)(null),s=(0,b.useRouter)(),d=s.pathname,{setTitle:c}=(0,n.useContext)(_.f),{id:u,setId:p}=(0,n.useContext)(C.X),[m,x]=(0,n.useState)(!1),[f,h]=(0,n.useState)(!1),[v,g]=(0,n.useState)(null),[D,I]=(0,n.useState)(!0),j=()=>{x(!0)},F=async()=>{console.log("\uD83D\uDE80 ~ user.cnpj:",e.cnpj),await r.h.post("".concat(d,"/getList/"),{unidadeID:o.unidadeID,papelID:e.papelID,cnpj:e.cnpj?e.cnpj:null}).then(e=>{l(e.data),c({title:"Fornecedor",subtitle:{id:u,count:e.data.length,new:!1}})})},E=async a=>{try{let t=await r.h.post("/formularios/fornecedor/makeFornecedor",{usuarioID:e.usuarioID,papelID:e.papelID,unidadeID:o.unidadeID,values:a.fields,habilitaQuemPreencheFormFornecedor:a.habilitaQuemPreencheFormFornecedor});200==t.status&&(w.ZP.success(t.data.message),D?(h(!0),g(t.data.result)):p(t.data.fornecedorID))}catch(n){console.error(n),console.error("Erro ao enviar email",n)}},P=()=>{let e=null==v?void 0:v.link;e&&(navigator.clipboard.writeText(e),w.ZP.success("Link copiado com sucesso!"))};(0,n.useEffect)(()=>{F()},[u]),(0,n.useEffect)(()=>{s.query.f&&p(s.query.f)},[s.query]);let A=1==e.papelID?[{headerName:"ID",field:"id",size:1},{headerName:"Fornecedor",field:"fornecedor",size:1},{headerName:"CNPJ",field:"cnpj",size:1},{headerName:"Data da Avalia\xe7\xe3o",field:"data",size:1,type:"date"},{headerName:"Cidade",field:"cidade",size:1},{headerName:"Quem preenche",field:"quemPreenche",size:1},{headerName:"Status",field:{name:"status",cor:"cor"},size:1}]:2==e.papelID?[{headerName:"ID",field:"id",size:1},{headerName:"F\xe1brica",field:"fabrica",size:1},{headerName:"CNPJ",field:"cnpj",size:1},{headerName:"Data da Avalia\xe7\xe3o",field:"data",size:1,type:"date"},{headerName:"Cidade",field:"cidade",size:1},{headerName:"Respons\xe1vel",field:"responsavel",size:1},{headerName:"Status",field:{name:"status",cor:"cor"},size:1}]:[],N=(0,y.OL)(d,A);return(0,t.jsxs)(t.Fragment,{children:[a?u&&u>0?(0,t.jsx)(q,{id:u,makeFornecedor:E}):(0,t.jsx)(i.Z,{result:a,columns:N,openModal:1==e.papelID?j:null,btnNew:1==e.papelID}):(0,t.jsx)(S.Z,{show:!0}),(0,t.jsx)(J.Z,{title:"Habilitar Fornecedor",description:"Habilitar novo preenchimento de formul\xe1rio pro fornecedor",handleConclusion:E,setOpenModal:x,openModal:m,size:"lg",children:(0,t.jsx)(R.Z,{isNotFactory:D,setIsNotFactory:I})}),(0,t.jsx)(J.Z,{title:"Formul\xe1rio enviado ao fornecedor",description:"Um novo formul\xe1rio de qualifica\xe7\xe3o de fornecedor foi enviado",handleCopyLink:P,setOpenModal:h,openModal:f,children:(0,t.jsx)(U,{values:v})})]})};var Q=X}},function(e){e.O(0,[9241,1515,7842,9525,8934,5815,9152,9774,2888,179],function(){return e(e.s=59424)}),_N_E=e.O()}]);