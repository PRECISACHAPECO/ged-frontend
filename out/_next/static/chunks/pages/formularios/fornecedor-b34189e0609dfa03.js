(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7463],{59424:function(e,a,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/formularios/fornecedor",function(){return o(44351)}])},93250:function(e,a,o){"use strict";var t=o(85893),n=o(49837),l=o(91359),r=o(95722);let i=e=>{let{result:a,columns:o,btnNew:i=!0,btnPrint:s=!0,btnBack:d,openModal:c}=e;return(0,t.jsx)(n.Z,{children:(0,t.jsx)(l.Z,{sx:{pt:"0"},children:(0,t.jsx)(r.Z,{rows:a,columns:o,buttonsHeader:{btnNew:i,btnPrint:s,btnBack:d,openModal:c}})})})};a.Z=i},44351:function(e,a,o){"use strict";o.r(a),o.d(a,{default:function(){return eE}});var t=o(85893),n=o(67294),l=o(60664),r=o(93250),i=o(87536),s=o(56531),d=o(99734),c=o(34282),u=o(29308),p=o(66136),m=o(79072),x=o(72389),h=o(80562),v=o(21609),f=o(10179),g=o(42107),j=o(73731),D=o(53934);let b=e=>{var a;let{key:o,item:n,handleFileClick:l,indexGrupo:r,indexItem:i,selectedItem:s,handleFileSelect:d,handleRemove:c,loadingFile:u,folder:p,error:b,disabled:Z,modeTheme:I,inputRef:y}=e;return console.log("\uD83D\uDE80 ~ AnexoGrid item:",n),(0,t.jsx)(m.ZP,{item:!0,xs:12,md:3,children:(0,t.jsxs)("div",{className:"".concat((null==b?void 0:b[o])?"border border-red-500":"dark"===I?"bg-[#202023]":"bg-[#F6F6F8]"," rounded-lg flex flex-col relative z-10"),children:[(0,t.jsx)("div",{className:"flex items-center justify-center p-2 mt-1 ",children:(0,t.jsx)("p",{className:"font-medium text-sm ",children:n.nome})}),(0,t.jsx)("div",{className:"flex justify-center items-center cursor-pointer p-1 h-[100px] w-full ",disabled:Z,onClick(){n.anexo&&n.anexo.path&&n.anexo.exist?window.open(n.anexo.path,"_blank"):Z||l(n)},children:(0,t.jsxs)("div",{className:"flex p-1 justify-center items-center gap-2 rounded-lg w-full h-full m-3 border-2 border-dashed hover:border-[#4A8B57] transition-colors ".concat("dark"===I?" border-[#27272a]":"rgba(76, 78, 100, 0.12)"),children:[s&&s.grupoAnexoItemID==n.grupoAnexoItemID&&(0,t.jsx)(j.Z,{show:u,title:"Enviando anexo..."}),(0,t.jsx)("div",{className:"flex items-center gap-3",children:n.anexo&&n.anexo.exist?(0,t.jsx)("div",{children:(0,t.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[(0,t.jsx)(g.Z,{data:n.anexo}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsxs)("p",{className:"text-sm opacity-80",children:[n.anexo.nome,(0,t.jsx)("span",{className:"text-xs opacity-50 ml-1",children:"(".concat((n.anexo.size/1024/1024).toFixed(2),"MB)")})]}),n.descricao&&(0,t.jsx)(D.Z,{text:n.descricao})]}),(0,t.jsx)("p",{className:"text-xs opacity-50",children:new Date(n.anexo.time).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})})]})}):(0,t.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[(0,t.jsx)(f.Z,{className:"w-8 h-8 ".concat(n.anexo&&n.anexo.exist?"fill-[#666CFF]":"fill-current")}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("h6",{className:"text-sm font-normal opacity-80",children:"Adicione um arquivo"}),n.descricao&&(0,t.jsx)(D.Z,{text:n.descricao})]})]})})]})}),(0,t.jsx)("div",{className:"flex items-center justify-between gap-1 p-2 py-3 pl-4",children:(0,t.jsx)(x.Z,{title:1==n.hasPending?"Este item n\xe3o pode mais ser removido pois j\xe1 foi respondido em um formul\xe1rio":"Remover este item",children:(0,t.jsx)(h.Z,{color:"error",onClick:()=>c(n),disabled:!(null===(a=n.anexo)||void 0===a?void 0:a.exist)||Z,children:(0,t.jsx)(v.Z,{icon:"tabler:trash-filled"})})})}),(0,t.jsx)("input",{type:"file",ref:y,style:{display:"none"},onChange:e=>d(e,s,p)})]})})};o(88475);var Z=o(92945),I=o(49837),y=o(91359),C=o(29630),A=o(63366),S=o(87462);o(59864);var F=o(86010),w=o(94780),N=o(67074),z=o(78884),E=o(36622),P=o(1588),k=o(34867);function R(e){return(0,k.Z)("MuiToggleButtonGroup",e)}let M=(0,P.Z)("MuiToggleButtonGroup",["root","selected","vertical","disabled","grouped","groupedHorizontal","groupedVertical"]),T=["children","className","color","disabled","exclusive","fullWidth","onChange","orientation","size","value"],O=e=>{let{classes:a,orientation:o,fullWidth:t,disabled:n}=e,l={root:["root","vertical"===o&&"vertical",t&&"fullWidth"],grouped:["grouped",`grouped${(0,E.Z)(o)}`,n&&"disabled"]};return(0,w.Z)(l,R,a)},B=(0,N.ZP)("div",{name:"MuiToggleButtonGroup",slot:"Root",overridesResolver(e,a){let{ownerState:o}=e;return[{[`& .${M.grouped}`]:a.grouped},{[`& .${M.grouped}`]:a[`grouped${(0,E.Z)(o.orientation)}`]},a.root,"vertical"===o.orientation&&a.vertical,o.fullWidth&&a.fullWidth]}})(({ownerState:e,theme:a})=>(0,S.Z)({display:"inline-flex",borderRadius:(a.vars||a).shape.borderRadius},"vertical"===e.orientation&&{flexDirection:"column"},e.fullWidth&&{width:"100%"},{[`& .${M.grouped}`]:(0,S.Z)({},"horizontal"===e.orientation?{"&:not(:first-of-type)":{marginLeft:-1,borderLeft:"1px solid transparent",borderTopLeftRadius:0,borderBottomLeftRadius:0},"&:not(:last-of-type)":{borderTopRightRadius:0,borderBottomRightRadius:0},[`&.${M.selected} + .${M.grouped}.${M.selected}`]:{borderLeft:0,marginLeft:0}}:{"&:not(:first-of-type)":{marginTop:-1,borderTop:"1px solid transparent",borderTopLeftRadius:0,borderTopRightRadius:0},"&:not(:last-of-type)":{borderBottomLeftRadius:0,borderBottomRightRadius:0},[`&.${M.selected} + .${M.grouped}.${M.selected}`]:{borderTop:0,marginTop:0}})})),H=n.forwardRef(function(e,a){let o=(0,z.Z)({props:e,name:"MuiToggleButtonGroup"}),{children:l,className:r,color:i="standard",disabled:s=!1,exclusive:d=!1,fullWidth:c=!1,onChange:u,orientation:p="horizontal",size:m="medium",value:x}=o,h=(0,A.Z)(o,T),v=(0,S.Z)({},o,{disabled:s,fullWidth:c,orientation:p,size:m}),f=O(v),g=(e,a)=>{let o;if(!u)return;let t=x&&x.indexOf(a);x&&t>=0?(o=x.slice()).splice(t,1):o=x?x.concat(a):[a],u(e,o)},j=(e,a)=>{u&&u(e,x===a?null:a)};return(0,t.jsx)(B,(0,S.Z)({role:"group",className:(0,F.Z)(f.root,r),ref:a,ownerState:v},h,{children:n.Children.map(l,e=>{var a;return n.isValidElement(e)?n.cloneElement(e,{className:(0,F.Z)(f.grouped,e.props.className),onChange:d?j:g,selected:void 0===e.props.selected?(a=e.props.value,void 0!==x&&void 0!==a&&(Array.isArray(x)?x.indexOf(a)>=0:a===x)):e.props.selected,size:e.props.size||m,fullWidth:c,color:e.props.color||i,disabled:e.props.disabled||s}):null})}))});var V=o(41796),$=o(50522);function L(e){return(0,k.Z)("MuiToggleButton",e)}let G=(0,P.Z)("MuiToggleButton",["root","disabled","selected","standard","primary","secondary","sizeSmall","sizeMedium","sizeLarge"]),q=["children","className","color","disabled","disableFocusRipple","fullWidth","onChange","onClick","selected","size","value"],_=e=>{let{classes:a,fullWidth:o,selected:t,disabled:n,size:l,color:r}=e,i={root:["root",t&&"selected",n&&"disabled",o&&"fullWidth",`size${(0,E.Z)(l)}`,r]};return(0,w.Z)(i,L,a)},W=(0,N.ZP)($.Z,{name:"MuiToggleButton",slot:"Root",overridesResolver(e,a){let{ownerState:o}=e;return[a.root,a[`size${(0,E.Z)(o.size)}`]]}})(({theme:e,ownerState:a})=>{let o,t="standard"===a.color?e.palette.text.primary:e.palette[a.color].main;return e.vars&&(t="standard"===a.color?e.vars.palette.text.primary:e.vars.palette[a.color].main,o="standard"===a.color?e.vars.palette.text.primaryChannel:e.vars.palette[a.color].mainChannel),(0,S.Z)({},e.typography.button,{borderRadius:(e.vars||e).shape.borderRadius,padding:11,border:`1px solid ${(e.vars||e).palette.divider}`,color:(e.vars||e).palette.action.active},a.fullWidth&&{width:"100%"},{[`&.${G.disabled}`]:{color:(e.vars||e).palette.action.disabled,border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`},"&:hover":{textDecoration:"none",backgroundColor:e.vars?`rgba(${e.vars.palette.text.primaryChannel} / ${e.vars.palette.action.hoverOpacity})`:(0,V.Fq)(e.palette.text.primary,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${G.selected}`]:{color:t,backgroundColor:e.vars?`rgba(${o} / ${e.vars.palette.action.selectedOpacity})`:(0,V.Fq)(t,e.palette.action.selectedOpacity),"&:hover":{backgroundColor:e.vars?`rgba(${o} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:(0,V.Fq)(t,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${o} / ${e.vars.palette.action.selectedOpacity})`:(0,V.Fq)(t,e.palette.action.selectedOpacity)}}}},"small"===a.size&&{padding:7,fontSize:e.typography.pxToRem(13)},"large"===a.size&&{padding:15,fontSize:e.typography.pxToRem(15)})}),J=n.forwardRef(function(e,a){let o=(0,z.Z)({props:e,name:"MuiToggleButton"}),{children:n,className:l,color:r="standard",disabled:i=!1,disableFocusRipple:s=!1,fullWidth:d=!1,onChange:c,onClick:u,selected:p,size:m="medium",value:x}=o,h=(0,A.Z)(o,q),v=(0,S.Z)({},o,{color:r,disabled:i,disableFocusRipple:s,fullWidth:d,size:m}),f=_(v),g=e=>{u&&(u(e,x),e.defaultPrevented)||!c||c(e,x)};return(0,t.jsx)(W,(0,S.Z)({className:(0,F.Z)(f.root,l),disabled:i,focusRipple:!s,ref:a,onClick:g,onChange:c,value:x,ownerState:v,"aria-pressed":p},h,{children:n}))});var U=function(e){return(0,t.jsx)("svg",{fill:"currentColor",viewBox:"0 0 16 16",height:"1em",width:"1em",...e,children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M2.5 12a.5.5 0 01.5-.5h10a.5.5 0 010 1H3a.5.5 0 01-.5-.5zm0-4a.5.5 0 01.5-.5h10a.5.5 0 010 1H3a.5.5 0 01-.5-.5zm0-4a.5.5 0 01.5-.5h10a.5.5 0 010 1H3a.5.5 0 01-.5-.5z"})})},X=function(e){return(0,t.jsx)("svg",{fill:"currentColor",viewBox:"0 0 16 16",height:"1em",width:"1em",...e,children:(0,t.jsx)("path",{d:"M1 2.5A1.5 1.5 0 012.5 1h3A1.5 1.5 0 017 2.5v3A1.5 1.5 0 015.5 7h-3A1.5 1.5 0 011 5.5v-3zM2.5 2a.5.5 0 00-.5.5v3a.5.5 0 00.5.5h3a.5.5 0 00.5-.5v-3a.5.5 0 00-.5-.5h-3zm6.5.5A1.5 1.5 0 0110.5 1h3A1.5 1.5 0 0115 2.5v3A1.5 1.5 0 0113.5 7h-3A1.5 1.5 0 019 5.5v-3zm1.5-.5a.5.5 0 00-.5.5v3a.5.5 0 00.5.5h3a.5.5 0 00.5-.5v-3a.5.5 0 00-.5-.5h-3zM1 10.5A1.5 1.5 0 012.5 9h3A1.5 1.5 0 017 10.5v3A1.5 1.5 0 015.5 15h-3A1.5 1.5 0 011 13.5v-3zm1.5-.5a.5.5 0 00-.5.5v3a.5.5 0 00.5.5h3a.5.5 0 00.5-.5v-3a.5.5 0 00-.5-.5h-3zm6.5.5A1.5 1.5 0 0110.5 9h3a1.5 1.5 0 011.5 1.5v3a1.5 1.5 0 01-1.5 1.5h-3A1.5 1.5 0 019 13.5v-3zm1.5-.5a.5.5 0 00-.5.5v3a.5.5 0 00.5.5h3a.5.5 0 00.5-.5v-3a.5.5 0 00-.5-.5h-3z"})})};let K=e=>{let{values:a}=e,[o,l]=(0,n.useState)(null);console.log("\uD83D\uDE80 ~ selectedItem:",o);let{settings:r}=(0,n.useContext)(p.J6),i=r.mode,s=(0,n.useRef)(null),d=e=>{s.current.click(),l(e)};(0,n.useEffect)(()=>{s.current.value=""},[a.handleFileSelect]);let[c,u]=(0,n.useState)("list"),x=(e,a)=>{u(a)};return(0,t.jsx)(I.Z,{sx:{mt:4},children:(0,t.jsxs)(y.Z,{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,t.jsxs)(C.Z,{variant:"subtitle1",sx:{fontWeight:600},children:[a.grupo.nome,(0,t.jsx)(C.Z,{variant:"body2",sx:{mb:2},children:a.grupo.descricao})]}),(0,t.jsx)("div",{children:(0,t.jsxs)(H,{exclusive:!0,color:"primary",value:c,onChange:x,children:[(0,t.jsx)(J,{value:"list",children:(0,t.jsx)(U,{})}),(0,t.jsx)(J,{value:"grid",children:(0,t.jsx)(X,{})})]})})]}),(0,t.jsx)(m.ZP,{container:!0,spacing:4,children:a.grupo.itens.map((e,n)=>"list"===c?(0,t.jsx)(Z.Z,{modeTheme:i,handleFileClick:d,selectedItem:o,inputRef:s,item:e,loadingFile:a.loadingFile,grupo:a.grupo,indexBlock:a.indexGrupo,indexItem:n,handleFileSelect:a.handleFileSelect,handleRemove:a.handleRemove,folder:a.folder,error:a.error,disabled:a.disabled},"".concat(a.indexGrupo,"-").concat(n)):(0,t.jsx)(b,{modeTheme:i,handleFileClick:d,selectedItem:o,inputRef:s,item:e,loadingFile:a.loadingFile,grupo:a.grupo,indexGrupo:a.indexGrupo,indexItem:n,handleFileSelect:a.handleFileSelect,handleRemove:a.handleRemove,folder:a.folder,error:a.error,disabled:a.disabled},"".concat(a.indexGrupo,"-").concat(n)))})]})})};var Q=o(61953),Y=o(19604),ee=o(55343),ea=o(11163),eo=o.n(ea),et=o(46749),en=o(86887),el=o(83830),er=o(40039),ei=o(39976),es=o(47842),ed=o(86501),ec=o(80377),eu=o(22416),ep=o(22841),em=o(16056);let ex=e=>{let{xs:a,md:o,title:n,index:l,name:r,typePage:i,value:s,disabled:d,register:c,...u}=e;return(0,t.jsx)(m.ZP,{item:!0,xs:a,md:o,children:(0,t.jsx)(Q.Z,{display:"flex",flexDirection:"column",alignItems:"start",children:(0,t.jsx)(ep.Z,{control:(0,t.jsx)(em.Z,{...u,name:r,...c(r),defaultChecked:s,disabled:d,onChange(e){u.onChange&&u.onChange(e.target.checked,l,r,i)}}),label:n,size:"small",sx:{"&:hover":{"& .MuiFormControlLabel-label":{color:"primary.main"}}}})})})},eh=e=>{let{data:a,control:o,setValue:l,register:r,errors:i}=e,[s,d]=(0,n.useState)(!0);return l("emailDestinatario",a.email),(0,t.jsxs)("div",{className:"flex flex-col gap-2 pt-2",children:[s&&(0,t.jsx)(u.Z,{name:"emailDestinatario",type:"email",title:"E-mail do destinat\xe1rio",required:!0,control:o,errors:i.emailDestinatario}),(0,t.jsx)(u.Z,{name:"assunto",title:"Assunto",required:!0,register:r,control:o,defaultValue:"",errors:i.assunto}),(0,t.jsx)(u.Z,{name:"descricao",title:"Descri\xe7\xe3o",multiline:!0,rows:4,required:!0,control:o,defaultValue:"",errors:i.descricao}),(0,t.jsxs)(eu.Z,{row:!0,children:[(0,t.jsx)(ex,{name:"email",title:"E-mail",value:!0,register:r,onChange:()=>d(!s)}),(0,t.jsx)(ex,{name:"alerta",title:"Alerta",value:!0,register:r})]})]})};var ev=o(44642),ef=o(82747),eg=o(84220);let ej=e=>{var a,o,r,i,s,d,c,p,m;let{fields:x,setFields:h,handleCnpj:v,validCnpj:f,getValues:g,control:j,errors:D,setValue:b,register:Z,reset:I}=e,{loggedUnity:y}=(0,n.useContext)(er.V),[A,S]=(0,n.useState)([]),[F,w]=(0,n.useState)([]),[N,z]=(0,n.useState)([]),E=async()=>{let e=await l.h.post("/formularios/fornecedor/getModels",{unidadeID:y.unidadeID});S(e.data)},P=async()=>{let e=await l.h.post("/formularios/fornecedor/getProducts",{unidadeID:y.unidadeID});w(e.data)},k=async()=>{let e=await l.h.post("/formularios/fornecedor/getGruposAnexo",{unidadeID:y.unidadeID});z(e.data)},R=()=>{h(null),b("fields.cnpj",""),b("fields.razaoSocial",""),b("fields.email",""),b("fields.modelo",null),b("fields.gruposAnexo",[]),b("fields.produtos",[])};return(0,n.useEffect)(()=>{I(),E(),P(),k()},[]),A&&F&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(Q.Z,{children:[(0,t.jsx)(u.Z,{xs:12,md:12,title:"CNPJ",name:"fields.cnpj",value:null==x?void 0:x.cnpj,onChange:v,clearField:g("fields.cnpj")?R:null,mask:"cnpj",required:!0,control:j,errors:null==D?void 0:null===(a=D.fields)||void 0===a?void 0:a.cnpj}),!1==f&&(0,t.jsx)(C.Z,{variant:"body2",color:"error",children:"CNPJ inv\xe1lido!"})]}),(0,t.jsx)(u.Z,{xs:12,md:12,title:"Raz\xe3o Social",name:"fields.razaoSocial",value:null==x?void 0:x.razaoSocial,disabled:!f,required:!0,control:j,errors:null==D?void 0:null===(o=D.fields)||void 0===o?void 0:o.razaoSocial}),(0,t.jsx)(u.Z,{xs:12,md:12,title:"Nome Fantasia",name:"fields.nomeFantasia",value:null==x?void 0:x.nomeFantasia,disabled:!f,required:!0,control:j,errors:null==D?void 0:null===(r=D.fields)||void 0===r?void 0:r.nomeFantasia}),(0,t.jsx)(u.Z,{xs:12,md:12,type:"email",title:"E-mail",name:"fields.email",value:null==x?void 0:x.email,disabled:!f,required:!0,control:j,errors:null==D?void 0:null===(i=D.fields)||void 0===i?void 0:i.email}),(0,t.jsx)(eg.Z,{xs:12,md:12,title:"Modelo de Formul\xe1rio",name:"fields.modelo",options:A,required:!0,value:null==x?void 0:x.modelo,disabled:!f,register:Z,setValue:b,control:j,errors:null==D?void 0:null===(s=D.fields)||void 0===s?void 0:s.modelo}),(0,t.jsx)(eg.Z,{xs:12,md:12,title:"Grupos de Anexo",multiple:!0,name:"fields.gruposAnexo",value:null!==(p=null==x?void 0:x.gruposAnexo)&&void 0!==p?p:[],disabled:!f,options:null!=N?N:[],register:Z,setValue:b,control:j,errors:null==D?void 0:null===(d=D.fields)||void 0===d?void 0:d.gruposAnexo}),(0,t.jsx)(eg.Z,{xs:12,md:12,title:"Produtos",name:"fields.produtos",value:null!==(m=null==x?void 0:x.produtos)&&void 0!==m?m:[],disabled:!f,multiple:!0,required:!0,options:null!=F?F:[],register:Z,setValue:b,control:j,errors:null==D?void 0:null===(c=D.fields)||void 0===c?void 0:c.produtos})]})};var eD=o(34175);let eb=e=>{var a,o,r,i,s,d;let{cnpj:c,control:u,setValue:p,register:x,errors:h,reset:v,getValues:f}=e,[g,j]=(0,n.useState)(!1),{loggedUnity:D}=(0,n.useContext)(er.V),[b,Z]=(0,n.useState)(null),[A,S]=(0,n.useState)(null),F=e=>{18==e.length?(0,ef.zk)(e)?(S(!0),w(e)):S(!1):(S(null),Z(null))},w=async e=>{try{let a=await l.h.post("/formularios/fornecedor/cnpj",{unidadeID:D.unidadeID,cnpj:e}),o={new:a.data.new,fornecedorID:a.data.fornecedorID,data:a.data.dataAvaliacao,modelo:a.data.modelo.nome,produtos:a.data.produtos,gruposAnexo:a.data.gruposAnexo},t="";o.new&&(t=await N(e)),Z({...b,cnpj:o.new?(0,eD.PK)(t.data.CNPJ):e,status:o.new?t.data.STATUS:"",dataAbertura:o.new?t.data["DATA ABERTURA"]:"",telefone:o.new?t.data.DDD+" "+t.data.TELEFONE:"",razaoSocial:o.new?t.data["RAZAO SOCIAL"]:a.data.fields.razaoSocial,nomeFantasia:o.new?t.data["NOME FANTASIA"]:a.data.fields.nomeFantasia,email:o.new?t.data.EMAIL:a.data.fields.email,cidade:o.new?t.data.MUNICIPIO+"/"+t.data.UF:"",preenchimento:o}),p("fields.cnpj",e),p("fields.razaoSocial",o.new?t.data["RAZAO SOCIAL"]:a.data.fields.razaoSocial),p("fields.nomeFantasia",o.new?t.data["NOME FANTASIA"]:a.data.fields.nomeFantasia),p("fields.nome",o.new?t.data["NOME FANTASIA"]:""),p("fields.email",o.new?t.data.EMAIL:a.data.fields.email),p("fields.modelo",a.data.modelo.id>0?a.data.modelo:null),p("fields.gruposAnexo",a.data.gruposAnexo),p("fields.produtos",a.data.produtos)}catch(n){console.error(n)}},N=async e=>{let a=e.replace(/\D/g,""),o=await l.h.get("https://api-publica.speedio.com.br/buscarcnpj?cnpj=".concat(a));return o};return(0,n.useEffect)(()=>{j(!g),c&&c.length>0&&F(c)},[]),(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(ev.Z,{children:(0,t.jsxs)(m.ZP,{container:!0,spacing:4,children:[(0,t.jsx)(m.ZP,{item:!0,xs:12,md:6,children:(0,t.jsx)(Q.Z,{display:"flex",flexDirection:"column",sx:{gap:4},children:(0,t.jsx)(ej,{setFields:Z,fields:null!=b?b:null,control:u,errors:h,reset:v,setValue:p,getValues:f,register:x,handleCnpj:F,validCnpj:A},g)})}),(0,t.jsxs)(m.ZP,{item:!0,xs:12,md:6,children:[(0,t.jsx)(I.Z,{children:(0,t.jsx)(y.Z,{children:(0,t.jsxs)(Q.Z,{display:"flex",flexDirection:"column",sx:{gap:4},children:[(0,t.jsx)(C.Z,{variant:"body2",children:(0,t.jsx)("strong",{children:"Dados consultados da Receita Federal"})}),(0,t.jsxs)(C.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Raz\xe3o Social:"})," ",null==b?void 0:b.razaoSocial]}),(0,t.jsxs)(C.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Nome Fantasia:"})," ",null==b?void 0:b.nomeFantasia]}),(0,t.jsxs)(C.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"CNPJ:"})," ",null==b?void 0:b.cnpj]}),(0,t.jsxs)(C.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Status:"})," ",null==b?void 0:b.status]}),(0,t.jsxs)(C.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Data Abertura:"})," ",null==b?void 0:b.dataAbertura]}),(0,t.jsxs)(C.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Telefone:"})," ",null==b?void 0:b.telefone]}),(0,t.jsxs)(C.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"E-mail:"})," ",null==b?void 0:b.email]}),(0,t.jsxs)(C.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Cidade:"})," ",null==b?void 0:b.cidade]})]})})}),(0,t.jsx)(I.Z,{sx:{mt:4},children:(0,t.jsx)(y.Z,{children:(0,t.jsxs)(Q.Z,{display:"flex",flexDirection:"column",sx:{gap:4},children:[(0,t.jsx)(C.Z,{variant:"body2",children:(0,t.jsx)("strong",{children:"Dados do \xfaltimo formul\xe1rio deste fornecedor"})}),(null==b?void 0:null===(a=b.preenchimento)||void 0===a?void 0:a.new)?(0,t.jsx)(C.Z,{variant:"body2",color:"primary",children:(0,t.jsx)("strong",{children:"Novo fornecedor"})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(C.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"ID: "})," ",null==b?void 0:null===(o=b.preenchimento)||void 0===o?void 0:o.fornecedorID]}),(0,t.jsxs)(C.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Data de preenchimento:"})," ",null==b?void 0:null===(r=b.preenchimento)||void 0===r?void 0:r.data]}),(0,t.jsxs)(C.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Modelo:"})," ",null==b?void 0:null===(i=b.preenchimento)||void 0===i?void 0:i.modelo]}),(0,t.jsxs)(C.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Grupos de anexo: "}),null==b?void 0:null===(s=b.preenchimento)||void 0===s?void 0:s.gruposAnexo.map((e,a)=>{var o;return"".concat(e.nome).concat(a<(null==b?void 0:null===(o=b.preenchimento)||void 0===o?void 0:o.gruposAnexo.length)-1?", ":"")})]}),(0,t.jsxs)(C.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Produtos: "}),null==b?void 0:null===(d=b.preenchimento)||void 0===d?void 0:d.produtos.map((e,a)=>{var o;return"".concat(e.nome).concat(a<(null==b?void 0:null===(o=b.preenchimento)||void 0===o?void 0:o.produtos.length)-1?", ":"")})]})]})]})})})]})]})})})};var eZ=o(44373);let eI=e=>{let{values:a,handleFileSelect:o,handleRemove:l,loadingFile:r,disabled:i,errors:s}=e,{settings:d}=(0,n.useContext)(p.J6),c=d.mode,[u,x]=(0,n.useState)(null),h=(0,n.useRef)(null),v=e=>{h.current.click(),x(e)};return(0,n.useEffect)(()=>{h.current&&(h.current.value="")},[o]),(0,t.jsx)("div",{className:"flex flex-col gap-2",children:a&&a.map((e,n)=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.ZP,{container:!0,spacing:2,children:(0,t.jsx)(m.ZP,{item:!0,xs:12,sm:6,children:(0,t.jsxs)(Q.Z,{display:"flex",alignItems:"center",sx:{gap:1},children:[(0,t.jsx)(C.Z,{color:"primary",variant:"subtitle1",sx:{fontWeight:700},children:e.nome}),(0,t.jsx)(C.Z,{variant:"body2",children:"(".concat(e.unidadeMedida,")")})]})})},n),e.produtoAnexosDescricao&&e.produtoAnexosDescricao.length>0&&(0,t.jsx)(m.ZP,{container:!0,spacing:4,children:e.produtoAnexosDescricao.map((e,a)=>(0,t.jsx)(Z.Z,{modeTheme:c,handleFileClick:v,selectedItem:u,inputRef:h,item:e,loadingFile:r,indexBlock:n,indexItem:a,handleFileSelect:o,folder:"produto",handleRemove:l,error:s,disabled:i},"".concat(n,"-").concat(a)))}),e.anexos&&0===e.anexos.length&&(0,t.jsx)(C.Z,{variant:"body2",sx:{mb:2},children:"Este produto n\xe3o exige anexos"}),n<a.length-1&&(0,t.jsx)(eZ.Z,{sx:{my:4}})]}))})};var ey=o(50287);let eC=e=>{var a,o,r,i,d,c;let{modeloID:p,values:x,fields:h,disabled:v,register:f,errors:g,setValue:j,control:D,getAddressByCep:b}=e,[Z,I]=(0,n.useState)({}),[y,C]=(0,n.useState)([]),A=(e,a,o,t)=>{let n=new Date(o),l=(0,et.HD)(e,n,t);I(e=>({...e,[a]:l}))},S=async()=>{let e=await l.h.post("/cadastros/profissional/getProfissionaisAssinatura",{formularioID:1,modeloID:p});C(e.data.preenche)};return(0,n.useEffect)(()=>{S()},[]),(0,t.jsxs)(m.ZP,{container:!0,spacing:4,children:[(0,t.jsx)(ey.Z,{xs:12,md:2,title:"Data da avalia\xe7\xe3o",name:"fieldsHeader.dataAvaliacao",type:"date",value:null==x?void 0:x.dataAvaliacao,disabled:v,register:f,control:D,setDateFormat:A,typeValidation:"dataPassado",daysValidation:365,dateStatus:Z,errors:null==g?void 0:null===(a=g.fieldsHeader)||void 0===a?void 0:a.dataAvaliacao}),(0,t.jsx)(u.Z,{xs:12,md:2,title:"Hora da avalia\xe7\xe3o",name:"fieldsHeader.horaAvaliacao",type:"time",disabled:v,register:f,control:D,errors:null==g?void 0:null===(o=g.fieldsHeader)||void 0===o?void 0:o.horaAvaliacao}),(0,t.jsx)(eg.Z,{xs:12,md:4,title:"Profissional preenchimento",name:"fieldsHeader.profissionalPreenche",type:"string",options:y,value:null==x?void 0:x.profissionalPreenche,disabled:v,register:f,setValue:j,control:D,errors:null==g?void 0:null===(r=g.fieldsHeader)||void 0===r?void 0:r.profissionalPreenche}),(0,t.jsx)(u.Z,{xs:12,md:4,title:"CNPJ",name:"fieldsHeader.cnpj",type:"string",mask:"cnpj",disabled:v,register:f,control:D,errors:null==g?void 0:null===(i=g.fieldsHeader)||void 0===i?void 0:i.cnpj}),(0,t.jsx)(u.Z,{xs:12,md:4,title:"Raz\xe3o Social",name:"fieldsHeader.razaoSocial",type:"string",disabled:v,register:f,control:D,errors:null==g?void 0:null===(d=g.fieldsHeader)||void 0===d?void 0:d.razaoSocial}),(0,t.jsx)(u.Z,{xs:12,md:4,title:"Nome Fantasia",name:"fieldsHeader.nomeFantasia",type:"string",disabled:v,register:f,control:D,errors:null==g?void 0:null===(c=g.fieldsHeader)||void 0===c?void 0:c.nomeFantasia}),(0,t.jsx)(s.Z,{register:f,errors:g,setValue:j,control:D,fields:h,values:h,getAddressByCep:b,disabled:v})]})},eA=e=>{var a,o,r;let{modeloID:i,values:s,fields:d,disabled:c,register:p,errors:x,setValue:h,control:v}=e,[f,g]=(0,n.useState)({}),[j,D]=(0,n.useState)([]),b=(e,a,o,t)=>{let n=new Date(o),l=(0,et.HD)(e,n,t);g(e=>({...e,[a]:l}))},Z=async()=>{let e=await l.h.post("/cadastros/profissional/getProfissionaisAssinatura",{formularioID:1,modeloID:i});D(e.data.aprova)};return(0,n.useEffect)(()=>{Z()},[]),(0,t.jsx)(I.Z,{children:(0,t.jsx)(y.Z,{children:(0,t.jsxs)(m.ZP,{container:!0,spacing:4,children:[(0,t.jsx)(ey.Z,{xs:12,md:2,title:"Data da avalia\xe7\xe3o",name:"fieldsFooter.dataAvaliacao",type:"date",value:null==s?void 0:s.dataAvaliacao,disabled:c,register:p,control:v,setDateFormat:b,typeValidation:"dataPassado",daysValidation:365,dateStatus:f,errors:null==x?void 0:null===(a=x.fieldsFooter)||void 0===a?void 0:a.dataAvaliacao}),(0,t.jsx)(u.Z,{xs:12,md:2,title:"Hora da avalia\xe7\xe3o",name:"fieldsFooter.horaAvaliacao",type:"time",disabled:c,register:p,control:v,errors:null==x?void 0:null===(o=x.fieldsFooter)||void 0===o?void 0:o.horaAvaliacao}),(0,t.jsx)(eg.Z,{xs:12,md:8,title:"Profissional que aprova",name:"fieldsFooter.profissionalAprova",type:"string",options:j,value:null==s?void 0:s.profissionalAprova,disabled:c,register:p,setValue:h,control:v,errors:null==x?void 0:null===(r=x.fieldsFooter)||void 0===r?void 0:r.profissionalAprova})]})})})},eS=e=>{var a,o;let r;let{id:s,makeFornecedor:x}=e,{menu:h,user:v,loggedUnity:f}=(0,n.useContext)(er.V),[g,j]=(0,n.useState)(!1),[D,b]=(0,n.useState)(!1),[Z,A]=(0,n.useState)(!1),[S,F]=(0,n.useState)(!1),[w,N]=(0,n.useState)(!1),[z,E]=(0,n.useState)(!1),[P,k]=(0,n.useState)(!0),[R,M]=(0,n.useState)(!0),[T,O]=(0,n.useState)(null),[B,H]=(0,n.useState)([]),[V,$]=(0,n.useState)([]),[L,G]=(0,n.useState)(null),{createNewNotification:q}=(0,n.useContext)(ei.u),[_,W]=(0,n.useState)(!1),[J,U]=(0,n.useState)([]),[X,ea]=(0,n.useState)([]),[eu,ep]=(0,n.useState)([]),[em,ex]=(0,n.useState)(null),[ev,ef]=(0,n.useState)([]),[eg,ej]=(0,n.useState)(null),[eD,eZ]=(0,n.useState)(""),[ey,eS]=(0,n.useState)(!1),[eF,ew]=(0,n.useState)(!1),[eN,ez]=(0,n.useState)({status:!1,errors:[]}),{settings:eE}=(0,n.useContext)(p.J6),{setId:eP}=(0,n.useContext)(el.X),[ek,eR]=(0,n.useState)({status:!1,message:"Voc\xea n\xe3o tem permiss\xf5es",messageType:"info"}),eM=eo(),eT=s&&s>0?"edit":"new",eO=eM.pathname;console.log("\uD83D\uDE80 ~ staticUrl:",eO);let{reset:eB,register:eH,getValues:eV,setValue:e$,control:eL,watch:eG,handleSubmit:eq,clearErrors:e_,setError:eW,formState:{errors:eJ}}=(0,i.cI)();console.log("formFornecedor errors: ",eJ);let eU=async(e,a)=>{let o={status:e,observacao:a,auth:{usuarioID:v.usuarioID,papelID:v.papelID,unidadeID:f.unidadeID}};try{N(!0),await l.h.post("".concat(eO,"/changeFormStatus/").concat(s),o).then(a=>{ed.ZP.success(et.OD.successUpdate),N(!1),aa(e,null,null)})}catch(t){console.log(t)}},eX=async e=>{try{if(!e.email&&!e.alerta)return ed.ZP.error("Selecione ao menos um tipo de notifica\xe7\xe3o!");let a={titulo:e.assunto,descricao:e.descricao,url:"/formularios/fornecedor/",urlID:s,tipoNotificacaoID:3,usuarioGeradorID:v.usuarioID,usuarioID:0,unidadeID:T.fornecedor.unidadeID,papelID:2,email:e.email,alerta:e.alerta};if(console.log("\uD83D\uDE80 ~ data dat notifica\xe7\xe3o:",a),q(a),e.email){let o={values:e,auth:{id:s,usuarioID:v.usuarioID,papelID:v.papelID,unidadeID:f.unidadeID}};await l.h.post("".concat(eO,"/sendNotification"),o)}let t=e.alerta&&e.email?"E-mail e alerta enviados com sucesso!":e.alerta&&!e.email?"Alerta criado com sucesso!":!e.alerta&&e.email?"E-mail enviado com sucesso!":null;ed.ZP.success(t)}catch(n){console.log(n)}},eK=()=>{navigator.clipboard.writeText(em),ed.ZP.success("Link copiado com sucesso!")},eQ=()=>{eP(T.parFornecedorModeloID),eM.push("/configuracoes/formularios/fornecedor/")},eY={id:1,name:"Gerar novo formul\xe1rio",description:"Gerar um novo formul\xe1rio de preenchimento para este fornecedor.",component:(0,t.jsx)(eb,{cnpj:null==T?void 0:null===(a=T.fornecedor)||void 0===a?void 0:a.cnpj}),route:null,type:null,modal:!0,action:x,size:"lg",icon:"fluent:form-new-20-regular",identification:null},e0={id:2,name:"Gerar notifica\xe7\xe3o",description:"Gerar uma nova notifica\xe7\xe3o para o fornecedor, podendo ser um e-mail e/ou alerta do sistema.",component:(0,t.jsx)(eh,{data:{email:null===(o=eu.find(e=>"email"==e.nomeColuna))||void 0===o?void 0:o.email}}),route:null,type:null,modal:!0,action:eX,icon:"cil:bell",identification:null},e1={id:3,name:"Copiar link do formul\xe1rio",description:"Copiar o link deste formul\xe1rio.",component:(0,t.jsx)(eb,{}),route:null,type:null,action:eK,modal:!1,icon:"solar:copy-outline",identification:null},e5={id:4,name:"Formul\xe1rio do fornecedor",type:"report",papelID:v.papelID,fornecedorID:s,unidadeID:f.unidadeID,icon:"fluent:print-24-regular"},e2=[];1==v.papelID&&e2.push(eY),e2.push(e0),e2.push(e1),e2.push(e5),1==v.papelID&&(r=!1,h.map(e=>{e.menu.map(e=>{e.submenu&&e.submenu.length>0&&e.submenu.map(e=>{"/configuracoes/formularios"==e.rota&&(r=!0)})})}),r)&&e2.push({id:5,name:"Configura\xe7\xf5es do formul\xe1rio",description:"Alterar as configura\xe7\xf5es do modelo de formul\xe1rio.",route:null,type:null,action:eQ,modal:!1,icon:"bi:gear",identification:null});let e3=async()=>{try{await l.h.post("".concat(eO,"/verifyFormPending/").concat(s),{parFormularioID:1}).then(e=>{k(e.data) //! true/false
})}catch(e){console.log(e)}},e4=()=>{j(!0);try{l.h.post("".concat(eO,"/getData/").concat(s),{type:eT,unidadeID:f.unidadeID}).then(e=>{var a,o;console.log("getData: ",e.data),j(!1),U(e.data.fieldsHeader),ea(e.data.fieldsFooter),ep(e.data.fields),H(e.data.produtos),ef(e.data.blocos),$(e.data.grupoAnexo),eZ(e.data.info),O(e.data.unidade),ex(e.data.link),ej(e.data.ultimaMovimentacao),e9(e.data.blocos),eB(e.data);let t=et.WR[null==e?void 0:null===(a=e.data)||void 0===a?void 0:null===(o=a.info)||void 0===o?void 0:o.status];G(t),eR({status:2==v.papelID&&e.data.info.status<40,message:2==v.papelID&&e.data.info.status>=40?"Esse formul\xe1rio j\xe1 foi conclu\xeddo e enviado pra f\xe1brica, n\xe3o \xe9 mais poss\xedvel alterar as informa\xe7\xf5es!":1==v.papelID&&e.data.info.status<40?"Somente o fornecedor pode alterar as informa\xe7\xf5es deste formul\xe1rio!":1==v.papelID&&40==e.data.info.status?"Este formul\xe1rio est\xe1 aguardando aprova\xe7\xe3o":null,messageType:2==v.papelID?"warning":"info"}),e3()}).catch(e=>{console.log("\uD83D\uDE80 ~ error:",e),j(!1)})}catch(e){console.log("\uD83D\uDE80 ~ error:",e),j(!1)}},e8=()=>{e_();let e=!1,a=[];null==eu||eu.forEach((o,t)=>{let n=o.tabela?"fields[".concat(t,"].").concat(o.tabela):"fields[".concat(t,"].").concat(o.nomeColuna),l=eV(n);1!==o.obrigatorio||l||(eW(n,{type:"manual",message:"Campo obrigat\xf3rio"}),a.push(null==o?void 0:o.nomeCampo),e=!0)}),B&&B.length>0&&B.forEach((o,t)=>{o.produtoAnexosDescricao.forEach((n,l)=>{1===n.obrigatorio&&0==n.anexos.length&&(eW("produtos[".concat(t,"].produtoAnexosDescricao[").concat(l,"].anexos"),{type:"manual",message:"Campo obrigat\xf3rio"}),a.push("Anexo: ".concat(null==o?void 0:o.nome," / ").concat(null==n?void 0:n.nome)),e=!0)})}),ev.forEach((o,t)=>{o.itens.forEach((o,n)=>{console.log("\uD83D\uDE80 ~ checkErrors -> item: ",o);let l=eV("blocos[".concat(t,"].itens[").concat(n,"].resposta"));(null==o?void 0:o.obrigatorio)!==1||l||(eW("blocos[".concat(t,"].itens[").concat(n,"].resposta"),{type:"manual",message:"Campo obrigat\xe1rio"}),a.push(null==o?void 0:o.nome),e=!0),o.respostaConfig&&1==o.respostaConfig.anexo&&o.respostaConfig.anexosSolicitados.length>0&&o.respostaConfig.anexosSolicitados.forEach((l,r)=>{1==l.obrigatorio&&l.anexos&&0==l.anexos.length&&(eW("blocos[".concat(t,"].itens[").concat(n,"].respostaConfig.anexosSolicitados[").concat(r,"].anexos"),{type:"manual",message:"Campo obrigat\xe1rio"}),a.push("Anexo: ".concat(null==o?void 0:o.nome," / ").concat(null==l?void 0:l.nome)),e=!0)})})}),V&&V.length>0&&V.forEach((o,t)=>{o.itens.forEach((n,l)=>{1===n.obrigatorio&&0==n.anexos.length&&(console.log("gera erro grupo"),eW("grupoAnexo[".concat(t,"].itens[").concat(l,"].anexos"),{type:"manual",message:"Campo obrigat\xe1rio"}),a.push("Anexo: ".concat(null==o?void 0:o.nome," / ").concat(null==n?void 0:n.nome)),e=!0)})}),ez({status:e,errors:a})},e7=async e=>{if(9===e.length){let a=e.replace(/[^0-9]/g,"");try{let o=await l.h.get("https://viacep.com.br/ws/".concat(a,"/json/"));o.data.localidade?(eu.forEach(async(e,a)=>{("logradouro"===e.nomeColuna||"bairro"===e.nomeColuna||"cidade"===e.nomeColuna||"estado"===e.nomeColuna)&&(await e$("fields[".concat(a,"].logradouro"),o.data.logradouro),await e$("fields[".concat(a,"].bairro"),o.data.bairro),await e$("fields[".concat(a,"].cidade"),o.data.localidade),await e$("fields[".concat(a,"].estado"),o.data.uf))}),ed.ZP.success("Endere\xe7o encontrado!")):ed.ZP.error("Endere\xe7o n\xe3o encontrado!")}catch(t){console.error(t)}}},e6=()=>{e8(),eS(!0),E(!0)},e9=e=>{let a=!0;e.forEach(e=>{e.itens.forEach(e=>{e.respostaConfig&&1==e.respostaConfig.bloqueiaFormulario&&(a=!1)})}),M(a)},ae=async e=>{e.conclusion=!0,await eq(ao)(e)},aa=(e,a,o)=>{let t=30==e?"Em preenchimento":40==e?"Conclu\xeddo":50==e?"Reprovado":60==e?"Aprovado parcialmente":70==e?"Aprovado":"Pendente",n={titulo:"Formul\xe1rio de Fornecedor ".concat(t),descricao:"O formul\xe1rio de Fornecedor #".concat(s," est\xe1 ").concat(t,"."),url:"/formularios/fornecedor/",urlID:s,tipoNotificacaoID:6,usuarioGeradorID:v.usuarioID,usuarioID:0,unidadeID:f.unidadeID,papelID:1};if(n&&(q(n),a)){let l={titulo:"Fornecedor gerado",descricao:"O formul\xe1rio de Fornecedor #".concat(s," est\xe1 ").concat(t," e gerou uma n\xe3o conformidade."),url:"/formularios/fornecedor/nao-conformidade/",urlID:o,tipoNotificacaoID:5,usuarioGeradorID:v.usuarioID,usuarioID:0,unidadeID:f.unidadeID,papelID:1};q(l)}},ao=async function(e){let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!0===a.conclusion&&(e.status=v&&1==v.papelID?a.status:40,e.obsConclusao=a.obsConclusao);let o={form:e,auth:{usuarioID:v.usuarioID,papelID:v.papelID,unidadeID:f.unidadeID}};console.log("\uD83D\uDE80 ~ onSubmit: ",o);try{"edit"==eT?(N(!0),await l.h.post("".concat(eO,"/updateData/").concat(s),o).then(a=>{ed.ZP.success(et.OD.successUpdate),N(!1);let o=null;a.data&&a.data.naoConformidade&&a.data.id>0&&(eM.push("/formularios/fornecedor/nao-conformidade/"),eP(a.data.id),o=a.data.id),aa(e.status,e.naoConformidade,o)})):"new"==eT?await l.h.post("".concat((0,et.g_)(eO),"/insertData"),o).then(e=>{eM.push("".concat((0,et.g_)(eO))),eP(e.data),ed.ZP.success(et.OD.successNew)}):ed.ZP.error(et.OD.error)}catch(t){console.log(t)}},at=async(e,a)=>{A(!0);let o=e.target.files;if(o&&o.length>0){var t;let n=new FormData;for(let r=0;r<o.length;r++)n.append("files[]",o[r]);n.append("usuarioID",v.usuarioID),n.append("unidadeID",f.unidadeID),n.append("produtoAnexoID",null!==(t=a.produtoAnexoID)&&void 0!==t?t:null),await l.h.post("".concat(eO,"/saveAnexo/").concat(s,"/produto/").concat(v.usuarioID,"/").concat(T.unidadeID),n).then(e=>{A(!1);let a=eV();ao(a)}).catch(e=>{var a,o,t;A(!1),ed.ZP.error(null!==(t=null===(a=e.response)||void 0===a?void 0:null===(o=a.data)||void 0===o?void 0:o.message)&&void 0!==t?t:"Erro ao atualizar anexo, tente novamente!")})}},an=async(e,a)=>{b(!0);let o=e.target.files;if(o&&o.length>0){var t;let n=new FormData;for(let r=0;r<o.length;r++)n.append("files[]",o[r]);n.append("usuarioID",v.usuarioID),n.append("unidadeID",f.unidadeID),n.append("grupoAnexoItemID",null!==(t=a.grupoAnexoItemID)&&void 0!==t?t:null),await l.h.post("".concat(eO,"/saveAnexo/").concat(s,"/grupo-anexo/").concat(v.usuarioID,"/").concat(T.unidadeID),n).then(e=>{b(!1);let a=eV();ao(a)}).catch(e=>{var a,o,t;b(!1),ed.ZP.error(null!==(t=null===(a=e.response)||void 0===a?void 0:null===(o=a.data)||void 0===o?void 0:o.message)&&void 0!==t?t:"Erro ao atualizar anexo, tente novamente!")})}},al=async(e,a)=>{F(!0);let o=e.target.files;if(o&&o.length>0){var t,n;let r=new FormData;for(let i=0;i<o.length;i++)r.append("files[]",o[i]);r.append("usuarioID",v.usuarioID),r.append("unidadeID",f.unidadeID),r.append("parFornecedorModeloBlocoID",null!==(t=a.parFornecedorModeloBlocoID)&&void 0!==t?t:null),r.append("itemOpcaoAnexoID",null!==(n=a.itemOpcaoAnexoID)&&void 0!==n?n:null),await l.h.post("".concat(eO,"/saveAnexo/").concat(s,"/item/").concat(v.usuarioID,"/").concat(T.unidadeID),r).then(e=>{F(!1);let a=eV();ao(a)}).catch(e=>{var a,o,t;F(!1),ed.ZP.error(null!==(t=null===(a=e.response)||void 0===a?void 0:null===(o=a.data)||void 0===o?void 0:o.message)&&void 0!==t?t:"Erro ao atualizar anexo, tente novamente!!!!")})}},ar=async e=>{console.log("\uD83D\uDE80 ~ setItemResposta ~ value:",e);try{let a=await l.h.post("/cadastros/item/getItemConfigs",{itemID:e.itemID,alternativaItemID:e.alternativa.id}),o=ev.map(o=>({...o,itens:o.itens.map(o=>o.itemID==e.itemID?(console.log("setItemResposta IGUAL: ",o),{...o,respostaConfig:{...a.data}}):o)}));console.log("\uD83D\uDE80 ~ updatedBlocos:",o),ef(o)}catch(t){console.log("error",t)}},ai=async e=>{e&&await l.h.delete("".concat(eO,"/deleteAnexo/").concat(s,"/").concat(e.anexoID,"/").concat(T.unidadeID,"/").concat(v.usuarioID,"/produto")).then(e=>{let a=eV();ao(a)}).catch(e=>{var a,o,t;ed.ZP.error(null!==(t=null===(a=e.response)||void 0===a?void 0:null===(o=a.data)||void 0===o?void 0:o.message)&&void 0!==t?t:"Erro ao remover anexo, tente novamente!")})},as=async e=>{e&&await l.h.delete("".concat(eO,"/deleteAnexo/").concat(s,"/").concat(e.anexoID,"/").concat(T.unidadeID,"/").concat(v.usuarioID,"/grupo-anexo")).then(e=>{let a=eV();ao(a)}).catch(e=>{var a,o,t;ed.ZP.error(null!==(t=null===(a=e.response)||void 0===a?void 0:null===(o=a.data)||void 0===o?void 0:o.message)&&void 0!==t?t:"Erro ao remover anexo, tente novamente!")})},ad=async e=>{e&&await l.h.delete("".concat(eO,"/deleteAnexo/").concat(s,"/").concat(e.anexoID,"/").concat(T.unidadeID,"/").concat(v.usuarioID,"/item")).then(e=>{let a=eV();ao(a)}).catch(e=>{var a,o,t;ed.ZP.error(null!==(t=null===(a=e.response)||void 0===a?void 0:null===(o=a.data)||void 0===o?void 0:o.message)&&void 0!==t?t:"Erro ao remover anexo, tente novamente!")})};return(0,n.useEffect)(()=>{"edit"==eT&&e4()},[s,w]),(0,n.useEffect)(()=>{e8()},[]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(es.Z,{show:g}),(0,t.jsx)("form",{onSubmit:eq(ao),children:(0,t.jsxs)(Q.Z,{display:"flex",flexDirection:"column",sx:{gap:4},children:[ek.message&&(0,t.jsx)(Y.Z,{severity:"warning",children:ek.message}),eg&&(0,t.jsxs)(Y.Z,{severity:"info",children:["\xdaltima movimenta\xe7\xe3o: Profissional ".concat(eg.nome," do(a) ").concat(eg.nomeFantasia," movimentou o formul\xe1rio de ").concat(eg.statusAnterior," para ").concat(eg.statusAtual," em ").concat(eg.dataHora,"."),eg.observacao&&(0,t.jsxs)("p",{children:[(0,t.jsx)("br",{}),'Mensagem: "',eg.observacao,'"']})]}),eD&&""!=eD.cabecalhoModelo&&(0,t.jsx)(I.Z,{children:(0,t.jsx)(y.Z,{children:(0,t.jsx)(C.Z,{variant:"subtitle1",sx:{mb:2},children:eD.cabecalhoModelo})})}),(0,t.jsxs)(I.Z,{children:[(0,t.jsx)(en.Z,{btnCancel:!0,btnSave:2==v.papelID&&eD.status<40,btnSend:1==v.papelID&&"edit"==eT&&eD.status>=40||2==v.papelID&&eD.status<40,btnPrint:"edit"==eT,actionsData:e2,actions:!0,handleSubmit:()=>eq(ao),handleSend:e6,iconConclusion:"mdi:check-bold",titleConclusion:"Concluir Formul\xe1rio",title:"Fornecedor",btnStatus:"edit"==eT,handleBtnStatus:()=>W(!0),type:eT,status:L}),(0,t.jsx)(y.Z,{children:T&&(0,t.jsx)(eC,{modeloID:T.parFornecedorModeloID,values:J,fields:eu,disabled:!ek.status,register:eH,errors:eJ,setValue:e$,control:eL,getAddressByCep:e7})})]}),T&&(null==T?void 0:T.obrigatorioProdutoFornecedor)&&B&&B.length>0&&(0,t.jsx)(I.Z,{children:(0,t.jsx)(y.Z,{children:(0,t.jsx)(eI,{values:B,handleFileSelect:at,handleRemove:ai,loadingFile:Z,disabled:!ek.status,errors:null==eJ?void 0:eJ.produtos},Z)})}),ev&&ev.map((e,a)=>(0,t.jsx)(d.Z,{index:a,blockKey:"parFornecedorModeloBlocoID",handleFileSelect:al,setItemResposta:ar,handleRemoveAnexoItem:ad,setBlocos:ef,values:e,control:eL,register:eH,setValue:e$,errors:null==eJ?void 0:eJ.blocos,disabled:!ek.status},a)),V&&V.map((e,a)=>(0,t.jsx)(K,{values:{grupo:e,loadingFile:D,indexGrupo:a,handleFileSelect:an,handleRemove:as,folder:"grupo-anexo",disabled:!ek.status,error:eJ}},a)),eD&&(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(I.Z,{children:(0,t.jsx)(y.Z,{children:(0,t.jsx)(m.ZP,{container:!0,spacing:4,children:(0,t.jsx)(m.ZP,{item:!0,xs:12,md:12,children:(0,t.jsxs)(ee.Z,{fullWidth:!0,children:[(0,t.jsx)(C.Z,{variant:"subtitle1",sx:{fontWeight:600,mb:2},children:"Observa\xe7\xf5es (campo de uso exclusivo da validadora)"}),(0,t.jsx)(u.Z,{title:"Observa\xe7\xe3o (opcional)",name:"info.obs",multiline:!0,rows:4,value:eD.obs,disabled:!ek.status,control:eL})]})})})})})}),T&&(0,t.jsx)(eA,{modeloID:T.parFornecedorModeloID,values:X,fields:eu,disabled:!ek.status,register:eH,errors:eJ,setValue:e$,control:eL}),_&&(0,t.jsx)(c.Z,{title:"Hist\xf3rico do Formul\xe1rio",text:"Listagem do hist\xf3rico das movimenta\xe7\xf5es do formul\xe1rio ".concat(s," do Fornecedor."),id:s,parFormularioID:1,formStatus:eD.status,hasFormPending:P,canChangeStatus:1==v.papelID&&!P&&eD.status>30,openModal:_,handleClose:()=>W(!1),btnCancel:!0,btnConfirm:!0,handleSubmit:eU}),(0,t.jsx)(ec.Z,{openModal:ey,handleClose(){eS(!1),E(!1)},title:"Concluir Formul\xe1rio",text:"Deseja realmente concluir este formul\xe1rio?",info:eD,canChange:!P,register:eH,setValue:e$,getValues:eV,btnCancel:!0,btnConfirm:!0,btnConfirmColor:"primary",conclusionForm:ae,listErrors:eN,canApprove:R})]})})]})};var eF=o(60565),ew=o(72819);let eN=e=>{let{values:a}=e;return(0,t.jsxs)(Q.Z,{display:"flex",flexDirection:"column",sx:{gap:4},children:[(0,t.jsxs)(C.Z,{variant:"body2",children:[(0,t.jsx)("strong",{children:"E-mail enviado para: "})," ",null==a?void 0:a.email]}),(0,t.jsxs)(C.Z,{variant:"body2",children:[(0,t.jsx)("strong",{children:"Link do formul\xe1rio: "})," ",null==a?void 0:a.link]})]})},ez=()=>{let{user:e,loggedUnity:a}=(0,n.useContext)(er.V),[o,i]=(0,n.useState)(null),s=(0,ea.useRouter)(),d=s.pathname,{setTitle:c}=(0,n.useContext)(eF.f),{id:u,setId:p}=(0,n.useContext)(el.X),[m,x]=(0,n.useState)(!1),[h,v]=(0,n.useState)(!1),[f,g]=(0,n.useState)(null),j=()=>{x(!0)},D=async()=>{console.log("\uD83D\uDE80 ~ user.cnpj:",e.cnpj),await l.h.post("".concat(d,"/getList/"),{unidadeID:a.unidadeID,papelID:e.papelID,cnpj:e.cnpj?e.cnpj:null}).then(e=>{i(e.data),c({title:"Fornecedor",subtitle:{id:u,count:e.data.length,new:!1}})})},b=async o=>{console.log("\uD83D\uDE80 ~ makeFornecedor : ",o);try{let t=await l.h.post("/formularios/fornecedor/makeFornecedor",{usuarioID:e.usuarioID,papelID:e.papelID,unidadeID:a.unidadeID,values:o.fields});200==t.status&&(ed.ZP.success("E-mail enviado com sucesso"),g(t.data),p(t.data.fornecedorID),v(!0))}catch(n){console.error(n),console.error("Erro ao enviar email",n)}},Z=()=>{let e=null==f?void 0:f.link;e&&(navigator.clipboard.writeText(e),ed.ZP.success("Link copiado com sucesso!"))};(0,n.useEffect)(()=>{D()},[u]),(0,n.useEffect)(()=>{s.query.f&&p(s.query.f)},[s.query]);let I=1==e.papelID?[{headerName:"ID",field:"id",size:1},{headerName:"Fornecedor",field:"fornecedor",size:1},{headerName:"CNPJ",field:"cnpj",size:1},{headerName:"Data da Avalia\xe7\xe3o",field:"data",size:1,type:"date"},{headerName:"Cidade",field:"cidade",size:1},{headerName:"Respons\xe1vel",field:"responsavel",size:1},{headerName:"Status",field:{name:"status",cor:"cor"},size:1}]:2==e.papelID?[{headerName:"ID",field:"id",size:1},{headerName:"F\xe1brica",field:"fabrica",size:1},{headerName:"CNPJ",field:"cnpj",size:1},{headerName:"Data da Avalia\xe7\xe3o",field:"data",size:1,type:"date"},{headerName:"Cidade",field:"cidade",size:1},{headerName:"Respons\xe1vel",field:"responsavel",size:1},{headerName:"Status",field:{name:"status",cor:"cor"},size:1}]:[],y=(0,et.OL)(d,I);return(0,t.jsxs)(t.Fragment,{children:[o?u&&u>0?(0,t.jsx)(eS,{id:u,makeFornecedor:b}):(0,t.jsx)(r.Z,{result:o,columns:y,openModal:1==e.papelID?j:null,btnNew:1==e.papelID}):(0,t.jsx)(es.Z,{show:!0}),(0,t.jsx)(ew.Z,{title:"Habilitar Fornecedor",description:"Habilitar novo preenchimento de formul\xe1rio pro fornecedor",handleConclusion:b,setOpenModal:x,openModal:m,size:"lg",children:(0,t.jsx)(eb,{})}),(0,t.jsx)(ew.Z,{title:"Formul\xe1rio enviado ao fornecedor",description:"Um novo formul\xe1rio de qualifica\xe7\xe3o de fornecedor foi enviado",handleCopyLink:Z,setOpenModal:v,openModal:h,children:(0,t.jsx)(eN,{values:f})})]})};var eE=ez},84242:function(e,a,o){"use strict";o.d(a,{Z:function(){return b}});var t=o(85893),n=o(61953),l=o(67836),r=o(80562),i=o(50853),s=o(11163),d=o.n(s),c=o(75084),u=o(41664),p=o.n(u),m=o(40039),x=o(67294),h=o(83830),v=o(46749),f=o(21609);let g=e=>{let{btnNew:a,btnPrint:o,btnSave:n,btnBack:l,handleSave:r,hasListChange:i,openModal:s}=e,u=d(),{setId:g}=(0,x.useContext)(h.X),{routes:j}=(0,x.useContext)(m.V);return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between my-2 w-full",children:[(0,t.jsx)("div",{}),(0,t.jsxs)("div",{className:"flex items-center gap-4 ",children:[(0,t.jsx)("div",{children:o&&(0,t.jsxs)(c.Z,{onClick:()=>window.print(),type:"button",variant:"outlined",color:"primary",size:"medium",sx:{display:"flex",gap:2},children:[(0,t.jsx)(f.Z,{icon:"mdi:printer"}),(0,t.jsx)("span",{className:"hidden sm:block",children:"Imprimir"})]})}),(0,t.jsx)("div",{className:"",children:a&&j.find(e=>(e.rota===u.pathname||e.rota===(0,v.g_)(u.pathname))&&e.inserir)&&(0,t.jsx)(p(),{href:s?"":"".concat(u.pathname,"/novo"),children:(0,t.jsxs)(c.Z,{type:"button",variant:"outlined",color:"primary",size:"medium",onClick:s||null,sx:{display:"flex",gap:2},children:[(0,t.jsx)(f.Z,{icon:"ic:outline-plus"}),(0,t.jsx)("span",{className:"hidden sm:block",children:"Novo"})]})})}),(0,t.jsx)("div",{children:n&&(0,t.jsxs)(c.Z,{onClick:r,disabled:!i,type:"button",variant:"outlined",color:"primary",size:"medium",sx:{display:"flex",gap:2},children:[(0,t.jsx)(f.Z,{icon:"mdi:check-bold"}),(0,t.jsx)("span",{className:"hidden sm:block",children:"Salvar"})]})})]})]})})};var j=o(61225);let D=e=>{let a=d(),{setId:o}=(0,x.useContext)(h.X);return(0,j.Z)("(min-width:640px)"),(0,t.jsxs)(n.Z,{sx:{display:"flex",flexDirection:"row",gap:2,alignItems:"center",mb:2,justifyContent:"space-between",p:e=>e.spacing(8,0,0,0)},children:[(0,t.jsxs)(n.Z,{sx:{display:"flex",gap:"8px",textAlig:"end"},children:[e.buttonsHeader.btnBack&&(0,t.jsx)(c.Z,{onClick(){a.push((0,v.g_)(a.pathname)),o(null)},type:"button",variant:"outlined",color:"primary",size:"small",children:(0,t.jsx)(f.Z,{icon:"material-symbols:arrow-back-rounded"})}),(0,t.jsx)(l.Z,{size:"medium",value:e.value,onChange:e.onChange,placeholder:"Buscar…",variant:"standard",InputProps:{startAdornment:(0,t.jsx)(n.Z,{sx:{mr:2,display:"flex"},children:(0,t.jsx)(f.Z,{icon:"mdi:magnify",fontSize:20})}),endAdornment:(0,t.jsx)(r.Z,{size:"medium",title:"Clear","aria-label":"Clear",onClick:e.clearSearch,children:(0,t.jsx)(f.Z,{icon:"mdi:close",fontSize:20})})},sx:{width:{xs:1,sm:"auto"},"& .MuiInputBase-root > svg":{mr:2}}}),(0,t.jsx)("div",{className:"hidden sm:block ",children:(0,t.jsx)(i.M,{className:"!h-full"})})]}),(0,t.jsx)(g,{btnNew:e.buttonsHeader.btnNew,btnPrint:e.buttonsHeader.btnPrint,btnBack:e.buttonsHeader.btnBack,btnSave:e.buttonsHeader.btnSave,handleSave:e.buttonsHeader.handleSave,hasListChange:e.hasChange,openModal:e.buttonsHeader.openModal})]})};var b=D},95722:function(e,a,o){"use strict";var t=o(85893),n=o(67294),l=o(87630),r=o(75680),i=o(84242),s=o(60565),d=o(83830);let c=e=>{let{rows:a,columns:o,buttonsHeader:c}=e,{handleSearch:u,pageSize:p,setPageSize:m,searchText:x,filteredData:h,setData:v,data:f}=(0,n.useContext)(s.f),{setId:g}=(0,n.useContext)(d.X);function j(e){let a=e.split("/");return"".concat(a[2],"-").concat(a[1],"-").concat(a[0])}return v(a),o.map(e=>{"date"===e.type&&(e.sortComparator=(e,a)=>{let o=j(e),t=j(a);return o.localeCompare(t)})}),(0,t.jsx)(l._,{localeText:r.F.components.MuiDataGrid.defaultProps.localeText,autoHeight:!0,columns:o,pageSize:p,rowsPerPageOptions:[10,20,30,40,50,100],components:{Toolbar:i.Z},rows:x?h:f,onCellClick(e,a){g(e.row.id)},onPageSizeChange:e=>m(e),sx:{"& .MuiDataGrid-cell":{cursor:"pointer",overflow:"scroll"}},componentsProps:{toolbar:{value:x,clearSearch:()=>u(""),onChange:e=>u(e.target.value),buttonsHeader:c}}})};a.Z=c}},function(e){e.O(0,[4186,1445,1111,5999,2389,2187,9349,1515,5876,1959,9774,2888,179],function(){return e(e.s=59424)}),_N_E=e.O()}]);