"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2350],{82350:function(e,o,t){t.d(o,{Z:function(){return P}});var l=t(85893),n=t(11163),s=t.n(n),r=t(67294),i=t(60565),a=t(83830),d=t(60664),c=t(49837),u=t(91359),x=t(79072),m=t(87536),v=t(86501),h=t(47842),f=t(45061),p=t(46749),g=t(36188),j=t(29308),Z=t(84220),b=t(67569),y=t(40039),D=t(29630),C=t(61953),w=t(75084),I=t(3893),S=t(88475);let E=e=>{var o,t,n,s,r;let{data:i,index:a,indexAnexo:d,handleRemoveAnexo:c,control:u,register:x,errors:m}=e;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(j.Z,{xs:12,md:9,title:"Nome",name:"fields.opcoes[".concat(a,"].anexos[").concat(d,"].nome"),required:!0,control:u,errors:null==m?void 0:null===(o=m.fields)||void 0===o?void 0:null===(t=o.opcoes)||void 0===t?void 0:null===(n=t[a])||void 0===n?void 0:null===(s=n.anexos)||void 0===s?void 0:null===(r=s[d])||void 0===r?void 0:r.nome}),(0,l.jsx)(I.Z,{xs:6,md:2,title:"Obrigat\xf3rio",name:"fields.opcoes[".concat(a,"].anexos[").concat(d,"].obrigatorio"),value:i.obrigatorio,register:x}),(0,l.jsx)(S.Z,{xs:6,md:1,title:0==d?"Remover":"",index:a,removeItem:()=>c(i,a,d),item:i,pending:!1,textSuccess:"Remover este anexo",textError:"Este anexo n\xe3o pode mais ser removido pois possui v\xednculo atrelado a ele"})]})};var A=t(21609);t(74865);let F=e=>{let{data:o,addAnexo:t,register:n,control:s,errors:i,handleRemoveAnexo:a,getValues:d,watch:m}=e,[v,h]=(0,r.useState)(!1),[f,p]=(0,r.useState)((()=>{let e=[];return o&&o.map(o=>{e.push(1==o.anexo)}),e})()),g=e=>{let o=[...f];o[e]=!o[e],p(o)};return o&&o.map((e,o)=>(0,l.jsx)(c.Z,{sx:{mt:3},children:(0,l.jsxs)(u.Z,{children:[(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(D.Z,{variant:"h6",sx:{my:3},children:(0,l.jsxs)(C.Z,{display:"flex",alignItems:"center",sx:{gap:2},children:[(0,l.jsx)(A.Z,{icon:"akar-icons:edit"}),(0,l.jsx)("p",{children:e.nome})]})}),(0,l.jsxs)(C.Z,{display:"flex",alignItems:"center",sx:{gap:4},children:[(0,l.jsx)(C.Z,{children:(0,l.jsx)(I.Z,{title:"Solicita anexo",name:"fields.opcoes[".concat(o,"].anexo"),onChange:()=>g(o),value:e.anexo,register:n})}),(0,l.jsx)(C.Z,{children:(0,l.jsx)(I.Z,{title:"Bloqueia formul\xe1rio",name:"fields.opcoes[".concat(o,"].bloqueiaFormulario"),value:e.bloqueiaFormulario,register:n})}),(0,l.jsx)(C.Z,{children:(0,l.jsx)(I.Z,{title:"Observa\xe7\xe3o",name:"fields.opcoes[".concat(o,"].observacao"),value:e.observacao,register:n})})]})]}),f[o]&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(D.Z,{variant:"body1",sx:{my:3},children:"Anexos do item"}),(0,l.jsx)(x.ZP,{container:!0,spacing:4,children:e.anexos.map((e,t)=>(0,l.jsx)(E,{index:o,indexAnexo:t,data:e,control:s,handleRemoveAnexo:a,register:n,errors:i},v))}),(0,l.jsx)(C.Z,{sx:{mt:3},children:(0,l.jsx)(w.Z,{type:"button",variant:"outlined",startIcon:(0,l.jsx)(A.Z,{icon:"material-symbols:add-circle-outline-rounded"}),onClick:()=>t(o),children:"Inserir"})})]})]})}))},k=e=>{var o,t,n,D,C,w,I,S,E;let{id:A,setNewChange:k,newChange:P}=e,[N,q]=(0,r.useState)(!1),[O,z]=(0,r.useState)(!1),[R,V]=(0,r.useState)(null),_=s(),T=A&&A>0?"edit":"new",$=_.pathname,{title:L}=(0,r.useContext)(i.f),{setId:M}=(0,r.useContext)(a.X),{loggedUnity:W}=(0,r.useContext)(y.V),{trigger:B,handleSubmit:K,watch:Q,getValues:U,setValue:X,reset:G,control:H,formState:{errors:J},register:Y}=(0,m.cI)(),ee=async e=>{let o={...e,unidadeID:W.unidadeID};console.log("onSubmit: ",o);try{"new"===T?await d.h.post("cadastros/item/new/insertData",o).then(e=>{_.push("".concat((0,p.g_)($))),M(e.data),v.ZP.success(p.OD.successNew)}):"edit"===T&&(await d.h.post("".concat($,"/updateData/").concat(A),o),v.ZP.success(p.OD.successUpdate)),setSavingForm(!savingForm)}catch(t){t.response&&409===t.response.status?v.ZP.error(p.OD.errorRepeated):console.log(t)}},eo=async()=>{try{await d.h.delete("".concat($,"/").concat(A)),M(null),q(!1),v.ZP.success(p.OD.successDelete)}catch(e){e.response&&409===e.response.status?(v.ZP.error(p.OD.pendingDelete),q(!1)):console.log(e)}},et=async()=>{try{let e="new"===T?"cadastros/item/new/getData":"".concat($,"/getData/").concat(A);await d.h.post(e).then(e=>{console.log("\uD83D\uDE80 ~ getData: ",e.data),V(e.data),G(e.data)})}catch(o){console.log(o)}},el=e=>{let o=[...U("fields.opcoes")];o[e].anexos.push({nome:"",obrigatorio:!1});let t={...R,fields:{...R.fields,opcoes:o}};V(t),X("fields.opcoes",o)},en=async e=>{try{let o=await d.h.post("cadastros/item/getAlternatives",{alternativa:e});o.data&&(console.log("\uD83D\uDE80 ~ response.data:",o.data),z(!O),X("fields.opcoes",o.data),V({...R,fields:{...R.fields,opcoes:o.data}}))}catch(t){console.log(t)}},es=(e,o,t)=>{console.log("\uD83D\uDE80 ~ data, index, indexAnexo:",e,o,t);let l=[...U("fields.opcoes")];l[o].anexos.splice(t,1),console.log("\uD83D\uDE80 ~ copyAnexos:",l);let n={...R,fields:{...R.fields,opcoes:l}};console.log("\uD83D\uDE80 ~ newData:",n),V(n),X("fields.opcoes",l),z(!O)};return(0,r.useEffect)(()=>{et(),"new"===T&&setTimeout(()=>{B()},300)},[A]),(0,r.useEffect)(()=>{P&&K(ee)()},[P]),(0,l.jsxs)(l.Fragment,{children:[!R&&(0,l.jsx)(h.Z,{}),R&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(c.Z,{children:(0,l.jsxs)("form",{onSubmit:K(ee),id:"formItem",children:[(0,l.jsx)(g.Z,{btnCancel:!0,btnNew:!0,btnSave:!0,handleSubmit:()=>K(ee),btnDelete:"edit"===T,onclickDelete:()=>q(!0),type:T}),(0,l.jsx)(u.Z,{children:(0,l.jsxs)(x.ZP,{container:!0,spacing:5,children:[(0,l.jsx)(Z.Z,{xs:12,md:11,title:"Formul\xe1rios",name:"fields.formulario",value:null==R?void 0:R.fields.formulario,required:!0,options:null==R?void 0:null===(o=R.fields)||void 0===o?void 0:null===(t=o.formulario)||void 0===t?void 0:t.opcoes,register:Y,setValue:X,control:H,errors:null==J?void 0:null===(n=J.fields)||void 0===n?void 0:n.formulario}),(0,l.jsx)(b.Z,{xs:1,md:1,title:"Ativo",name:"fields.status",value:R.fields.status,typePage:T,register:Y}),(0,l.jsx)(j.Z,{xs:12,md:12,title:"Nome",name:"fields.nome",required:!0,control:H,errors:null==J?void 0:null===(D=J.fields)||void 0===D?void 0:D.nome}),(0,l.jsx)(Z.Z,{xs:12,md:12,title:"Alternativa",name:"fields.alternativa",value:null==R?void 0:R.fields.alternativa,onChange:en,required:!0,options:null==R?void 0:null===(C=R.fields)||void 0===C?void 0:null===(w=C.alternativa)||void 0===w?void 0:w.opcoes,register:Y,setValue:X,control:H,errors:null==J?void 0:null===(I=J.fields)||void 0===I?void 0:I.alternativa}),(0,l.jsx)(j.Z,{xs:12,md:12,multiline:!0,rows:4,title:"Ajuda do item (mostrado em (?))",name:"fields.ajuda",control:H,errors:null==J?void 0:null===(S=J.fields)||void 0===S?void 0:S.ajuda})]})})]})}),(0,l.jsx)(F,{data:null==R?void 0:null===(E=R.fields)||void 0===E?void 0:E.opcoes,handleRemoveAnexo:es,register:Y,control:H,errors:J,getValues:U,addAnexo:el,watch:Q},O)]}),(0,l.jsx)(f.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+L.title,openModal:N,handleClose:()=>q(!1),handleSubmit:eo,btnCancel:!0,btnConfirm:!0})]})};var P=k},45061:function(e,o,t){var l=t(85893),n=t(75084),s=t(1890),r=t(77745),i=t(95398),a=t(76779),d=t(44642);t(21609);var c=t(19604),u=t(29630),x=t(55343),m=t(67836),v=t(67294),h=t(82747);t(84220),t(29308),t(67569),t(3893),t(88475);let f=e=>{let{title:o,text:t,handleClose:f,openModal:p,handleSubmit:g,cnpj:j,nomeFornecedor:Z,gruposAnexo:b,email:y,setEmail:D,inputEmail:C,btnCancel:w,btnConfirm:I,grupoAnexosFornecedor:S,btnCancelColor:E,btnConfirmColor:A,closeAfterSave:F,listErrors:k}=e,[P,N]=(0,v.useState)(!1);return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(s.Z,{open:p,"aria-labelledby":"form-dialog-title",disableEscapeKeyDown:!0,onClose(e,o){"backdropClick"!==o&&f()},children:[(0,l.jsx)(r.Z,{id:"form-dialog-title",children:o}),(0,l.jsxs)(i.Z,{children:[(0,l.jsxs)(d.Z,{sx:{mb:3},children:[t,k&&k.status&&(0,l.jsxs)(c.Z,{variant:"outlined",severity:"error",sx:{mt:2},children:["Por favor, verifique os campos abaixo:",(0,l.jsx)(u.Z,{variant:"subtitle1",color:"error",sx:{mt:2},children:k.errors.map((e,o)=>(0,l.jsxs)(u.Z,{variant:"body2",color:"error",children:["- ",e]},o))})]})]}),C&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(x.Z,{sx:{mt:2},fullWidth:!0,children:[(0,l.jsx)(m.Z,{defaultValue:"",type:"email",label:"E-mail do Fornecedor (opcional)",placeholder:"E-mail do Fornecedor (opcional)","aria-describedby":"validation-schema-nome",name:"email",error:(null==y?void 0:y.length)>0&&P,inputProps:{onChange(e){D(e.target.value),N(!(0,h.dI)(e.target.value))}}}),(null==y?void 0:y.length)>0&&P&&(0,l.jsx)(u.Z,{variant:"body2",color:"error",children:"Por favor, insira um e-mail v\xe1lido!"})]}),(0,l.jsx)(c.Z,{severity:"info",sx:{mt:2},children:"Se o e-mail for preenchido, o mesmo receber\xe1 as instru\xe7\xf5es de cadastro e preenchimento do formul\xe1rio no e-mail."})]})]}),(0,l.jsxs)(a.Z,{className:"dialog-actions-dense",children:[w&&(0,l.jsx)(n.Z,{variant:"outlined",color:"primary",onClick:f,children:"Cancelar"}),I&&(0,l.jsx)(n.Z,{variant:"contained",disabled:C&&(null==y?void 0:y.length)>0&&P||k&&k.status,color:A||"error",onClick:C&&j?()=>{g(j,Z,b,y),F&&f()}:C&&!j?()=>{g(y),F&&f()}:()=>{g(),F&&f()},children:"Confirmar"})]})]})})};o.Z=f},3893:function(e,o,t){var l=t(85893),n=t(79072),s=t(61953),r=t(22841),i=t(75158);let a=e=>{let{xs:o,md:t,title:a,index:d,name:c,typePage:u,value:x,disabled:m,register:v,onChange:h,...f}=e;return(0,l.jsx)(n.ZP,{item:!0,xs:o,md:t,children:(0,l.jsx)(s.Z,{display:"flex",flexDirection:"column",alignItems:"start",children:(0,l.jsx)(r.Z,{control:(0,l.jsx)(i.Z,{...f,name:c,...v(c),defaultChecked:x,disabled:m,onChange:h}),label:a,size:"small",sx:{"&:hover":{"& .MuiFormControlLabel-label":{color:"primary.main"}}}})})})};o.Z=a},88475:function(e,o,t){var l=t(85893),n=t(79072),s=t(61953),r=t(29630),i=t(72389),a=t(80562),d=t(21609);let c=e=>{let{xs:o,md:t,title:c,removeItem:u,item:x,pending:m,index:v,textSuccess:h,textError:f}=e;return h=h||"Remover este item",f=f||"Este item n\xe3o pode ser removido pois possui cadastros vinculados a ele",(0,l.jsx)(n.ZP,{item:!0,xs:o,md:t,children:(0,l.jsxs)(s.Z,{height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",children:[(0,l.jsx)(r.Z,{variant:"caption",children:c}),(0,l.jsx)(i.Z,{title:1==m?f:h,children:(0,l.jsx)(a.Z,{color:"error",size:"small",onClick(){1!=m&&u(x,v)},sx:{opacity:1==m?.5:1,cursor:1==m?"default":"pointer"},children:(0,l.jsx)(d.Z,{icon:"tabler:trash-filled"})})})]})})};o.Z=c},84220:function(e,o,t){var l=t(85893),n=t(79072),s=t(55343),r=t(35966),i=t(67836),a=t(87536);let d=e=>{var o;let{xs:t,md:d,title:c,options:u,name:x,type:m,limitTags:v,value:h,required:f,control:p,disabled:g,multiple:j,setValue:Z,errors:b,onChange:y,className:D,createNew:C,handleRegistroEstabelecimento:w}=e,I=[...u];return C&&(I=[{nome:"-- Novo --"},...u]),(0,l.jsx)(n.ZP,{item:!0,xs:t,md:d,sx:{my:1},className:D,children:(0,l.jsx)(s.Z,{fullWidth:!0,children:(0,l.jsx)(a.Qr,{name:x,control:p,defaultValue:h,rules:{required:f},render(e){let{field:t}=e;return(0,l.jsx)(r.Z,{...t,multiple:j,limitTags:v,size:"small",options:I,getOptionLabel:e=>(null==e?void 0:e.cnpj)?"".concat(e.cnpj," - ").concat(e.nome):null==e?void 0:e.nome,value:j&&t.value&&t.value.length>0?t.value.map(e=>u.find(o=>o.nome===e.nome)):null!==(o=t.value)&&void 0!==o?o:{nome:""},disabled:g,onChange(e,o){o&&"-- Novo --"===o.nome?(C(),Z(x,j?[]:{nome:""})):(y&&y(o),Z(x,o),"registroestabelecimento"===m&&w(o?o.id:null))},renderInput:e=>(0,l.jsx)(i.Z,{...e,label:c,placeholder:c,error:!!b}),noOptionsText:"Sem op\xe7\xf5es"})}})})})};o.Z=d},47842:function(e,o,t){var l=t(85893),n=t(70754);let s=e=>{let{show:o,title:t}=e;return o&&(0,l.jsx)("div",{className:"absolute inset-0 flex items-center justify-center rounded-lg bg-gray-900 z-50",children:(0,l.jsxs)("div",{className:"flex flex-col justify-center items-center gap-2 ",children:[(0,l.jsx)(n.Z,{color:"primary"}),(0,l.jsx)("p",{className:"text-sm opacity-80 text-white ",children:null!=t?t:"Carregando..."})]})})};o.Z=s},82747:function(e,o,t){function l(e){if(14!==(e=null==e?void 0:e.replace(/[^\d]+/g,"")).length||/^(\d)\1+$/.test(e))return!1;let o=e.length-2,t=e.substring(0,o),l=e.substring(o),n=0,s=o-7;for(let r=o;r>=1;r--)n+=t.charAt(o-r)*s--,s<2&&(s=9);let i=n%11<2?0:11-n%11;if(i!=l.charAt(0))return!1;o+=1,t=e.substring(0,o),n=0,s=o-7;for(let a=o;a>=1;a--)n+=t.charAt(o-a)*s--,s<2&&(s=9);return(i=n%11<2?0:11-n%11)==l.charAt(1)}function n(e){let o;if(11!==(e=e.replace(/[^\d]+/g,"")).length||/^(\d)\1+$/.test(e))return!1;let t=0;for(let l=1;l<=9;l++)t+=parseInt(e.substring(l-1,l))*(11-l);if((10==(o=10*t%11)||11===o)&&(o=0),o!==parseInt(e.substring(9,10)))return!1;t=0;for(let n=1;n<=10;n++)t+=parseInt(e.substring(n-1,n))*(12-n);return(10==(o=10*t%11)||11===o)&&(o=0),o===parseInt(e.substring(10,11))}function s(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}t.d(o,{dI:function(){return s},sw:function(){return n},zk:function(){return l}})}}]);