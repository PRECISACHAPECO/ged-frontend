(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5596],{29295:function(e,t,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/configuracoes/formularios/limpeza",function(){return o(7603)}])},7603:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return E}});var s=o(85893),i=o(67294),n=o(60664),a=o(93250),l=o(60565),r=o(83830),d=o(87536),c=o(49837),m=o(91359),u=o(79072),x=o(85214),v=o(29630),h=o(75084),p=o(11163),j=o.n(p),b=o(46749),Z=o(5707),g=o(40039),f=o(86501),k=o(47842),P=o(21609),S=o(1948),I=o(84220),C=o(29308),N=o(67569),w=o(3893),_=o(88475);o(53934);let y=e=>{var t,o,a,l;let{id:r}=e,{user:p,loggedUnity:y}=(0,i.useContext)(g.V),[D,E]=(0,i.useState)(),[q,B]=(0,i.useState)(),[O,R]=(0,i.useState)(null),[F,z]=(0,i.useState)(),[M,V]=(0,i.useState)(),[A,L]=(0,i.useState)(!1),[W,T]=(0,i.useState)(),[X,U]=(0,i.useState)(!1),[G,H]=(0,i.useState)([]),[J,K]=(0,i.useState)([]),Q=j(),Y=Q.pathname,{setValue:$,register:ee,handleSubmit:et,reset:eo,control:es,formState:{errors:ei}}=(0,d.cI)(),en=async e=>{let t={id:r,unidadeID:y.unidadeID,model:e.model,header:e.header,blocks:e.blocks,arrRemovedBlocks:J,arrRemovedItems:G,orientacoes:e.orientations};B(null);try{await n.h.put("".concat(Y,"/updateData"),t).then(e=>{f.ZP.success(b.OD.successUpdate),U(!X)})}catch(o){console.log(o)}},ea=(e,t,o,s)=>{let i=s.itens;i=i.filter(t=>{let o=e.itens.some(e=>e.item&&t.id===e.item.id);return!o});let n=[...o];n[t].optionsBlock.itens=i,z(n)},el=e=>{var t;let o=[...F];o[e].itens.push({ordem:(null===(t=o[e].itens)||void 0===t?void 0:t.length)+1,obs:1,status:1,obrigatorio:1}),z(o),$("blocks.[".concat(e,"].itens.[").concat(o[e].itens.length-1,"].new"),!0),ea(o[e],e,F,O)},er=(e,t,o)=>{if(1===F[t].itens.length){f.ZP.error("Voc\xea deve ter ao menos um item!");return}let s=[...G];s.push(e),H(s);let i=[...F],n=[...F[t].itens];n.splice(o,1),i[t].itens=n,z(i),$("blocks.[".concat(t,"].itens"),n),ea(F[t],t,F,O)},ed=(e,t)=>{let o=!0;if(e&&e.itens.map(e=>{1==e.hasPending&&(o=!1)}),!o){f.ZP.error("Este bloco n\xe3o pode ser removido pois possui itens respondidos em um formul\xe1rio");return}let s=[...J];s.push(e.dados.parLimpezaModeloBlocoID),K(s);let i=[...F];i.splice(t,1),z(i),$("blocks",i),f.ZP.success("Bloco pr\xe9-removido. Salve para concluir!")},ec=()=>{let e=[...F];e.push({dados:{ordem:e.length+1,nome:"",status:1},categorias:[],atividades:[],optionsBlock:{itens:[...O.itens],alternativas:[...O.alternativas]},itens:[{parFormularioID:1,new:!0,ordem:"1",nome:"",status:1,item:null,alternativa:null}]}),z(e)},em=()=>{try{n.h.post("".concat(Y,"/getData"),{id:r}).then(e=>{E(e.data.model),B(e.data.header),z(e.data.blocks),R({itens:e.data.options.itens,alternativas:e.data.options.alternativas}),V(e.data.orientations),eo(e.data),setTimeout(()=>{e.data.blocks.map((t,o)=>{ea(t,o,e.data.blocks,e.data.options)})},3e3)})}catch(e){console.log(e)}};return(0,i.useEffect)(()=>{em()},[r,X]),(0,s.jsx)(s.Fragment,{children:q?(0,s.jsxs)("form",{onSubmit:et(en),children:[D&&(0,s.jsxs)(c.Z,{children:[(0,s.jsx)(Z.Z,{partialRoute:!0,btnCancel:!0,btnSave:!0,handleSubmit:()=>et(en),type:"edit"}),(0,s.jsx)(m.Z,{children:(0,s.jsxs)(u.ZP,{container:!0,spacing:4,children:[(0,s.jsx)(C.Z,{className:"order-1",xs:12,md:8,title:"Modelo",name:"model.nome",value:D.nome,required:!0,control:es,errors:null==ei?void 0:null===(t=ei.model)||void 0===t?void 0:t.nome}),(0,s.jsx)(C.Z,{className:"order-1",xs:12,md:3,type:"number",title:"Ciclo (dias)",name:"model.ciclo",value:D.ciclo,required:!0,control:es,errors:null==ei?void 0:null===(o=ei.model)||void 0===o?void 0:o.ciclo,help:{text:"opaopoaspoasp opaso",position:"top",gapLeft:"10px"}}),(0,s.jsx)(N.Z,{className:"order-2 md:order-3",xs:2,md:1,title:"Ativo",name:"model.status",value:D.status,register:ee})]})})]}),q&&(0,s.jsx)(c.Z,{sx:{mt:4},children:(0,s.jsx)(m.Z,{children:(0,s.jsx)(x.Z,{component:"nav","aria-label":"main mailbox",children:(0,s.jsxs)(u.ZP,{container:!0,spacing:2,children:[(0,s.jsx)(u.ZP,{item:!0,md:4,xs:4,children:(0,s.jsx)(v.Z,{variant:"subtitle1",sx:{fontWeight:600},children:"Nome do Campo"})}),(0,s.jsx)(u.ZP,{item:!0,md:3,xs:4,children:(0,s.jsx)(v.Z,{variant:"subtitle1",sx:{fontWeight:600},children:"Mostra no Formul\xe1rio"})}),(0,s.jsx)(u.ZP,{item:!0,md:3,xs:4,children:(0,s.jsx)(v.Z,{variant:"subtitle1",sx:{fontWeight:600},children:"Obrigat\xf3rio"})}),q.map((e,t)=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.ZP,{item:!0,md:4,xs:6,children:e.nomeCampo}),(0,s.jsx)(u.ZP,{item:!0,md:3,xs:3,children:(0,s.jsx)(w.Z,{title:"",name:"header.[".concat(t,"].mostra"),value:e.mostra,register:ee,disabled:"cnpj"==e.nomeColuna})}),(0,s.jsx)(u.ZP,{item:!0,md:3,xs:3,children:(0,s.jsx)(w.Z,{title:"",name:"header.[".concat(t,"].obrigatorio"),value:e.obrigatorio,register:ee,disabled:"cnpj"==e.nomeColuna})})]}))]})})})}),!F&&(0,s.jsx)(k.Z,{}),F&&F.map((e,t)=>{var o,i,n,r,d,x;return(0,s.jsx)(c.Z,{md:12,sx:{mt:4},children:(0,s.jsxs)(m.Z,{children:[(0,s.jsxs)(u.ZP,{container:!0,spacing:4,children:[(0,s.jsx)(C.Z,{className:"order-1",xs:10,md:1,title:"Sequ\xeancia",name:"blocks.[".concat(t,"].dados.ordem"),value:e.dados.ordem,required:!0,control:es,errors:null==ei?void 0:null===(o=ei.blocks)||void 0===o?void 0:null===(i=o[t])||void 0===i?void 0:null===(n=i.dados)||void 0===n?void 0:n.ordem}),(0,s.jsx)(C.Z,{className:"order-3 md:order-2",xs:10,md:9,title:"Nome do Bloco",name:"blocks.[".concat(t,"].dados.nome"),value:e.dados.nome,required:!0,control:es,errors:null==ei?void 0:null===(r=ei.blocks)||void 0===r?void 0:null===(d=r[t])||void 0===d?void 0:null===(x=d.dados)||void 0===x?void 0:x.nome}),(0,s.jsx)(N.Z,{className:"order-2 md:order-3",xs:2,md:1,title:"Ativo",name:"blocks.[".concat(t,"].dados.status"),value:F[t].dados.status,register:ee}),(0,s.jsx)(N.Z,{className:"order-4 ",xs:2,md:1,title:"Observa\xe7\xe3o",name:"blocks.[".concat(t,"].dados.obs"),value:F[t].dados.obs,register:ee})]}),(0,s.jsx)(v.Z,{variant:"subtitle1",sx:{fontWeight:600,mt:4},children:"Itens"}),e.itens&&e.itens.map((e,o)=>{var i,n,r,d,c,m,x,v,h,p,j,b,Z;return(0,s.jsxs)(u.ZP,{id:"item-".concat(t,"-").concat(o),container:!0,spacing:2,sx:{my:1},children:[(0,s.jsx)(C.Z,{xs:12,md:1,title:"Sequ\xeancia",name:"blocks.[".concat(t,"].itens.[").concat(o,"].ordem"),value:e.ordem,required:!0,control:es,errors:null==ei?void 0:null===(i=ei.blocks)||void 0===i?void 0:null===(n=i[t])||void 0===n?void 0:null===(r=n.itens)||void 0===r?void 0:null===(d=r[o])||void 0===d?void 0:d.ordem}),(0,s.jsx)(I.Z,{xs:12,md:5,title:F[t].itens[o].itemID?"Item [".concat(F[t].itens[o].itemID,"]"):"Item",name:"blocks.[".concat(t,"].itens.[").concat(o,"].item"),value:null!==(a=F[t].itens[o].item)&&void 0!==a?a:null,required:!0,disabled:1==e.hasPending,options:null===(c=F[t].optionsBlock)||void 0===c?void 0:c.itens,register:ee,setValue:$,control:es,errors:null==ei?void 0:null===(m=ei.blocks)||void 0===m?void 0:null===(x=m[t])||void 0===x?void 0:null===(v=x.itens)||void 0===v?void 0:null===(h=v[o])||void 0===h?void 0:h.item}),(0,s.jsx)(I.Z,{xs:12,md:2,title:"Alternativa",name:"blocks.[".concat(t,"].itens.[").concat(o,"].alternativa"),value:null!==(l=F[t].itens[o].alternativa)&&void 0!==l?l:null,required:!0,disabled:1==e.hasPending,options:O.alternativas,register:ee,setValue:$,control:es,errors:null==ei?void 0:null===(p=ei.blocks)||void 0===p?void 0:null===(j=p[t])||void 0===j?void 0:null===(b=j.itens)||void 0===b?void 0:null===(Z=b[o])||void 0===Z?void 0:Z.alternativa}),(0,s.jsx)(N.Z,{xs:2,md:1,title:"Ativo",index:o,name:"blocks.[".concat(t,"].itens.[").concat(o,"].status"),value:F[t].itens[o].status,register:ee}),(0,s.jsx)(N.Z,{xs:2,md:1,title:"Obs",index:o,name:"blocks.[".concat(t,"].itens.[").concat(o,"].obs"),value:F[t].itens[o].obs,register:ee}),(0,s.jsx)(N.Z,{xs:2,md:1,title:"Obrigat\xf3rio",index:o,name:"blocks.[".concat(t,"].itens.[").concat(o,"].obrigatorio"),value:F[t].itens[o].obrigatorio,register:ee}),(0,s.jsx)(_.Z,{xs:2,md:1,title:0==o?"Remover":"",index:t,removeItem:er,item:e,pending:e.hasPending,textSuccess:"Remover este item",textError:"Este item n\xe3o pode mais ser removido pois j\xe1 foi respondido em um formul\xe1rio"})]},o)}),A&&W&&(0,s.jsx)(S.Z,{openModal:A,setOpenModalConfirmScore:L,itemScore:W,setItemScore:T}),(0,s.jsx)(u.ZP,{container:!0,spacing:4,sx:{mt:4},children:(0,s.jsxs)(u.ZP,{item:!0,xs:12,md:12,children:[(0,s.jsx)(h.Z,{variant:"outlined",color:"primary",startIcon:(0,s.jsx)(P.Z,{icon:"material-symbols:add-circle-outline-rounded"}),onClick(){el(t)},children:"Inserir Item"}),(0,s.jsx)(h.Z,{variant:"outlined",color:"error",startIcon:(0,s.jsx)(P.Z,{icon:"tabler:trash-filled"}),onClick(){ed(e,t)},sx:{ml:2},children:"Remover Bloco"})]})})]})},t)}),(0,s.jsx)(u.ZP,{item:!0,xs:12,md:12,sx:{mt:4},children:(0,s.jsx)(h.Z,{variant:"outlined",color:"primary",startIcon:(0,s.jsx)(P.Z,{icon:"material-symbols:add-circle-outline-rounded"}),onClick(){ec()},children:"Inserir Bloco"})}),M&&(0,s.jsx)(c.Z,{md:12,sx:{mt:4},children:(0,s.jsx)(m.Z,{children:(0,s.jsx)(u.ZP,{container:!0,spacing:4,children:(0,s.jsx)(C.Z,{xs:12,md:12,title:"Orienta\xe7\xf5es",name:"orientations.obs",required:!1,value:null==M?void 0:M.obs,multiline:!0,rows:4,control:es})})})})]}):(0,s.jsx)(k.Z,{})})},D=()=>{let[e,t]=(0,i.useState)(null),o=(0,p.useRouter)(),d=o.pathname,{setTitle:c}=(0,i.useContext)(l.f),{id:m,setId:u}=(0,i.useContext)(r.X),{loggedUnity:x}=(0,i.useContext)(g.V);(0,i.useEffect)(()=>{let e=async()=>{await n.h.get("".concat(d,"/getList/").concat(x.unidadeID)).then(e=>{t(e.data),c({title:"Formul\xe1rios modelo de limpeza",subtitle:{id:m,count:e.data.length,new:!1}})})};e()},[m]),(0,i.useEffect)(()=>{u(null)},[]);let v=(0,b.OL)(d,[{title:"ID",field:"id",size:.2},{title:"Nome",field:"nome",size:.8}]);return(0,s.jsx)(s.Fragment,{children:e?m&&m>0?(0,s.jsx)(y,{id:m}):(0,s.jsx)(a.Z,{result:e,columns:v,btnBack:!0}):(0,s.jsx)(k.Z,{show:!0})})};var E=D}},function(e){e.O(0,[4186,1445,1111,5999,7536,2389,1289,7630,9516,9297,786,9774,2888,179],function(){return e(e.s=29295)}),_N_E=e.O()}]);