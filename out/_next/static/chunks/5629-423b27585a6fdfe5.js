"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5629],{45629:function(e,t,n){n.d(t,{Z:function(){return Y}});var a=n(85893),s=n(11163),o=n.n(s),i=n(67294),r=n(83830),c=n(66136),l=n(60664),d=n(21609),u=n(49837),m=n(91359),x=n(79072),h=n(72389),p=n(80562),g=n(55343),v=n(44731),f=n(59742),j=n(75084),Z=n(87536),y=n(86501),w=n(86887),P=n(46749),C=n(40039),D=n(50287),b=n(29308),F=n(88475),S=n(99384);let I=e=>{let{data:t,getValues:n,control:s,register:o,name:i,errors:r,removeItem:c}=e,{setDateFormat:l,dateStatus:d}=(0,S.Z)();return n("cargosFuncoes").map((e,n)=>{var i,u,m,x,h,p,g,v,f;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(D.Z,{xs:12,md:2,title:"Data",type:"date",required:!0,name:"cargosFuncoes.".concat([n],".data"),register:o,control:s,setDateFormat:l,typeValidation:"dataPassado",daysValidation:1e19,dateStatus:d,errors:null==r?void 0:null===(i=r.cargosFuncoes)||void 0===i?void 0:null===(u=i[n])||void 0===u?void 0:u.data}),(0,a.jsx)(b.Z,{xs:12,md:4,required:!0,title:"Forma\xe7\xe3o / Cargo",name:"cargosFuncoes.".concat([n],".formacaoCargo"),control:s,errors:null==r?void 0:null===(m=r.cargosFuncoes)||void 0===m?void 0:null===(x=m[n])||void 0===x?void 0:x.formacaoCargo}),(0,a.jsx)(b.Z,{xs:12,md:3,title:"Conselho",name:"cargosFuncoes.".concat([n],".conselho"),control:s,errors:null==r?void 0:null===(h=r.cargosFuncoes)||void 0===h?void 0:null===(p=h[n])||void 0===p?void 0:p.conselho}),(0,a.jsx)(D.Z,{xs:12,md:2,title:"Data Inativa\xe7\xe3o",name:"cargosFuncoes".concat([n],".dataInativacao"),type:"date",value:null==t?void 0:null===(g=t.fields)||void 0===g?void 0:g.dataNascimento,control:s,setDateFormat:l,typeValidation:"dataPassado",daysValidation:1e19,dateStatus:d,errors:null==r?void 0:null===(v=r.cargosFuncoes)||void 0===v?void 0:null===(f=v[n])||void 0===f?void 0:f.dataInativacao}),(0,a.jsx)(F.Z,{xs:4,md:1,title:"Remover",index:n,removeItem:c,item:e,textSuccess:"Remover este item",textError:"Este item n\xe3o pode mais ser removido pois possui anexo vinculado a ele"})]})})};var V=n(29630),E=n(9041),k=n(3893),N=n(82747),A=n(19604),M=n(67836),O=n(16590);let q=e=>{var t,n,s,o,r,c;let{control:u,setError:m,errors:h,data:v,register:f,watch:Z,getValues:y,setValue:w,userNewVerifyCPF:P,setUserNewVerifyCPF:C,userExistVerifyCPF:F,setUserExistVerifyCPF:I,resetFields:q,routeVeryfyCNP:z,userExistDefault:_}=e,[U,R]=(0,i.useState)(null),[J,T]=(0,i.useState)(!1),{setDateFormat:L,dateStatus:W}=(0,S.Z)(),[G,H]=(0,i.useState)({showPassword:!1,showConfirmPassword:!1}),X=()=>{H({...G,showPassword:!G.showPassword})},Y=e=>{e.preventDefault()},B=()=>{H({...G,showConfirmPassword:!G.showConfirmPassword})},K=e=>{e.preventDefault()},Q=()=>{let e=y("fields").cpf;e&&e.length<14&&(w("isUsuario",!1),q()),(0,N.sw)(e)?(m("fields.cpf",null),Z()):m("fields.cpf",{type:"manual",message:"CPF inv\xe1lido"}),Z()},$=async()=>{q();let e=y("isUsuario");if(!e){let t={cpf:y("fields").cpf};try{await l.h.post(z,t),C(!0)}catch(n){409==n.response.status?I(!0):console.log(n)}}},ee=()=>{$()};return v&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(b.Z,{md:12,title:"Nome",name:"fields.nome",required:!0,control:u,errors:null==h?void 0:null===(t=h.fields)||void 0===t?void 0:t.nome}),(0,a.jsx)(b.Z,{xs:12,md:4,title:"CPF",mask:"cpf",name:"fields.cpf",required:null!=F&&F,control:u,errors:null==h?void 0:null===(n=h.fields)||void 0===n?void 0:n.cpf,onChange:Q}),(0,a.jsx)(D.Z,{xs:12,md:4,title:"Data de Nascimento",name:"fields.dataNascimento",type:"date",required:!0,value:null==v?void 0:null===(s=v.fields)||void 0===s?void 0:s.dataNascimento,register:f,control:u,setDateFormat:L,typeValidation:"dataPassado",daysValidation:1e19,dateStatus:W,errors:null==h?void 0:null===(o=h.fields)||void 0===o?void 0:o.dataNascimento}),(0,a.jsx)(b.Z,{xs:12,md:4,title:"Email",type:"email",required:null!=F&&F,name:"fields.email",control:u,errors:null==h?void 0:null===(r=h.fields)||void 0===r?void 0:r.email,onChange:Q}),(0,a.jsx)(b.Z,{xs:12,md:P?3:4,title:"Matricula",name:"fields.matricula",control:u,errors:null==h?void 0:null===(c=h.fields)||void 0===c?void 0:c.matricula}),(0,a.jsx)(k.Z,{xs:12,md:4,onClick:ee,title:"Usu\xe1rio do sistema",name:"isUsuario",value:v.fields.usuarioID>0,register:f,disabled:!(y("fields").email&&(0,N.sw)(y("fields").cpf)),helpText:"Preencha com um CPF e email v\xe1lidos para habilitar esta fun\xe7\xe3o"}),F&&(0,a.jsx)(x.ZP,{item:!0,xs:12,children:(0,a.jsx)(A.Z,{severity:"warning",sx:{mt:2},children:(0,a.jsx)(V.Z,{variant:"body2",children:"Esse profissional j\xe1 possui acesso ao sistema. A senha n\xe3o ser\xe1 alterada!"})})}),P&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.ZP,{item:!0,xs:12,sm:3,children:(0,a.jsx)(M.Z,{fullWidth:!0,label:"Senha",id:"input-password",variant:"outlined",size:"small",type:G.showPassword?"text":"password",name:"senha",error:!!h.senha,helperText:h.senha&&h.senha.message,InputProps:{endAdornment:(0,a.jsx)(E.Z,{position:"end",children:(0,a.jsx)(p.Z,{edge:"end",onClick:X,onMouseDown:Y,children:(0,a.jsx)(d.Z,{icon:G.showPassword?"mdi:eye-outline":"mdi:eye-off-outline"})})})},...f("senha",{minLength:{value:4,message:"Senha deve ter pelo menos 4 caracteres"}})})}),(0,a.jsx)(x.ZP,{item:!0,xs:12,sm:3,children:(0,a.jsx)(M.Z,{fullWidth:!0,label:"Confirme a senha",id:"input-confirm-password",variant:"outlined",size:"small",type:G.showConfirmPassword?"text":"password",name:"confirmaSenha",error:!!h.confirmaSenha,helperText:h.confirmaSenha&&h.confirmaSenha.message,InputProps:{endAdornment:(0,a.jsx)(E.Z,{position:"end",children:(0,a.jsx)(p.Z,{edge:"end",onClick:B,onMouseDown:K,children:(0,a.jsx)(d.Z,{icon:G.showConfirmPassword?"mdi:eye-outline":"mdi:eye-off-outline"})})})},onChange(e){R(e.target.value)},...f("confirmaSenha",{validate:e=>e===Z("senha")||"As senhas n\xe3o coincidem"})})})]}),(_||P)&&(0,a.jsx)(x.ZP,{item:!0,xs:12,sm:4,children:(0,a.jsx)(g.Z,{fullWidth:!0,children:(0,a.jsx)(j.Z,{variant:"outlined",color:"primary",size:"medium",startIcon:(0,a.jsx)(d.Z,{icon:"uil:padlock"}),onClick:()=>T(!0),children:"Alterar senha"})})}),(0,a.jsx)(O.Z,{openModal:J,handleClose:()=>T(!1),setOpenModalNewPassword:T})]})};var z=n(76992),_=n(29618),U=n(47028),R=n(67569);let J=e=>{let{submenu:t,indexMenuGroup:n,indexMenu:s,indexSubmenu:o,register:i,setValue:r}=e;return(0,a.jsxs)(x.ZP,{container:!0,spacing:5,sx:{my:2},children:[(0,a.jsx)(x.ZP,{item:!0,xs:4,md:8,children:(0,a.jsx)(V.Z,{variant:"subtitle1",children:t.nome})}),(0,a.jsx)("input",{type:"hidden",value:t.rota,name:"menu[".concat(n,"].menu[").concat(s,"].submenu[").concat(o,"].rota"),...i("menu[".concat(n,"].menu[").concat(s,"].submenu[").concat(o,"].rota"))}),(0,a.jsx)(R.Z,{xs:2,md:1,name:"menu[".concat(n,"].menu[").concat(s,"].submenu[").concat(o,"].ler"),value:t.ler,register:i,setValue:r,edit:"menu[".concat(n,"].menu[").concat(s,"].submenu[").concat(o,"].edit")}),(0,a.jsx)(R.Z,{xs:2,md:1,name:"menu[".concat(n,"].menu[").concat(s,"].submenu[").concat(o,"].inserir"),value:t.inserir,register:i,setValue:r,edit:"menu[".concat(n,"].menu[").concat(s,"].submenu[").concat(o,"].edit")}),(0,a.jsx)(R.Z,{xs:2,md:1,name:"menu[".concat(n,"].menu[").concat(s,"].submenu[").concat(o,"].editar"),value:t.editar,register:i,setValue:r,edit:"menu[".concat(n,"].menu[").concat(s,"].submenu[").concat(o,"].edit")}),(0,a.jsx)(R.Z,{xs:2,md:1,name:"menu[".concat(n,"].menu[").concat(s,"].submenu[").concat(o,"].excluir"),value:t.excluir,register:i,setValue:r,edit:"menu[".concat(n,"].menu[").concat(s,"].submenu[").concat(o,"].edit")})]})},T=e=>{let{menu:t,indexMenuGroup:n,indexMenu:s,expandedItem:o,handleChangeItem:i,register:r,setValue:c}=e;return t.rota?(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(x.ZP,{container:!0,spacing:5,sx:{my:2},children:[(0,a.jsx)(x.ZP,{item:!0,xs:4,md:8,children:(0,a.jsx)(V.Z,{variant:"subtitle1",children:t.nome})}),(0,a.jsx)("input",{type:"hidden",value:t.rota,name:"menu[".concat(n,"].menu[").concat(s,"].rota"),...r("menu[".concat(n,"].menu[").concat(s,"].rota"))}),(0,a.jsx)(R.Z,{xs:2,md:1,name:"menu[".concat(n,"].menu[").concat(s,"].ler"),value:t.ler,register:r,setValue:c,edit:"menu[".concat(n,"].menu[").concat(s,"].edit")}),(0,a.jsx)(R.Z,{xs:2,md:1,name:"menu[".concat(n,"].menu[").concat(s,"].inserir"),value:t.inserir,register:r,setValue:c,edit:"menu[".concat(n,"].menu[").concat(s,"].edit")}),(0,a.jsx)(R.Z,{xs:2,md:1,name:"menu[".concat(n,"].menu[").concat(s,"].editar"),value:t.editar,register:r,setValue:c,edit:"menu[".concat(n,"].menu[").concat(s,"].edit")}),(0,a.jsx)(R.Z,{xs:2,md:1,name:"menu[".concat(n,"].menu[").concat(s,"].excluir"),value:t.excluir,register:r,setValue:c,edit:"menu[".concat(n,"].menu[").concat(s,"].edit")})]})}):(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(z.Z,{expanded:o==="item-".concat(n,"-").concat(s),onChange:i("item-".concat(n,"-").concat(s)),sx:{border:"1px solid #e0e0e0",boxShadow:"none"},children:[(0,a.jsx)(_.Z,{id:"controlled-panel-header-1","aria-controls":"controlled-panel-content-1",expandIcon:(0,a.jsx)(d.Z,{icon:"mdi:chevron-down"}),sx:{display:"flex",alignItems:"center"},children:(0,a.jsx)(V.Z,{children:t.nome})}),(0,a.jsx)(U.Z,{children:t.submenu&&t.submenu.map((e,t)=>(0,a.jsx)(J,{submenu:e,indexMenuGroup:n,indexMenu:s,indexSubmenu:t,register:r,setValue:c},t))})]})})},L=e=>{let{register:t,setValue:n,menu:s,control:o}=e,{settings:r}=(0,i.useContext)(c.J6),[l,u]=(0,i.useState)(!1),[m,h]=(0,i.useState)(!1),p=e=>(t,n)=>{h(!!n&&e)},g=r.mode;return(0,a.jsxs)(z.Z,{expanded:"panel"===l,onChange(e,t){u(!!t&&"panel")},sx:{border:"".concat("dark"===g?"1px solid #65656E":"1px solid #C5C6CD"),boxShadow:"none"},children:[(0,a.jsx)(_.Z,{id:"controlled-panel-header-1","aria-controls":"controlled-panel-content-1",expandIcon:(0,a.jsx)(d.Z,{icon:"mdi:chevron-down"}),sx:{display:"flex",alignItems:"center"},children:(0,a.jsx)(V.Z,{children:"Permiss\xf5es de Acesso"})}),(0,a.jsx)(U.Z,{children:s&&s.map((e,s)=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(x.ZP,{container:!0,spacing:4,sx:{my:2},children:[(0,a.jsx)(x.ZP,{item:!0,xs:4,md:8,children:(0,a.jsx)(V.Z,{variant:"body2",children:e.nome})}),(0,a.jsx)(x.ZP,{item:!0,xs:2,md:1,children:(0,a.jsx)(V.Z,{variant:"body2",sx:{textAlign:"center"},children:"Ler"})}),(0,a.jsx)(x.ZP,{item:!0,xs:2,md:1,children:(0,a.jsx)(V.Z,{variant:"body2",sx:{textAlign:"center"},children:"Inserir"})}),(0,a.jsx)(x.ZP,{item:!0,xs:2,md:1,children:(0,a.jsx)(V.Z,{variant:"body2",sx:{textAlign:"center"},children:"Editar"})}),(0,a.jsx)(x.ZP,{item:!0,xs:2,md:1,children:(0,a.jsx)(V.Z,{variant:"body2",sx:{textAlign:"center"},children:"Excluir"})})]}),e.menu&&e.menu.map((e,o)=>(0,a.jsx)(T,{menu:e,indexMenuGroup:s,expandedItem:m,handleChangeItem:p,indexMenu:o,register:t,setValue:n},o))]}))})]})};var W=n(45061),G=n(60565),H=n(41088);let X=e=>{let{id:t}=e,n=(0,i.useRef)(null),[s,D]=(0,i.useState)(!1),{setId:b}=(0,i.useContext)(r.X),{user:F,setUser:S,loggedUnity:V}=(0,i.useContext)(C.V),{title:E}=(0,i.useContext)(G.f),[k,N]=(0,i.useState)(null),[A,M]=(0,i.useState)(!1),[O,z]=(0,i.useState)([]),[_,U]=(0,i.useState)(null),{settings:R}=(0,i.useContext)(c.J6),J=R.mode,{startLoading:T,stopLoading:X}=(0,H.Z)(),[Y,B]=(0,i.useState)(!1),[K,Q]=(0,i.useState)(!1),[$,ee]=(0,i.useState)(!1),et=o(),en=t&&t>0?"edit":"new",ea=et.pathname,es="edit"==en?"".concat(ea,"/verifyCPF"):"".concat((0,P.g_)(ea),"/verifyCPF"),{control:eo,handleSubmit:ei,reset:er,setError:ec,setValue:el,getValues:ed,watch:eu,register:em,formState:{errors:ex}}=(0,Z.cI)({}),eh=()=>{Q(!1),B(!1),ee(!1)};console.log("errroosss",ex);let ep=async e=>{T();let n={...e,usualioLogado:F.usuarioID,fields:{...e.fields,unidadeID:V.unidadeID},removedItems:O};try{if("new"===en){let a=await l.h.post("".concat((0,P.g_)(ea),"/new/insertData"),n);et.push("".concat((0,P.g_)(ea))),b(a.data),y.ZP.success(P.OD.successNew)}else"edit"===en&&(await l.h.post("".concat(ea,"/updateData/").concat(t),n),y.ZP.success(P.OD.successUpdate));eh(),eg()}catch(s){s.response&&409===s.response.status?y.ZP.error(P.OD.errorRepeated):console.log(s)}finally{X()}},eg=async()=>{let e="new"===en?"".concat((0,P.g_)(ea),"/new/getData"):"".concat(ea,"/getData/").concat(t,"?unidadeID=").concat(V.unidadeID,"&papelID=").concat(V.papelID,"&admin=").concat(F.admin);try{let n=await l.h.post(e);er(n.data),console.log("\uD83D\uDE80 ~ response.data:",n.data),U(n.data.imagem),N(n.data)}catch(a){console.log(a)}},ev=async()=>{try{await l.h.delete("".concat(ea,"/").concat(t)),b(null),D(!1),y.ZP.success(P.OD.successDelete)}catch(e){e.response&&409===e.response.status?(y.ZP.error(P.OD.pendingDelete),D(!1)):console.log(e)}},ef=()=>{let e=new Date,t="".concat(String(e.getMonth()+1).padStart(2,"0"),"/").concat(String(e.getDate()).padStart(2,"0"),"/").concat(e.getFullYear()),n=[...ed("cargosFuncoes"),{conselho:"",data:t,dataInativacao:"",formacaoCargo:"",status:!0}];el("cargosFuncoes",n),M(!A)},ej=(e,t)=>{if(1===k.cargosFuncoes.length){y.ZP.error("\xc9 necess\xe1rio ter pelo menos um Cargo/Fun\xe7\xe3o!");return}e.id&&z([...O,e.id]);let n=ed("cargosFuncoes").filter((e,n)=>n!==t);el("cargosFuncoes",n),M(!A)},eZ=async e=>{let n=e.target.files[0];if(n){let a=new FormData;a.append("files[]",n),a.append("usuarioID",F.usuarioID);let s=n.type.includes("image");if(!s){y.ZP.error("O arquivo selecionado n\xe3o \xe9 uma imagem!");return}await l.h.post("".concat(ea,"/photo-profile/").concat(t,"/").concat(V.unidadeID,"/").concat(F.usuarioID),a).then(e=>{U(e.data),y.ZP.success("Foto atualizada com sucesso!");let t=JSON.parse(localStorage.getItem("userData"));t.imagem=e.data,localStorage.setItem("userData",JSON.stringify(t)),S(t)}).catch(e=>{var t,n,a;y.ZP.error(null!==(a=null===(t=e.response)||void 0===t?void 0:null===(n=t.data)||void 0===n?void 0:n.message)&&void 0!==a?a:"Erro ao atualizar foto de perfil, tente novamente!")})}},ey=async()=>{try{await l.h.delete("".concat(ea,"/photo-profile/").concat(t,"/").concat(V.unidadeID)),U(null),y.ZP.success("Foto removida com sucesso!")}catch(e){console.log(e),y.ZP.error("Erro ao remover foto, tente novamente!")}},ew=()=>{n.current.click()};return(0,i.useEffect)(()=>{eg()},[t]),(0,i.useEffect)(()=>{k&&k.fields.usuarioID>0&&ee(!0)},[k]),k&&(0,a.jsx)("form",{onSubmit:ei(ep),children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)(u.Z,{children:[(0,a.jsx)(w.Z,{btnCancel:!0,btnSave:!0,btnNew:!0,handleSubmit:()=>ei(ep),btnDelete:"edit"===en,onclickDelete:()=>D(!0),type:en}),(0,a.jsx)(m.Z,{children:(0,a.jsxs)(x.ZP,{container:!0,spacing:5,children:["edit"==en&&(0,a.jsx)(x.ZP,{item:!0,xs:12,md:2,children:(0,a.jsxs)(x.ZP,{item:!0,xs:12,md:12,sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"140px",position:"relative",border:"".concat("dark"===J?"1px solid #65656E":"1px solid #C5C6CD"),borderRadius:"8px"},children:[_&&(0,a.jsx)(h.Z,{title:"Apagar foto do perfil",placement:"top",children:(0,a.jsx)(p.Z,{size:"small",sx:{position:"absolute",top:"8px",right:"8px",zIndex:"20",color:"white",opacity:"0.8",backgroundColor:"#FF4D49","&:hover":{backgroundColor:"#FF4D49",opacity:"1"}},onClick:ey,children:(0,a.jsx)(d.Z,{icon:"material-symbols:delete-outline"})})}),(0,a.jsx)(h.Z,{title:_?"Alterar foto":"Inserir foto",placement:"top",children:(0,a.jsxs)(g.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",width:"100%"},children:[(0,a.jsx)("input",{type:"file",ref:n,style:{display:"none"},onChange:eZ}),(0,a.jsx)(v.Z,{variant:"rounded",alt:"Imagem do cabe\xe7alho do relat\xf3rio",sx:{width:"100%",height:"100%",cursor:"pointer"},onClick:ew,src:null!=_?_:"https://gedagro.com.br/images/report.png"})]})})]})}),(0,a.jsx)(x.ZP,{item:!0,xs:12,md:"edit"==en?10:12,children:(0,a.jsx)(x.ZP,{container:!0,spacing:5,children:(0,a.jsx)(q,{data:k,control:eo,errors:ex,register:em,watch:eu,getValues:ed,setError:ec,setValue:el,userNewVerifyCPF:K,setUserNewVerifyCPF:Q,userExistVerifyCPF:Y,setUserExistVerifyCPF:B,resetFields:eh,routeVeryfyCNP:es,userExistDefault:$})})})]})})]}),(0,a.jsxs)(u.Z,{children:[(0,a.jsx)(f.Z,{title:"Cargos / Fun\xe7\xf5es"}),(0,a.jsx)(m.Z,{children:(0,a.jsxs)(x.ZP,{container:!0,spacing:5,children:[k&&(0,a.jsx)(I,{getValues:ed,control:eo,register:em,errors:ex,removeItem:ej},A),(0,a.jsx)(j.Z,{variant:"outlined",color:"primary",sx:{mt:4,ml:4},startIcon:(0,a.jsx)(d.Z,{icon:"material-symbols:add-circle-outline-rounded"}),onClick(){ef()},children:"Inserir item"})]})})]}),($||K)&&(0,a.jsxs)(u.Z,{children:[(0,a.jsx)(f.Z,{title:"Permiss\xf5es"}),(0,a.jsx)(m.Z,{children:(0,a.jsx)(L,{menu:k.menu,control:eo,register:em,setValue:el})})]}),(0,a.jsx)(W.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+E.title,openModal:s,handleClose:()=>D(!1),handleSubmit:ev,btnCancel:!0,btnConfirm:!0})]})})};var Y=X},99384:function(e,t,n){var a=n(67294),s=n(46749);let o=()=>{let[e,t]=(0,a.useState)({}),n=(e,n,a,o)=>{let i=new Date(a),r=(0,s.HD)(e,i,o);t(e=>({...e,[n]:r}))};return{setDateFormat:n,dateStatus:e}};t.Z=o}}]);