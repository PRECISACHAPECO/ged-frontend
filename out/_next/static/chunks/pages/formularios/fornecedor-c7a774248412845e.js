(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7463],{59424:function(e,a,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/formularios/fornecedor",function(){return o(33740)}])},93250:function(e,a,o){"use strict";var t=o(85893),n=o(49837),s=o(91359),r=o(95722);let i=e=>{let{result:a,columns:o,btnNew:i=!0,btnPrint:l=!0,btnBack:d,openModal:c}=e;return(0,t.jsx)(n.Z,{children:(0,t.jsx)(s.Z,{sx:{pt:"0"},children:(0,t.jsx)(r.Z,{rows:a,columns:o,buttonsHeader:{btnNew:i,btnPrint:l,btnBack:d,openModal:c}})})})};a.Z=i},99384:function(e,a,o){"use strict";var t=o(67294),n=o(46749);let s=()=>{let[e,a]=(0,t.useState)({}),o=(e,o,t,s)=>{let r=new Date(t),i=(0,n.HD)(e,r,s);a(e=>({...e,[o]:i}))};return{setDateFormat:o,dateStatus:e}};a.Z=s},33740:function(e,a,o){"use strict";o.r(a),o.d(a,{default:function(){return W}});var t=o(85893),n=o(67294),s=o(60664),r=o(93250),i=o(87536),l=o(56531),d=o(99734),c=o(34282),u=o(29308),m=o(23895),p=o(19604),x=o(30120),f=o(49837),h=o(91359),v=o(29630),g=o(79072),D=o(55343),I=o(11163),b=o.n(I),j=o(46749),Z=o(86887),y=o(83830),C=o(40039),S=o(39976),w=o(47842),F=o(86501),E=o(66136),P=o(80377),N=o(22416),A=o(22841),k=o(16056);let z=e=>{let{xs:a,md:o,title:n,index:s,name:r,typePage:i,value:l,disabled:d,register:c,...u}=e;return(0,t.jsx)(g.ZP,{item:!0,xs:a,md:o,children:(0,t.jsx)(x.Z,{display:"flex",flexDirection:"column",alignItems:"start",children:(0,t.jsx)(A.Z,{control:(0,t.jsx)(k.Z,{...u,name:r,...c(r),defaultChecked:l,disabled:d,onChange(e){u.onChange&&u.onChange(e.target.checked,s,r,i)}}),label:n,size:"small",sx:{"&:hover":{"& .MuiFormControlLabel-label":{color:"primary.main"}}}})})})},H=e=>{let{data:a,control:o,setValue:s,register:r,errors:i}=e,[l,d]=(0,n.useState)(!0);return s("emailDestinatario",a.email),(0,t.jsxs)("div",{className:"flex flex-col gap-2 pt-2",children:[l&&(0,t.jsx)(u.Z,{name:"emailDestinatario",type:"email",title:"E-mail do destinat\xe1rio",required:!0,control:o,errors:i.emailDestinatario}),(0,t.jsx)(u.Z,{name:"assunto",title:"Assunto",required:!0,register:r,control:o,defaultValue:"",errors:i.assunto}),(0,t.jsx)(u.Z,{name:"descricao",title:"Descri\xe7\xe3o",multiline:!0,rows:4,required:!0,control:o,defaultValue:"",errors:i.descricao}),(0,t.jsxs)(N.Z,{row:!0,children:[(0,t.jsx)(z,{name:"email",title:"E-mail",value:!0,register:r,onChange:()=>d(!l)}),(0,t.jsx)(z,{name:"alerta",title:"Alerta",value:!0,register:r})]})]})};var M=o(69418),O=o(44373);o(80587);var _=o(92945);let B=e=>{let{values:a,handleFileSelect:o,handleRemove:s,loadingFile:r,disabled:i,errors:l}=e,{settings:d}=(0,n.useContext)(E.J6),c=d.mode,[u,m]=(0,n.useState)(null),p=(0,n.useRef)(null),f=e=>{p.current.click(),m(e)};return(0,n.useEffect)(()=>{p.current&&(p.current.value="")},[o]),(0,t.jsx)("div",{className:"flex flex-col gap-2",children:a&&a.map((e,n)=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.ZP,{container:!0,spacing:2,children:(0,t.jsx)(g.ZP,{item:!0,xs:12,sm:6,children:(0,t.jsxs)(x.Z,{display:"flex",alignItems:"center",sx:{gap:1},children:[(0,t.jsx)(v.Z,{color:"primary",variant:"subtitle1",sx:{fontWeight:700},children:e.nome}),(0,t.jsx)(v.Z,{variant:"body2",children:"(".concat(e.unidadeMedida,")")})]})})},n),e.produtoAnexosDescricao&&e.produtoAnexosDescricao.length>0&&(0,t.jsx)(g.ZP,{container:!0,spacing:4,children:e.produtoAnexosDescricao.map((e,a)=>(0,t.jsx)(_.Z,{modeTheme:c,handleFileClick:f,selectedItem:u,inputRef:p,item:e,loadingFile:r,indexBlock:n,indexItem:a,handleFileSelect:o,folder:"produto",handleRemove:s,error:l,disabled:i},"".concat(n,"-").concat(a)))}),e.anexos&&0===e.anexos.length&&(0,t.jsx)(v.Z,{variant:"body2",sx:{mb:2},children:"Este produto n\xe3o exige anexos"}),n<a.length-1&&(0,t.jsx)(O.Z,{sx:{my:4}})]}))})};var R=o(50287),V=o(99384);let G=e=>{var a,o,r,i,d;let{modeloID:c,values:m,fields:p,disabled:x,register:f,errors:h,setValue:v,control:D,getAddressByCep:I}=e,[b,j]=(0,n.useState)([]),{setDateFormat:Z,dateStatus:y}=(0,V.Z)(),C=async()=>{let e=await s.h.post("/cadastros/profissional/getProfissionaisAssinatura",{formularioID:1,modeloID:c});j(e.data.preenche)};return(0,n.useEffect)(()=>{C()},[]),(0,t.jsxs)(g.ZP,{container:!0,spacing:4,children:[(0,t.jsx)(R.Z,{xs:12,md:2,title:"Data da avalia\xe7\xe3o",name:"fieldsHeader.data",type:"date",value:null==m?void 0:m.data,disabled:x,register:f,control:D,setDateFormat:Z,typeValidation:"dataPassado",daysValidation:365,dateStatus:y,errors:null==h?void 0:null===(a=h.fieldsHeader)||void 0===a?void 0:a.data}),(0,t.jsx)(u.Z,{xs:12,md:2,title:"Hora da avalia\xe7\xe3o",name:"fieldsHeader.hora",type:"time",disabled:x,register:f,control:D,errors:null==h?void 0:null===(o=h.fieldsHeader)||void 0===o?void 0:o.hora}),(0,t.jsx)(u.Z,{xs:12,md:4,title:"CNPJ",name:"fieldsHeader.cnpj",type:"string",mask:"cnpj",disabled:x,register:f,control:D,errors:null==h?void 0:null===(r=h.fieldsHeader)||void 0===r?void 0:r.cnpj}),(0,t.jsx)(u.Z,{xs:12,md:4,title:"Raz\xe3o Social",name:"fieldsHeader.razaoSocial",type:"string",disabled:x,register:f,control:D,errors:null==h?void 0:null===(i=h.fieldsHeader)||void 0===i?void 0:i.razaoSocial}),(0,t.jsx)(u.Z,{xs:12,md:4,title:"Nome Fantasia",name:"fieldsHeader.nomeFantasia",type:"string",disabled:x,register:f,control:D,errors:null==h?void 0:null===(d=h.fieldsHeader)||void 0===d?void 0:d.nomeFantasia}),(0,t.jsx)(l.Z,{register:f,errors:h,setValue:v,control:D,fields:p,values:p,getAddressByCep:I,disabled:x})]})};o(84220);var L=o(41088);let T=e=>{var a,o;let r;let{id:l,makeFornecedor:I}=e,{menu:N,user:A,loggedUnity:k}=(0,n.useContext)(C.V);console.log("\uD83D\uDE80 ~ loggedUnitysssssssssssssssssssss:",k);let[z,O]=(0,n.useState)(!1),[_,R]=(0,n.useState)(!1),[V,T]=(0,n.useState)(!1),[q,X]=(0,n.useState)(!1),[J,U]=(0,n.useState)(!1),[W,K]=(0,n.useState)(!1),[Q,Y]=(0,n.useState)(!0),[$,ee]=(0,n.useState)(!0),[ea,eo]=(0,n.useState)(null),[et,en]=(0,n.useState)([]),[es,er]=(0,n.useState)([]),[ei,el]=(0,n.useState)(null),{createNewNotification:ed}=(0,n.useContext)(S.u),[ec,eu]=(0,n.useState)(!1),[em,ep]=(0,n.useState)([]),[ex,ef]=(0,n.useState)([]),[eh,ev]=(0,n.useState)([]),[eg,eD]=(0,n.useState)(null),[eI,eb]=(0,n.useState)([]),[ej,eZ]=(0,n.useState)(null),[ey,eC]=(0,n.useState)(""),[eS,ew]=(0,n.useState)(!1),[eF,eE]=(0,n.useState)(!1),[eP,eN]=(0,n.useState)({status:!1,errors:[]}),{settings:eA}=(0,n.useContext)(E.J6),{setId:ek}=(0,n.useContext)(y.X),[ez,eH]=(0,n.useState)([]),[eM,eO]=(0,n.useState)({status:!1,message:"Voc\xea n\xe3o tem permiss\xf5es",messageType:"info"}),e_=b(),eB=l&&l>0?"edit":"new",eR=e_.pathname;console.log("\uD83D\uDE80 ~ staticUrl:",eR);let{startLoading:eV,stopLoading:eG}=(0,L.Z)(),{reset:eL,register:eT,getValues:eq,setValue:eX,control:eJ,watch:eU,handleSubmit:eW,clearErrors:eK,setError:eQ,formState:{errors:eY}}=(0,i.cI)();console.log("formFornecedor errors: ",eY);let e$=async(e,a)=>{let o={status:e,observacao:a,auth:{usuarioID:A.usuarioID,papelID:A.papelID,unidadeID:k.unidadeID}};try{U(!0),await s.h.post("".concat(eR,"/changeFormStatus/").concat(l),o).then(a=>{F.ZP.success(j.OD.successUpdate),U(!1),as(e,null,null)})}catch(t){console.log(t)}},e0=async e=>{try{if(!e.email&&!e.alerta)return F.ZP.error("Selecione ao menos um tipo de notifica\xe7\xe3o!");let a={titulo:e.assunto,descricao:e.descricao,url:"/formularios/fornecedor/",urlID:l,tipoNotificacaoID:3,usuarioGeradorID:A.usuarioID,usuarioID:0,unidadeID:ea.fornecedor.unidadeID,papelID:2,email:e.email,alerta:e.alerta};if(console.log("\uD83D\uDE80 ~ data dat notifica\xe7\xe3o:",a),ed(a),e.email){let o={values:e,auth:{id:l,usuarioID:A.usuarioID,papelID:A.papelID,unidadeID:k.unidadeID}};await s.h.post("".concat(eR,"/sendNotification"),o)}let t=e.alerta&&e.email?"E-mail e alerta enviados com sucesso!":e.alerta&&!e.email?"Alerta criado com sucesso!":!e.alerta&&e.email?"E-mail enviado com sucesso!":null;F.ZP.success(t)}catch(n){console.log(n)}},e1=()=>{navigator.clipboard.writeText(eg),F.ZP.success("Link copiado com sucesso!")},e2=()=>{ek(ea.parFornecedorModeloID),e_.push("/configuracoes/formularios/fornecedor/")},e3={id:1,name:"Gerar novo formul\xe1rio",description:"Gerar um novo formul\xe1rio de preenchimento para este fornecedor.",component:(0,t.jsx)(M.Z,{cnpj:null==ea?void 0:null===(a=ea.fornecedor)||void 0===a?void 0:a.cnpj}),route:null,type:null,modal:!0,action:I,size:"lg",icon:"fluent:form-new-20-regular",identification:null},e4={id:2,name:"Gerar notifica\xe7\xe3o",description:"Gerar uma nova notifica\xe7\xe3o para o fornecedor, podendo ser um e-mail e/ou alerta do sistema.",component:(0,t.jsx)(H,{data:{email:null===(o=eh.find(e=>"email"==e.nomeColuna))||void 0===o?void 0:o.email}}),route:null,type:null,modal:!0,action:e0,icon:"cil:bell",identification:null},e8={id:3,name:"Copiar link do formul\xe1rio",description:"Copiar o link deste formul\xe1rio.",component:(0,t.jsx)(M.Z,{}),route:null,type:null,action:e1,modal:!1,icon:"solar:copy-outline",identification:null},e7={id:4,name:"Formul\xe1rio do fornecedor",type:"report",papelID:A.papelID,fornecedorID:l,unidadeID:k.unidadeID,icon:"fluent:print-24-regular"},e9=[];1==A.papelID&&e9.push(e3),e9.push(e4),e9.push(e8),e9.push(e7),1==A.papelID&&(r=!1,N.map(e=>{e.menu.map(e=>{e.submenu&&e.submenu.length>0&&e.submenu.map(e=>{"/configuracoes/formularios"==e.rota&&(r=!0)})})}),r)&&e9.push({id:5,name:"Configura\xe7\xf5es do formul\xe1rio",description:"Alterar as configura\xe7\xf5es do modelo de formul\xe1rio.",route:null,type:null,action:e2,modal:!1,icon:"bi:gear",identification:null});let e5=async()=>{try{await s.h.post("".concat(eR,"/verifyFormPending/").concat(l),{parFormularioID:1}).then(e=>{Y(e.data) //! true/false
})}catch(e){console.log(e)}},e6=()=>{O(!0);try{s.h.post("".concat(eR,"/getData/").concat(l),{type:eB,unidadeID:k.unidadeID}).then(e=>{var a,o,t;console.log("getData: ",e.data),O(!1),ep(e.data.fieldsHeader),ef(e.data.fieldsFooter),ev(e.data.fields),en(e.data.produtos),eb(e.data.blocos),er(e.data.grupoAnexo),eC(e.data.info),eo(e.data.unidade),eD(e.data.link),eZ(e.data.ultimaMovimentacao),at(e.data.blocos),eL(e.data);let n=[];for(let s=0;s<e.data.fields.length;s++){let r=e.data.fields[s].nomeColuna,i=e.data.fields[s].nomeCampo;for(let l in k){if("telefone"==r){let d=null!==(t=k.telefone1)&&void 0!==t?t:k.telefone2;eX("fields[".concat(s,"].").concat(r),null!=d?d:"")}l!==r||eq("fields[".concat(s,"].").concat(r),k[l])||(eX("fields[".concat(s,"].").concat(r),k[l]),null!==k[l]&&""!==k[l]&&n.push({name:i,value:k[l]}))}}eH(n);let c=j.WR[null==e?void 0:null===(a=e.data)||void 0===a?void 0:null===(o=a.info)||void 0===o?void 0:o.status];el(c),eO({status:2==A.papelID&&e.data.info.status<40,message:2==A.papelID&&e.data.info.status>=40?"Esse formul\xe1rio j\xe1 foi conclu\xeddo e enviado pra f\xe1brica, n\xe3o \xe9 mais poss\xedvel alterar as informa\xe7\xf5es!":1==A.papelID&&e.data.info.status<40?"Somente o fornecedor pode alterar as informa\xe7\xf5es deste formul\xe1rio!":1==A.papelID&&40==e.data.info.status?"Este formul\xe1rio est\xe1 aguardando aprova\xe7\xe3o":null,messageType:2==A.papelID?"warning":"info"}),e5()}).catch(e=>{console.log("\uD83D\uDE80 ~ error:",e),O(!1)})}catch(e){console.log("\uD83D\uDE80 ~ error:",e),O(!1)}},ae=()=>{eK();let e=!1,a=[];null==eh||eh.forEach((o,t)=>{let n=o.tabela?"fields[".concat(t,"].").concat(o.tabela):"fields[".concat(t,"].").concat(o.nomeColuna),s=eq(n);1!==o.obrigatorio||s||(eQ(n,{type:"manual",message:"Campo obrigat\xf3rio"}),a.push(null==o?void 0:o.nomeCampo),e=!0)}),et&&et.length>0&&et.forEach((o,t)=>{o.produtoAnexosDescricao.forEach((n,s)=>{1===n.obrigatorio&&0==n.anexos.length&&(eQ("produtos[".concat(t,"].produtoAnexosDescricao[").concat(s,"].anexos"),{type:"manual",message:"Campo obrigat\xf3rio"}),a.push("Anexo: ".concat(null==o?void 0:o.nome," / ").concat(null==n?void 0:n.nome)),e=!0)})}),eI.forEach((o,t)=>{o.itens.forEach((o,n)=>{let s=eq("blocos[".concat(t,"].itens[").concat(n,"].resposta"));(null==o?void 0:o.obrigatorio)!==1||s||(eQ("blocos[".concat(t,"].itens[").concat(n,"].resposta"),{type:"manual",message:"Campo obrigat\xe1rio"}),a.push(null==o?void 0:o.nome),e=!0),o.respostaConfig&&1==o.respostaConfig.anexo&&o.respostaConfig.anexosSolicitados.length>0&&o.respostaConfig.anexosSolicitados.forEach((s,r)=>{1==s.obrigatorio&&s.anexos&&0==s.anexos.length&&(eQ("blocos[".concat(t,"].itens[").concat(n,"].respostaConfig.anexosSolicitados[").concat(r,"].anexos"),{type:"manual",message:"Campo obrigat\xe1rio"}),a.push("Anexo: ".concat(null==o?void 0:o.nome," / ").concat(null==s?void 0:s.nome)),e=!0)})})}),es&&es.length>0&&es.forEach((o,t)=>{o.itens.forEach((n,s)=>{1===n.obrigatorio&&0==n.anexos.length&&(eQ("grupoAnexo[".concat(t,"].itens[").concat(s,"].anexos"),{type:"manual",message:"Campo obrigat\xe1rio"}),a.push("Anexo: ".concat(null==o?void 0:o.nome," / ").concat(null==n?void 0:n.nome)),e=!0)})}),eN({status:e,errors:a})},aa=async e=>{if(9===e.length){let a=e.replace(/[^0-9]/g,"");try{let o=await s.h.get("https://viacep.com.br/ws/".concat(a,"/json/"));o.data.localidade?(eh.forEach(async(e,a)=>{("logradouro"===e.nomeColuna||"bairro"===e.nomeColuna||"cidade"===e.nomeColuna||"estado"===e.nomeColuna)&&(await eX("fields[".concat(a,"].logradouro"),o.data.logradouro),await eX("fields[".concat(a,"].bairro"),o.data.bairro),await eX("fields[".concat(a,"].cidade"),o.data.localidade),await eX("fields[".concat(a,"].estado"),o.data.uf))}),F.ZP.success("Endere\xe7o encontrado!")):F.ZP.error("Endere\xe7o n\xe3o encontrado!")}catch(t){console.error(t)}}},ao=()=>{ae(),ew(!0),K(!0)},at=e=>{let a=!0;e.forEach(e=>{e.itens.forEach(e=>{e.respostaConfig&&1==e.respostaConfig.bloqueiaFormulario&&(a=!1)})}),ee(a)},an=async e=>{e.conclusion=!0,await eW(ar)(e)},as=(e,a,o)=>{let t=30==e?"Em preenchimento":40==e?"Conclu\xeddo":50==e?"Reprovado":60==e?"Aprovado parcialmente":70==e?"Aprovado":"Pendente",n={titulo:"Formul\xe1rio de Fornecedor ".concat(t),descricao:"O formul\xe1rio de Fornecedor #".concat(l," est\xe1 ").concat(t,"."),url:"/formularios/fornecedor/",urlID:l,tipoNotificacaoID:6,usuarioGeradorID:A.usuarioID,usuarioID:0,unidadeID:k.unidadeID,papelID:1};if(n&&(ed(n),a)){let s={titulo:"Fornecedor gerado",descricao:"O formul\xe1rio de Fornecedor #".concat(l," est\xe1 ").concat(t," e gerou uma n\xe3o conformidade."),url:"/formularios/fornecedor/nao-conformidade/",urlID:o,tipoNotificacaoID:5,usuarioGeradorID:A.usuarioID,usuarioID:0,unidadeID:k.unidadeID,papelID:1};ed(s)}};console.log("\uD83D\uDE80 ~ isLoadingaaaaaaaaaaaaaaaaaaa:",z);let ar=async function(e){let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];eV(),console.log("fun\xe7\xe3o ativada inicio"),!0===a.conclusion&&(e.status=A&&1==A.papelID?a.status:40,e.obsConclusao=a.obsConclusao);let o={form:e,auth:{usuarioID:A.usuarioID,papelID:A.papelID,unidadeID:k.unidadeID}};try{"edit"==eB?(U(!0),await s.h.post("".concat(eR,"/updateData/").concat(l),o).then(a=>{F.ZP.success(j.OD.successUpdate),U(!1);let o=null;a.data&&a.data.naoConformidade&&a.data.id>0&&(e_.push("/formularios/fornecedor/nao-conformidade/"),ek(a.data.id),o=a.data.id),as(e.status,e.naoConformidade,o)})):"new"==eB?await s.h.post("".concat((0,j.g_)(eR),"/insertData"),o).then(e=>{e_.push("".concat((0,j.g_)(eR))),ek(e.data),F.ZP.success(j.OD.successNew)}):F.ZP.error(j.OD.error)}catch(t){console.log(t)}finally{eG(),console.log("fun\xe7\xe3o ativada fim finally")}},ai=async(e,a)=>{T(!0);let o=e.target.files;if(o&&o.length>0){var t;let n=new FormData;for(let r=0;r<o.length;r++)n.append("files[]",o[r]);n.append("usuarioID",A.usuarioID),n.append("unidadeID",k.unidadeID),n.append("produtoAnexoID",null!==(t=a.produtoAnexoID)&&void 0!==t?t:null),await s.h.post("".concat(eR,"/saveAnexo/").concat(l,"/produto/").concat(A.usuarioID,"/").concat(ea.unidadeID),n).then(e=>{T(!1);let a=eq();ar(a)}).catch(e=>{var a,o,t;T(!1),F.ZP.error(null!==(t=null===(a=e.response)||void 0===a?void 0:null===(o=a.data)||void 0===o?void 0:o.message)&&void 0!==t?t:"Erro ao atualizar anexo, tente novamente!")})}},al=async(e,a)=>{R(!0);let o=e.target.files;if(o&&o.length>0){var t;let n=new FormData;for(let r=0;r<o.length;r++)n.append("files[]",o[r]);n.append("usuarioID",A.usuarioID),n.append("unidadeID",k.unidadeID),n.append("grupoAnexoItemID",null!==(t=a.grupoAnexoItemID)&&void 0!==t?t:null),await s.h.post("".concat(eR,"/saveAnexo/").concat(l,"/grupo-anexo/").concat(A.usuarioID,"/").concat(ea.unidadeID),n).then(e=>{R(!1);let a=eq();ar(a)}).catch(e=>{var a,o,t;R(!1),F.ZP.error(null!==(t=null===(a=e.response)||void 0===a?void 0:null===(o=a.data)||void 0===o?void 0:o.message)&&void 0!==t?t:"Erro ao atualizar anexo, tente novamente!")})}},ad=async(e,a)=>{X(!0);let o=e.target.files;if(o&&o.length>0){var t,n;let r=new FormData;for(let i=0;i<o.length;i++)r.append("files[]",o[i]);r.append("usuarioID",A.usuarioID),r.append("unidadeID",k.unidadeID),r.append("parFornecedorModeloBlocoID",null!==(t=a.parFornecedorModeloBlocoID)&&void 0!==t?t:null),r.append("itemOpcaoAnexoID",null!==(n=a.itemOpcaoAnexoID)&&void 0!==n?n:null),await s.h.post("".concat(eR,"/saveAnexo/").concat(l,"/item/").concat(A.usuarioID,"/").concat(ea.unidadeID),r).then(e=>{X(!1);let a=eq();ar(a)}).catch(e=>{var a,o,t;X(!1),F.ZP.error(null!==(t=null===(a=e.response)||void 0===a?void 0:null===(o=a.data)||void 0===o?void 0:o.message)&&void 0!==t?t:"Erro ao atualizar anexo, tente novamente!!!!")})}},ac=async e=>{try{let a=await s.h.post("/cadastros/item/getItemConfigs",{itemID:e.itemID,alternativaItemID:e.alternativa.id}),o=eI.map(o=>({...o,itens:o.itens.map(o=>o.itemID==e.itemID?{...o,respostaConfig:{...a.data}}:o)}));eb(o)}catch(t){console.log("error",t)}},au=async e=>{e&&await s.h.delete("".concat(eR,"/deleteAnexo/").concat(l,"/").concat(e.anexoID,"/").concat(ea.unidadeID,"/").concat(A.usuarioID,"/produto")).then(e=>{let a=eq();ar(a)}).catch(e=>{var a,o,t;F.ZP.error(null!==(t=null===(a=e.response)||void 0===a?void 0:null===(o=a.data)||void 0===o?void 0:o.message)&&void 0!==t?t:"Erro ao remover anexo, tente novamente!")})},am=async e=>{e&&await s.h.delete("".concat(eR,"/deleteAnexo/").concat(l,"/").concat(e.anexoID,"/").concat(ea.unidadeID,"/").concat(A.usuarioID,"/grupo-anexo")).then(e=>{let a=eq();ar(a)}).catch(e=>{var a,o,t;F.ZP.error(null!==(t=null===(a=e.response)||void 0===a?void 0:null===(o=a.data)||void 0===o?void 0:o.message)&&void 0!==t?t:"Erro ao remover anexo, tente novamente!")})},ap=async e=>{e&&await s.h.delete("".concat(eR,"/deleteAnexo/").concat(l,"/").concat(e.anexoID,"/").concat(ea.unidadeID,"/").concat(A.usuarioID,"/item")).then(e=>{let a=eq();ar(a)}).catch(e=>{var a,o,t;F.ZP.error(null!==(t=null===(a=e.response)||void 0===a?void 0:null===(o=a.data)||void 0===o?void 0:o.message)&&void 0!==t?t:"Erro ao remover anexo, tente novamente!")})};return(0,n.useEffect)(()=>{"edit"==eB&&e6()},[l,J]),(0,n.useEffect)(()=>{ae()},[]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(w.Z,{show:z}),(0,t.jsxs)("form",{onSubmit:eW(ar),children:[ez&&ez.length>0&&(0,t.jsxs)(p.Z,{severity:"info",sx:{mb:2,mr:4},children:[(0,t.jsxs)("h1",{children:["Os seguintes campos foram copiados de ",(0,t.jsx)("strong",{children:"Meus Dados"}),":"]}),(0,t.jsx)("div",{className:"pt-2",children:ez.map(e=>(0,t.jsx)("div",{className:"flex opacity-80",children:(0,t.jsx)("p",{children:"- ".concat(e.name," (").concat(e.value,")")})}))})]}),(0,t.jsxs)(x.Z,{display:"flex",flexDirection:"column",sx:{gap:4},children:[eM.message&&(0,t.jsx)(p.Z,{severity:"warning",children:eM.message}),ej&&(0,t.jsxs)(p.Z,{severity:"info",children:["\xdaltima movimenta\xe7\xe3o: Profissional ".concat(ej.nome," do(a) ").concat(ej.nomeFantasia," movimentou o formul\xe1rio de ").concat(ej.statusAnterior," para ").concat(ej.statusAtual," em ").concat(ej.dataHora,"."),ej.observacao&&(0,t.jsxs)("p",{children:[(0,t.jsx)("br",{}),'Mensagem: "',ej.observacao,'"']})]}),ey&&""!=ey.cabecalhoModelo&&(0,t.jsx)(f.Z,{children:(0,t.jsx)(h.Z,{children:(0,t.jsx)(v.Z,{variant:"subtitle1",sx:{mb:2},children:ey.cabecalhoModelo})})}),(0,t.jsxs)(f.Z,{children:[(0,t.jsx)(Z.Z,{btnCancel:!0,btnSave:2==A.papelID&&ey.status<40,btnSend:1==A.papelID&&"edit"==eB&&ey.status>=40||2==A.papelID&&ey.status<40,btnPrint:"edit"==eB,actionsData:e9,actions:!0,handleSubmit:()=>eW(ar),handleSend:ao,iconConclusion:"mdi:check-bold",titleConclusion:"Concluir Formul\xe1rio",title:"Fornecedor",btnStatus:"edit"==eB,handleBtnStatus:()=>eu(!0),type:eB,status:ei}),(0,t.jsx)(h.Z,{children:ea&&(0,t.jsxs)(x.Z,{display:"flex",flexDirection:"column",sx:{gap:1},children:[(0,t.jsx)(v.Z,{variant:"caption",sx:{pb:4},children:"Aberto por ".concat(em.abertoPor.profissional.nome," em ").concat(em.abertoPor.dataInicio," ").concat(em.abertoPor.horaInicio," ")}),(0,t.jsx)(G,{modeloID:ea.parFornecedorModeloID,values:em,fields:eh,disabled:!eM.status,register:eT,errors:eY,setValue:eX,control:eJ,getAddressByCep:aa})]})})]}),ea&&(null==ea?void 0:ea.obrigatorioProdutoFornecedor)&&et&&et.length>0&&(0,t.jsx)(f.Z,{children:(0,t.jsx)(h.Z,{children:(0,t.jsx)(B,{values:et,handleFileSelect:ai,handleRemove:au,loadingFile:V,disabled:!eM.status,errors:null==eY?void 0:eY.produtos},V)})}),eI&&eI.map((e,a)=>(0,t.jsx)(d.Z,{index:a,blockKey:"parFornecedorModeloBlocoID",handleFileSelect:ad,setItemResposta:ac,handleRemoveAnexoItem:ap,setBlocos:eb,values:e,control:eJ,register:eT,setValue:eX,errors:null==eY?void 0:eY.blocos,disabled:!eM.status},a)),es&&es.map((e,a)=>(0,t.jsx)(m.Z,{values:{grupo:e,loadingFile:_,indexGrupo:a,handleFileSelect:al,handleRemove:am,folder:"grupo-anexo",disabled:!eM.status,error:eY}},a)),ey&&(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(f.Z,{children:(0,t.jsx)(h.Z,{children:(0,t.jsx)(g.ZP,{container:!0,spacing:4,children:(0,t.jsx)(g.ZP,{item:!0,xs:12,md:12,children:(0,t.jsxs)(D.Z,{fullWidth:!0,children:[(0,t.jsx)(v.Z,{variant:"subtitle1",sx:{fontWeight:600,mb:2},children:"Observa\xe7\xf5es (campo de uso exclusivo da validadora)"}),(0,t.jsx)(u.Z,{title:"Observa\xe7\xe3o (opcional)",name:"info.obs",multiline:!0,rows:4,value:ey.obs,disabled:!eM.status,control:eJ})]})})})})})}),ex&&ex.concluded&&(0,t.jsx)(v.Z,{variant:"caption",children:"Conclu\xeddo por ".concat(ex.profissionalAprova.nome," em ").concat(ex.dataFim," ").concat(ex.horaFim,".")}),ec&&(0,t.jsx)(c.Z,{title:"Hist\xf3rico do Formul\xe1rio",text:"Listagem do hist\xf3rico das movimenta\xe7\xf5es do formul\xe1rio ".concat(l," do Fornecedor."),id:l,parFormularioID:1,formStatus:ey.status,hasFormPending:Q,canChangeStatus:1==A.papelID&&!Q&&ey.status>30,openModal:ec,handleClose:()=>eu(!1),btnCancel:!0,btnConfirm:!0,handleSubmit:e$}),(0,t.jsx)(P.Z,{openModal:eS,handleClose(){ew(!1),K(!1)},title:"Concluir Formul\xe1rio",text:"Deseja realmente concluir este formul\xe1rio?",info:ey,canChange:!Q,register:eT,setValue:eX,getValues:eq,btnCancel:!0,btnConfirm:!0,btnConfirmColor:"primary",conclusionForm:an,listErrors:eP,canApprove:$})]})]})]})};var q=o(60565),X=o(72819);let J=e=>{let{values:a}=e;return(0,t.jsxs)(x.Z,{display:"flex",flexDirection:"column",sx:{gap:4},children:[(0,t.jsxs)(v.Z,{variant:"body2",children:[(0,t.jsx)("strong",{children:"E-mail enviado para: "})," ",null==a?void 0:a.email]}),(0,t.jsxs)(v.Z,{variant:"body2",children:[(0,t.jsx)("strong",{children:"Link do formul\xe1rio: "})," ",null==a?void 0:a.link]})]})},U=()=>{let{user:e,loggedUnity:a}=(0,n.useContext)(C.V),[o,i]=(0,n.useState)(null),l=(0,I.useRouter)(),d=l.pathname,{setTitle:c}=(0,n.useContext)(q.f),{id:u,setId:m}=(0,n.useContext)(y.X),[p,x]=(0,n.useState)(!1),[f,h]=(0,n.useState)(!1),[v,g]=(0,n.useState)(null),D=()=>{x(!0)},b=async()=>{console.log("\uD83D\uDE80 ~ user.cnpj:",e.cnpj),await s.h.post("".concat(d,"/getList/"),{unidadeID:a.unidadeID,papelID:e.papelID,cnpj:e.cnpj?e.cnpj:null}).then(e=>{i(e.data),c({title:"Fornecedor",subtitle:{id:u,count:e.data.length,new:!1}})})},Z=async o=>{console.log("\uD83D\uDE80 ~ makeFornecedor : ",o);try{let t=await s.h.post("/formularios/fornecedor/makeFornecedor",{usuarioID:e.usuarioID,papelID:e.papelID,unidadeID:a.unidadeID,values:o.fields});200==t.status&&(F.ZP.success("E-mail enviado com sucesso"),g(t.data),m(t.data.fornecedorID),h(!0))}catch(n){console.error(n),console.error("Erro ao enviar email",n)}},S=()=>{let e=null==v?void 0:v.link;e&&(navigator.clipboard.writeText(e),F.ZP.success("Link copiado com sucesso!"))};(0,n.useEffect)(()=>{b()},[u]),(0,n.useEffect)(()=>{l.query.f&&m(l.query.f)},[l.query]);let E=1==e.papelID?[{headerName:"ID",field:"id",size:1},{headerName:"Fornecedor",field:"fornecedor",size:1},{headerName:"CNPJ",field:"cnpj",size:1},{headerName:"Data da Avalia\xe7\xe3o",field:"data",size:1,type:"date"},{headerName:"Cidade",field:"cidade",size:1},{headerName:"Respons\xe1vel",field:"responsavel",size:1},{headerName:"Status",field:{name:"status",cor:"cor"},size:1}]:2==e.papelID?[{headerName:"ID",field:"id",size:1},{headerName:"F\xe1brica",field:"fabrica",size:1},{headerName:"CNPJ",field:"cnpj",size:1},{headerName:"Data da Avalia\xe7\xe3o",field:"data",size:1,type:"date"},{headerName:"Cidade",field:"cidade",size:1},{headerName:"Respons\xe1vel",field:"responsavel",size:1},{headerName:"Status",field:{name:"status",cor:"cor"},size:1}]:[],P=(0,j.OL)(d,E);return(0,t.jsxs)(t.Fragment,{children:[o?u&&u>0?(0,t.jsx)(T,{id:u,makeFornecedor:Z}):(0,t.jsx)(r.Z,{result:o,columns:P,openModal:1==e.papelID?D:null,btnNew:1==e.papelID}):(0,t.jsx)(w.Z,{show:!0}),(0,t.jsx)(X.Z,{title:"Habilitar Fornecedor",description:"Habilitar novo preenchimento de formul\xe1rio pro fornecedor",handleConclusion:Z,setOpenModal:x,openModal:p,size:"lg",children:(0,t.jsx)(M.Z,{})}),(0,t.jsx)(X.Z,{title:"Formul\xe1rio enviado ao fornecedor",description:"Um novo formul\xe1rio de qualifica\xe7\xe3o de fornecedor foi enviado",handleCopyLink:S,setOpenModal:h,openModal:f,children:(0,t.jsx)(J,{values:v})})]})};var W=U},84242:function(e,a,o){"use strict";o.d(a,{Z:function(){return j}});var t=o(85893),n=o(30120),s=o(67836),r=o(80562),i=o(50853),l=o(11163),d=o.n(l),c=o(75084),u=o(41664),m=o.n(u),p=o(40039),x=o(67294),f=o(83830),h=o(46749),v=o(21609),g=o(41088);let D=e=>{let{btnNew:a,btnPrint:o,btnSave:n,btnBack:s,handleSave:r,hasListChange:i,openModal:l}=e,u=d(),{setId:D}=(0,x.useContext)(f.X),{routes:I}=(0,x.useContext)(p.V),{isLoading:b}=(0,g.Z)();return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between my-2 w-full",children:[(0,t.jsx)("div",{}),(0,t.jsxs)("div",{className:"flex items-center gap-4 ",children:[(0,t.jsx)("div",{children:o&&(0,t.jsxs)(c.Z,{onClick:()=>window.print(),type:"button",variant:"outlined",color:"primary",size:"medium",sx:{display:"flex",gap:2},children:[(0,t.jsx)(v.Z,{icon:"mdi:printer"}),(0,t.jsx)("span",{className:"hidden sm:block",children:"Imprimir"})]})}),(0,t.jsx)("div",{className:"",children:a&&I.find(e=>(e.rota===u.pathname||e.rota===(0,h.g_)(u.pathname))&&e.inserir)&&(0,t.jsx)(m(),{href:l?"":"".concat(u.pathname,"/novo"),children:(0,t.jsxs)(c.Z,{type:"button",variant:"outlined",color:"primary",size:"medium",onClick:l||null,sx:{display:"flex",gap:2},children:[(0,t.jsx)(v.Z,{icon:"ic:outline-plus"}),(0,t.jsx)("span",{className:"hidden sm:block",children:"Novo"})]})})}),(0,t.jsx)("div",{children:n&&(0,t.jsxs)(c.Z,{onClick:r,disabled:!i||b,type:"button",variant:"outlined",color:b?"secondary":"primary",size:"medium",sx:{display:"flex",gap:2},children:[(0,t.jsx)(v.Z,{icon:"mdi:check-bold"}),(0,t.jsx)("span",{className:"hidden sm:block",children:"Salvar"})]})})]})]})})};var I=o(61225);let b=e=>{let a=d(),{setId:o}=(0,x.useContext)(f.X);return(0,I.Z)("(min-width:640px)"),(0,t.jsxs)(n.Z,{sx:{display:"flex",flexDirection:"row",gap:2,alignItems:"center",mb:2,justifyContent:"space-between",p:e=>e.spacing(8,0,0,0)},children:[(0,t.jsxs)(n.Z,{sx:{display:"flex",gap:"8px",textAlig:"end"},children:[e.buttonsHeader.btnBack&&(0,t.jsx)(c.Z,{onClick(){a.push((0,h.g_)(a.pathname)),o(null)},type:"button",variant:"outlined",color:"primary",size:"small",children:(0,t.jsx)(v.Z,{icon:"material-symbols:arrow-back-rounded"})}),(0,t.jsx)(s.Z,{size:"medium",value:e.value,onChange:e.onChange,placeholder:"Buscarâ€¦",variant:"standard",InputProps:{startAdornment:(0,t.jsx)(n.Z,{sx:{mr:2,display:"flex"},children:(0,t.jsx)(v.Z,{icon:"mdi:magnify",fontSize:20})}),endAdornment:(0,t.jsx)(r.Z,{size:"medium",title:"Clear","aria-label":"Clear",onClick:e.clearSearch,children:(0,t.jsx)(v.Z,{icon:"mdi:close",fontSize:20})})},sx:{width:{xs:1,sm:"auto"},"& .MuiInputBase-root > svg":{mr:2}}}),(0,t.jsx)("div",{className:"hidden sm:block ",children:(0,t.jsx)(i.M,{className:"!h-full"})})]}),(0,t.jsx)(D,{btnNew:e.buttonsHeader.btnNew,btnPrint:e.buttonsHeader.btnPrint,btnBack:e.buttonsHeader.btnBack,btnSave:e.buttonsHeader.btnSave,handleSave:e.buttonsHeader.handleSave,hasListChange:e.hasChange,openModal:e.buttonsHeader.openModal})]})};var j=b},95722:function(e,a,o){"use strict";var t=o(85893),n=o(67294),s=o(92222),r=o(75680),i=o(84242),l=o(60565),d=o(83830);let c=e=>{let{rows:a,columns:o,buttonsHeader:c}=e,{handleSearch:u,pageSize:m,setPageSize:p,searchText:x,filteredData:f,setData:h,data:v}=(0,n.useContext)(l.f),{setId:g}=(0,n.useContext)(d.X);function D(e){let a=e.split("/");return"".concat(a[2],"-").concat(a[1],"-").concat(a[0])}h(a);let I=v.slice().sort((e,a)=>"Inativo"===e.status&&"Inativo"!==a.status?1:"Inativo"!==e.status&&"Inativo"===a.status?-1:0),b=e=>{let a=e.row.status;return"Inativo"===a?"inativo-row":""};return o.map(e=>{"date"===e.type&&(e.sortComparator=(e,a)=>{let o=D(e),t=D(a);return o.localeCompare(t)})}),(0,t.jsx)(s._,{localeText:r.F.components.MuiDataGrid.defaultProps.localeText,autoHeight:!0,columns:o,pageSize:m,rowsPerPageOptions:[10,20,30,40,50,100],components:{Toolbar:i.Z},rows:x?f:I,onCellClick(e,a){g(e.row.id)},onPageSizeChange:e=>p(e),getRowClassName:b,sx:{"& .MuiDataGrid-cell":{cursor:"pointer",overflow:"scroll"}},componentsProps:{toolbar:{value:x,clearSearch:()=>u(""),onChange:e=>u(e.target.value),buttonsHeader:c}}})};a.Z=c}},function(e){e.O(0,[5131,1515,6319,8934,1959,9170,9774,2888,179],function(){return e(e.s=59424)}),_N_E=e.O()}]);