"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5629],{45629:function(e,n,t){t.d(n,{Z:function(){return X}});var a=t(85893),s=t(11163),o=t.n(s),r=t(67294),i=t(83830),c=t(66136),l=t(60664),d=t(21609),u=t(49837),m=t(91359),x=t(79072),h=t(72389),p=t(80562),g=t(55343),v=t(44731),j=t(59742),f=t(75084),Z=t(87536),w=t(86501),C=t(86887),y=t(46749),P=t(40039),b=t(50287),D=t(29308),F=t(88475);let I=e=>{let{data:n,getValues:t,control:s,name:o,errors:r,removeItem:i}=e;return t("cargosFuncoes").map((e,n)=>{var t,o,c,l,d,u,m,x;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(b.Z,{xs:12,md:2,required:!0,title:"Data",value:e.data,name:"cargosFuncoes[".concat(n,"].data"),control:s,errors:null==r?void 0:null===(t=r.cargosFuncoes)||void 0===t?void 0:null===(o=t[n])||void 0===o?void 0:o.data}),(0,a.jsx)(D.Z,{xs:12,md:4,required:!0,title:"Forma\xe7\xe3o / Cargo",name:"cargosFuncoes.[".concat(n,"].formacaoCargo"),control:s,errors:null==r?void 0:null===(c=r.cargosFuncoes)||void 0===c?void 0:null===(l=c[n])||void 0===l?void 0:l.formacaoCargo}),(0,a.jsx)(D.Z,{xs:12,md:3,title:"Conselho",name:"cargosFuncoes.[".concat(n,"].conselho"),control:s,errors:null==r?void 0:null===(d=r.cargosFuncoes)||void 0===d?void 0:null===(u=d[n])||void 0===u?void 0:u.conselho}),(0,a.jsx)(b.Z,{xs:12,md:2,title:"Data Inativa\xe7\xe3o",value:e.dataInativacao,name:"cargosFuncoes[".concat(n,"].dataInativacao"),control:s,errors:null==r?void 0:null===(m=r.cargosFuncoes)||void 0===m?void 0:null===(x=m[n])||void 0===x?void 0:x.dataInativacao}),(0,a.jsx)(F.Z,{xs:4,md:1,title:"Remover",index:n,removeItem:i,item:e,textSuccess:"Remover este item",textError:"Este item n\xe3o pode mais ser removido pois possui anexo vinculado a ele"})]})})};var S=t(29630),E=t(9041),V=t(3893),k=t(82747),N=t(19604),A=t(67836),M=t(16590);let O=e=>{var n,t,s,o,i,c;let{control:u,setError:m,errors:h,data:v,register:j,watch:Z,getValues:w,setValue:C,userNewVerifyCPF:y,setUserNewVerifyCPF:P,userExistVerifyCPF:F,setUserExistVerifyCPF:I,resetFields:O,routeVeryfyCNP:q,userExistDefault:z}=e,[_,U]=(0,r.useState)(null),[R,J]=(0,r.useState)(!1),[T,L]=(0,r.useState)({showPassword:!1,showConfirmPassword:!1}),W=()=>{L({...T,showPassword:!T.showPassword})},G=e=>{e.preventDefault()},X=()=>{L({...T,showConfirmPassword:!T.showConfirmPassword})},Y=e=>{e.preventDefault()},B=()=>{let e=w("fields").cpf;e&&e.length<14&&(C("isUsuario",!1),O()),(0,k.sw)(e)?(m("fields.cpf",null),Z()):m("fields.cpf",{type:"manual",message:"CPF inv\xe1lido"}),Z()},H=async()=>{O();let e=w("isUsuario");if(!e){let n={cpf:w("fields").cpf};try{await l.h.post(q,n),P(!0)}catch(t){409==t.response.status?I(!0):console.log(t)}}},K=()=>{H()};return v&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(D.Z,{md:12,title:"Nome",name:"fields.nome",required:!0,control:u,errors:null==h?void 0:null===(n=h.fields)||void 0===n?void 0:n.nome}),(0,a.jsx)(D.Z,{xs:12,md:4,title:"CPF",mask:"cpf",name:"fields.cpf",required:null!=F&&F,control:u,errors:null==h?void 0:null===(t=h.fields)||void 0===t?void 0:t.cpf,onChange:B}),(0,a.jsx)(b.Z,{xs:12,md:4,required:!0,title:"Data de Nascimento",value:null==v?void 0:null===(s=v.fields)||void 0===s?void 0:s.dataNascimento,name:"fields.dataNascimento",control:u,errors:null==h?void 0:null===(o=h.fields)||void 0===o?void 0:o.dataNascimento}),(0,a.jsx)(D.Z,{xs:12,md:4,title:"Email",type:"email",required:null!=F&&F,name:"fields.email",control:u,errors:null==h?void 0:null===(i=h.fields)||void 0===i?void 0:i.email,onChange:B}),(0,a.jsx)(D.Z,{xs:12,md:y?3:4,title:"Matricula",name:"fields.matricula",control:u,errors:null==h?void 0:null===(c=h.fields)||void 0===c?void 0:c.matricula}),(0,a.jsx)(V.Z,{xs:12,md:4,onClick:K,title:"Usu\xe1rio do sistema",name:"isUsuario",value:v.fields.usuarioID>0,register:j,disabled:!(w("fields").email&&(0,k.sw)(w("fields").cpf)),helpText:"Preencha com um CPF e email v\xe1lidos para habilitar esta fun\xe7\xe3o"}),F&&(0,a.jsx)(x.ZP,{item:!0,xs:12,children:(0,a.jsx)(N.Z,{severity:"warning",sx:{mt:2},children:(0,a.jsx)(S.Z,{variant:"body2",children:"Esse profissional j\xe1 possui acesso ao sistema. A senha n\xe3o ser\xe1 alterada!"})})}),y&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.ZP,{item:!0,xs:12,sm:3,children:(0,a.jsx)(A.Z,{fullWidth:!0,label:"Senha",id:"input-password",variant:"outlined",size:"small",type:T.showPassword?"text":"password",name:"senha",error:!!h.senha,helperText:h.senha&&h.senha.message,InputProps:{endAdornment:(0,a.jsx)(E.Z,{position:"end",children:(0,a.jsx)(p.Z,{edge:"end",onClick:W,onMouseDown:G,children:(0,a.jsx)(d.Z,{icon:T.showPassword?"mdi:eye-outline":"mdi:eye-off-outline"})})})},...j("senha",{minLength:{value:4,message:"Senha deve ter pelo menos 4 caracteres"}})})}),(0,a.jsx)(x.ZP,{item:!0,xs:12,sm:3,children:(0,a.jsx)(A.Z,{fullWidth:!0,label:"Confirme a senha",id:"input-confirm-password",variant:"outlined",size:"small",type:T.showConfirmPassword?"text":"password",name:"confirmaSenha",error:!!h.confirmaSenha,helperText:h.confirmaSenha&&h.confirmaSenha.message,InputProps:{endAdornment:(0,a.jsx)(E.Z,{position:"end",children:(0,a.jsx)(p.Z,{edge:"end",onClick:X,onMouseDown:Y,children:(0,a.jsx)(d.Z,{icon:T.showConfirmPassword?"mdi:eye-outline":"mdi:eye-off-outline"})})})},onChange(e){U(e.target.value)},...j("confirmaSenha",{validate:e=>e===Z("senha")||"As senhas n\xe3o coincidem"})})})]}),(z||y)&&(0,a.jsx)(x.ZP,{item:!0,xs:12,sm:4,children:(0,a.jsx)(g.Z,{fullWidth:!0,children:(0,a.jsx)(f.Z,{variant:"outlined",color:"primary",size:"medium",startIcon:(0,a.jsx)(d.Z,{icon:"uil:padlock"}),onClick:()=>J(!0),children:"Alterar senha"})})}),(0,a.jsx)(M.Z,{openModal:R,handleClose:()=>J(!1),setOpenModalNewPassword:J})]})};var q=t(76992),z=t(29618),_=t(47028),U=t(67569);let R=e=>{let{submenu:n,indexMenuGroup:t,indexMenu:s,indexSubmenu:o,register:r,setValue:i}=e;return(0,a.jsxs)(x.ZP,{container:!0,spacing:5,sx:{my:2},children:[(0,a.jsx)(x.ZP,{item:!0,xs:4,md:8,children:(0,a.jsx)(S.Z,{variant:"subtitle1",children:n.nome})}),(0,a.jsx)("input",{type:"hidden",value:n.rota,name:"menu[".concat(t,"].menu[").concat(s,"].submenu[").concat(o,"].rota"),...r("menu[".concat(t,"].menu[").concat(s,"].submenu[").concat(o,"].rota"))}),(0,a.jsx)(U.Z,{xs:2,md:1,name:"menu[".concat(t,"].menu[").concat(s,"].submenu[").concat(o,"].ler"),value:n.ler,register:r,setValue:i,edit:"menu[".concat(t,"].menu[").concat(s,"].submenu[").concat(o,"].edit")}),(0,a.jsx)(U.Z,{xs:2,md:1,name:"menu[".concat(t,"].menu[").concat(s,"].submenu[").concat(o,"].inserir"),value:n.inserir,register:r,setValue:i,edit:"menu[".concat(t,"].menu[").concat(s,"].submenu[").concat(o,"].edit")}),(0,a.jsx)(U.Z,{xs:2,md:1,name:"menu[".concat(t,"].menu[").concat(s,"].submenu[").concat(o,"].editar"),value:n.editar,register:r,setValue:i,edit:"menu[".concat(t,"].menu[").concat(s,"].submenu[").concat(o,"].edit")}),(0,a.jsx)(U.Z,{xs:2,md:1,name:"menu[".concat(t,"].menu[").concat(s,"].submenu[").concat(o,"].excluir"),value:n.excluir,register:r,setValue:i,edit:"menu[".concat(t,"].menu[").concat(s,"].submenu[").concat(o,"].edit")})]})},J=e=>{let{menu:n,indexMenuGroup:t,indexMenu:s,expandedItem:o,handleChangeItem:r,register:i,setValue:c}=e;return n.rota?(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(x.ZP,{container:!0,spacing:5,sx:{my:2},children:[(0,a.jsx)(x.ZP,{item:!0,xs:4,md:8,children:(0,a.jsx)(S.Z,{variant:"subtitle1",children:n.nome})}),(0,a.jsx)("input",{type:"hidden",value:n.rota,name:"menu[".concat(t,"].menu[").concat(s,"].rota"),...i("menu[".concat(t,"].menu[").concat(s,"].rota"))}),(0,a.jsx)(U.Z,{xs:2,md:1,name:"menu[".concat(t,"].menu[").concat(s,"].ler"),value:n.ler,register:i,setValue:c,edit:"menu[".concat(t,"].menu[").concat(s,"].edit")}),(0,a.jsx)(U.Z,{xs:2,md:1,name:"menu[".concat(t,"].menu[").concat(s,"].inserir"),value:n.inserir,register:i,setValue:c,edit:"menu[".concat(t,"].menu[").concat(s,"].edit")}),(0,a.jsx)(U.Z,{xs:2,md:1,name:"menu[".concat(t,"].menu[").concat(s,"].editar"),value:n.editar,register:i,setValue:c,edit:"menu[".concat(t,"].menu[").concat(s,"].edit")}),(0,a.jsx)(U.Z,{xs:2,md:1,name:"menu[".concat(t,"].menu[").concat(s,"].excluir"),value:n.excluir,register:i,setValue:c,edit:"menu[".concat(t,"].menu[").concat(s,"].edit")})]})}):(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(q.Z,{expanded:o==="item-".concat(t,"-").concat(s),onChange:r("item-".concat(t,"-").concat(s)),sx:{border:"1px solid #e0e0e0",boxShadow:"none"},children:[(0,a.jsx)(z.Z,{id:"controlled-panel-header-1","aria-controls":"controlled-panel-content-1",expandIcon:(0,a.jsx)(d.Z,{icon:"mdi:chevron-down"}),sx:{display:"flex",alignItems:"center"},children:(0,a.jsx)(S.Z,{children:n.nome})}),(0,a.jsx)(_.Z,{children:n.submenu&&n.submenu.map((e,n)=>(0,a.jsx)(R,{submenu:e,indexMenuGroup:t,indexMenu:s,indexSubmenu:n,register:i,setValue:c},n))})]})})},T=e=>{let{register:n,setValue:t,menu:s,control:o}=e,{settings:i}=(0,r.useContext)(c.J6),[l,u]=(0,r.useState)(!1),[m,h]=(0,r.useState)(!1),p=e=>(n,t)=>{h(!!t&&e)},g=i.mode;return(0,a.jsxs)(q.Z,{expanded:"panel"===l,onChange(e,n){u(!!n&&"panel")},sx:{border:"".concat("dark"===g?"1px solid #65656E":"1px solid #C5C6CD"),boxShadow:"none"},children:[(0,a.jsx)(z.Z,{id:"controlled-panel-header-1","aria-controls":"controlled-panel-content-1",expandIcon:(0,a.jsx)(d.Z,{icon:"mdi:chevron-down"}),sx:{display:"flex",alignItems:"center"},children:(0,a.jsx)(S.Z,{children:"Permiss\xf5es de Acesso"})}),(0,a.jsx)(_.Z,{children:s&&s.map((e,s)=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(x.ZP,{container:!0,spacing:4,sx:{my:2},children:[(0,a.jsx)(x.ZP,{item:!0,xs:4,md:8,children:(0,a.jsx)(S.Z,{variant:"body2",children:e.nome})}),(0,a.jsx)(x.ZP,{item:!0,xs:2,md:1,children:(0,a.jsx)(S.Z,{variant:"body2",sx:{textAlign:"center"},children:"Ler"})}),(0,a.jsx)(x.ZP,{item:!0,xs:2,md:1,children:(0,a.jsx)(S.Z,{variant:"body2",sx:{textAlign:"center"},children:"Inserir"})}),(0,a.jsx)(x.ZP,{item:!0,xs:2,md:1,children:(0,a.jsx)(S.Z,{variant:"body2",sx:{textAlign:"center"},children:"Editar"})}),(0,a.jsx)(x.ZP,{item:!0,xs:2,md:1,children:(0,a.jsx)(S.Z,{variant:"body2",sx:{textAlign:"center"},children:"Excluir"})})]}),e.menu&&e.menu.map((e,o)=>(0,a.jsx)(J,{menu:e,indexMenuGroup:s,expandedItem:m,handleChangeItem:p,indexMenu:o,register:n,setValue:t},o))]}))})]})};var L=t(45061),W=t(60565);let G=e=>{let{id:n}=e,t=(0,r.useRef)(null),[s,b]=(0,r.useState)(!1),{setId:D}=(0,r.useContext)(i.X),{user:F,setUser:S,loggedUnity:E}=(0,r.useContext)(P.V),{title:V}=(0,r.useContext)(W.f),[k,N]=(0,r.useState)(null),[A,M]=(0,r.useState)(!1),[q,z]=(0,r.useState)([]),[_,U]=(0,r.useState)(null),{settings:R}=(0,r.useContext)(c.J6),J=R.mode,[G,X]=(0,r.useState)(!1),[Y,B]=(0,r.useState)(!1),[H,K]=(0,r.useState)(!1),Q=o(),$=n&&n>0?"edit":"new",ee=Q.pathname,en="edit"==$?"".concat(ee,"/verifyCPF"):"".concat((0,y.g_)(ee),"/verifyCPF"),{control:et,handleSubmit:ea,reset:es,setError:eo,setValue:er,getValues:ei,watch:ec,register:el,formState:{errors:ed}}=(0,Z.cI)({}),eu=()=>{B(!1),X(!1),K(!1)},em=async e=>{let t={...e,usualioLogado:F.usuarioID,fields:{...e.fields,unidadeID:E.unidadeID},removedItems:q};try{if("new"===$){let a=await l.h.post("".concat((0,y.g_)(ee),"/new/insertData"),t);Q.push("".concat((0,y.g_)(ee))),D(a.data),w.ZP.success(y.OD.successNew)}else"edit"===$&&(await l.h.post("".concat(ee,"/updateData/").concat(n),t),w.ZP.success(y.OD.successUpdate));eu(),ex()}catch(s){s.response&&409===s.response.status?w.ZP.error(y.OD.errorRepeated):console.log(s)}},ex=async()=>{let e="new"===$?"".concat((0,y.g_)(ee),"/new/getData"):"".concat(ee,"/getData/").concat(n,"?unidadeID=").concat(E.unidadeID,"&papelID=").concat(E.papelID,"&admin=").concat(F.admin);try{let t=await l.h.post(e);es(t.data),console.log("\uD83D\uDE80 ~ response.data:",t.data),U(t.data.imagem),N(t.data)}catch(a){console.log(a)}},eh=async()=>{try{await l.h.delete("".concat(ee,"/").concat(n)),D(null),b(!1),w.ZP.success(y.OD.successDelete)}catch(e){e.response&&409===e.response.status?(w.ZP.error(y.OD.pendingDelete),b(!1)):console.log(e)}},ep=()=>{let e=new Date,n="".concat(String(e.getMonth()+1).padStart(2,"0"),"/").concat(String(e.getDate()).padStart(2,"0"),"/").concat(e.getFullYear()),t=[...ei("cargosFuncoes"),{conselho:"",data:n,dataInativacao:"",formacaoCargo:"",status:!0}];er("cargosFuncoes",t),M(!A)},eg=(e,n)=>{if(1===k.cargosFuncoes.length){w.ZP.error("\xc9 necess\xe1rio ter pelo menos um Cargo/Fun\xe7\xe3o!");return}e.id&&z([...q,e.id]);let t=ei("cargosFuncoes").filter((e,t)=>t!==n);er("cargosFuncoes",t),M(!A)},ev=async e=>{let t=e.target.files[0];if(t){let a=new FormData;a.append("files[]",t),a.append("usuarioID",F.usuarioID);let s=t.type.includes("image");if(!s){w.ZP.error("O arquivo selecionado n\xe3o \xe9 uma imagem!");return}await l.h.post("".concat(ee,"/photo-profile/").concat(n,"/").concat(E.unidadeID,"/").concat(F.usuarioID),a).then(e=>{U(e.data),w.ZP.success("Foto atualizada com sucesso!");let n=JSON.parse(localStorage.getItem("userData"));n.imagem=e.data,localStorage.setItem("userData",JSON.stringify(n)),S(n)}).catch(e=>{var n,t,a;w.ZP.error(null!==(a=null===(n=e.response)||void 0===n?void 0:null===(t=n.data)||void 0===t?void 0:t.message)&&void 0!==a?a:"Erro ao atualizar foto de perfil, tente novamente!")})}},ej=async()=>{try{await l.h.delete("".concat(ee,"/photo-profile/").concat(n,"/").concat(E.unidadeID)),U(null),w.ZP.success("Foto removida com sucesso!")}catch(e){console.log(e),w.ZP.error("Erro ao remover foto, tente novamente!")}},ef=()=>{t.current.click()};return(0,r.useEffect)(()=>{ex()},[n]),(0,r.useEffect)(()=>{k&&k.fields.usuarioID>0&&K(!0)},[k]),k&&(0,a.jsx)("form",{onSubmit:ea(em),children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)(u.Z,{children:[(0,a.jsx)(C.Z,{btnCancel:!0,btnSave:!0,btnNew:!0,handleSubmit:()=>ea(em),btnDelete:"edit"===$,onclickDelete:()=>b(!0),type:$}),(0,a.jsx)(m.Z,{children:(0,a.jsxs)(x.ZP,{container:!0,spacing:5,children:["edit"==$&&(0,a.jsx)(x.ZP,{item:!0,xs:12,md:2,children:(0,a.jsxs)(x.ZP,{item:!0,xs:12,md:12,sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"140px",position:"relative",border:"".concat("dark"===J?"1px solid #65656E":"1px solid #C5C6CD"),borderRadius:"8px"},children:[_&&(0,a.jsx)(h.Z,{title:"Apagar foto do perfil",placement:"top",children:(0,a.jsx)(p.Z,{size:"small",sx:{position:"absolute",top:"8px",right:"8px",zIndex:"20",color:"white",opacity:"0.8",backgroundColor:"#FF4D49","&:hover":{backgroundColor:"#FF4D49",opacity:"1"}},onClick:ej,children:(0,a.jsx)(d.Z,{icon:"material-symbols:delete-outline"})})}),(0,a.jsx)(h.Z,{title:_?"Alterar foto":"Inserir foto",placement:"top",children:(0,a.jsxs)(g.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",width:"100%"},children:[(0,a.jsx)("input",{type:"file",ref:t,style:{display:"none"},onChange:ev}),(0,a.jsx)(v.Z,{variant:"rounded",alt:"Imagem do cabe\xe7alho do relat\xf3rio",sx:{width:"100%",height:"100%",cursor:"pointer"},onClick:ef,src:null!=_?_:"https://gedagro.com.br/images/report.png"})]})})]})}),(0,a.jsx)(x.ZP,{item:!0,xs:12,md:"edit"==$?10:12,children:(0,a.jsx)(x.ZP,{container:!0,spacing:5,children:(0,a.jsx)(O,{data:k,control:et,errors:ed,register:el,watch:ec,getValues:ei,setError:eo,setValue:er,userNewVerifyCPF:Y,setUserNewVerifyCPF:B,userExistVerifyCPF:G,setUserExistVerifyCPF:X,resetFields:eu,routeVeryfyCNP:en,userExistDefault:H})})})]})})]}),(0,a.jsxs)(u.Z,{children:[(0,a.jsx)(j.Z,{title:"Cargos / Fun\xe7\xf5es"}),(0,a.jsx)(m.Z,{children:(0,a.jsxs)(x.ZP,{container:!0,spacing:5,children:[k&&(0,a.jsx)(I,{getValues:ei,control:et,errors:ed,removeItem:eg},A),(0,a.jsx)(f.Z,{variant:"outlined",color:"primary",sx:{mt:4,ml:4},startIcon:(0,a.jsx)(d.Z,{icon:"material-symbols:add-circle-outline-rounded"}),onClick(){ep()},children:"Inserir item"})]})})]}),(H||Y)&&(0,a.jsxs)(u.Z,{children:[(0,a.jsx)(j.Z,{title:"Permiss\xf5es"}),(0,a.jsx)(m.Z,{children:(0,a.jsx)(T,{menu:k.menu,control:et,register:el,setValue:er})})]}),(0,a.jsx)(L.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+V.title,openModal:s,handleClose:()=>b(!1),handleSubmit:eh,btnCancel:!0,btnConfirm:!0})]})})};var X=G}}]);