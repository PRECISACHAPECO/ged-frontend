(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6051],{66371:function(e,o,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/configuracoes/formularios/fornecedor",function(){return t(86479)}])},86479:function(e,o,t){"use strict";t.r(o),t.d(o,{default:function(){return y}});var i=t(85893),s=t(67294),n=t(60664),l=t(93250),a=t(60565),d=t(83830),r=t(87536),c=t(49837),u=t(91359),m=t(79072),v=t(85214),x=t(29630),h=t(75084),p=t(11163),b=t.n(p),j=t(46749),Z=t(36188),g=t(40039),k=t(86501),f=t(47842),S=t(21609),I=t(1948),P=t(84220),C=t(29308),D=t(67569),N=t(3893),w=t(88475);t(53934);let E=e=>{var o,t;let{blocks:s,errors:n,control:l,register:a,getValues:d,removeItem:r,addItem:v,removeBlock:p,setValue:b,allOptions:j,openModalConfirmScore:Z,setOpenModalConfirmScore:g,itemScore:k,setItemScore:f}=e;return d("blocks")&&s&&d("blocks").map((e,d)=>{var N,E,O,_,y,B,q,F,M;return(0,i.jsx)(c.Z,{md:12,sx:{mt:4},children:(0,i.jsxs)(u.Z,{children:[(0,i.jsxs)(m.ZP,{container:!0,spacing:4,children:[(0,i.jsx)(C.Z,{className:"order-1",xs:10,md:1,title:"Sequ\xeancia",name:"blocks.[".concat(d,"].dados.ordem"),value:e.dados.ordem,required:!0,control:l,errors:null==n?void 0:null===(N=n.blocks)||void 0===N?void 0:null===(E=N[d])||void 0===E?void 0:null===(O=E.dados)||void 0===O?void 0:O.ordem}),(0,i.jsx)(C.Z,{className:"order-3 md:order-2",xs:10,md:9,title:"Nome do Bloco",name:"blocks.[".concat(d,"].dados.nome"),value:e.dados.nome,required:!0,control:l,errors:null==n?void 0:null===(_=n.blocks)||void 0===_?void 0:null===(y=_[d])||void 0===y?void 0:null===(B=y.dados)||void 0===B?void 0:B.nome}),(0,i.jsx)(D.Z,{className:"order-2 md:order-3",xs:2,md:1,title:"Ativo",name:"blocks.[".concat(d,"].dados.status"),value:null===(q=s[d])||void 0===q?void 0:null===(F=q.dados)||void 0===F?void 0:F.status,register:a}),(0,i.jsx)(D.Z,{className:"order-4 ",xs:2,md:1,title:"Observa\xe7\xe3o",name:"blocks.[".concat(d,"].dados.obs"),value:null===(M=s[d])||void 0===M?void 0:M.dados.obs,register:a})]}),(0,i.jsx)(x.Z,{variant:"subtitle1",sx:{fontWeight:600,mt:4},children:"Itens"}),e.itens&&e.itens.map((e,c)=>{var u,v,x,h,p,Z,g,k,f,S,I,N,E,O,_,y,B,q,F,M,R,V,A,L,W,T,X;return(0,i.jsxs)(m.ZP,{id:"item-".concat(d,"-").concat(c),container:!0,spacing:2,sx:{my:1},children:[(0,i.jsx)(C.Z,{xs:12,md:1,title:"Sequ\xeancia",name:"blocks.[".concat(d,"].itens.[").concat(c,"].ordem"),value:e.ordem,required:!0,control:l,errors:null==n?void 0:null===(u=n.blocks)||void 0===u?void 0:null===(v=u[d])||void 0===v?void 0:null===(x=v.itens)||void 0===x?void 0:null===(h=x[c])||void 0===h?void 0:h.ordem}),(0,i.jsx)(P.Z,{xs:12,md:5,title:(null===(Z=null===(p=s[d])||void 0===p?void 0:p.itens[c])||void 0===Z?void 0:Z.itemID)?"Item [".concat(null===(k=null===(g=s[d])||void 0===g?void 0:g.itens[c])||void 0===k?void 0:k.itemID,"]"):"Item",name:"blocks.[".concat(d,"].itens.[").concat(c,"].item"),value:null!==(o=null===(S=null===(f=s[d])||void 0===f?void 0:f.itens[c])||void 0===S?void 0:S.item)&&void 0!==o?o:null,required:!0,disabled:1==e.hasPending,options:null===(I=s[d].optionsBlock)||void 0===I?void 0:I.itens,register:a,setValue:b,control:l,errors:null==n?void 0:null===(N=n.blocks)||void 0===N?void 0:null===(E=N[d])||void 0===E?void 0:null===(O=E.itens)||void 0===O?void 0:null===(_=O[c])||void 0===_?void 0:_.item}),(0,i.jsx)(P.Z,{xs:12,md:2,title:"Alternativa",name:"blocks.[".concat(d,"].itens.[").concat(c,"].alternativa"),value:null!==(t=null===(B=null===(y=s[d])||void 0===y?void 0:y.itens[c])||void 0===B?void 0:B.alternativa)&&void 0!==t?t:null,required:!0,disabled:1==e.hasPending,options:j.alternativas,register:a,setValue:b,control:l,errors:null==n?void 0:null===(q=n.blocks)||void 0===q?void 0:null===(F=q[d])||void 0===F?void 0:null===(M=F.itens)||void 0===M?void 0:null===(R=M[c])||void 0===R?void 0:R.alternativa}),(0,i.jsx)(D.Z,{xs:2,md:1,title:"Ativo",index:c,name:"blocks.[".concat(d,"].itens.[").concat(c,"].status"),value:null===(A=null===(V=s[d])||void 0===V?void 0:V.itens[c])||void 0===A?void 0:A.status,register:a}),(0,i.jsx)(D.Z,{xs:2,md:1,title:"Obs",index:c,name:"blocks.[".concat(d,"].itens.[").concat(c,"].obs"),value:null===(W=null===(L=s[d])||void 0===L?void 0:L.itens[c])||void 0===W?void 0:W.obs,register:a}),(0,i.jsx)(D.Z,{xs:2,md:1,title:"Obrigat\xf3rio",index:c,name:"blocks.[".concat(d,"].itens.[").concat(c,"].obrigatorio"),value:null===(X=null===(T=s[d])||void 0===T?void 0:T.itens[c])||void 0===X?void 0:X.obrigatorio,register:a}),(0,i.jsx)(w.Z,{xs:2,md:1,title:0==c?"Remover":"",index:d,removeItem:()=>r(e,d,c),item:e,pending:e.hasPending,textSuccess:"Remover este item",textError:"Este item n\xe3o pode mais ser removido pois j\xe1 foi respondido em um formul\xe1rio"})]},c)}),Z&&k&&(0,i.jsx)(I.Z,{openModal:Z,setOpenModalConfirmScore:g,itemScore:k,setItemScore:f}),(0,i.jsx)(m.ZP,{container:!0,spacing:4,sx:{mt:4},children:(0,i.jsxs)(m.ZP,{item:!0,xs:12,md:12,children:[(0,i.jsx)(h.Z,{variant:"outlined",color:"primary",startIcon:(0,i.jsx)(S.Z,{icon:"material-symbols:add-circle-outline-rounded"}),onClick(){v(d)},children:"Inserir Item"}),(0,i.jsx)(h.Z,{variant:"outlined",color:"error",startIcon:(0,i.jsx)(S.Z,{icon:"tabler:trash-filled"}),onClick(){p(e,d)},sx:{ml:2},children:"Remover Bloco"})]})})]})},d)})},O=e=>{var o,t;let{id:l}=e,{user:a,loggedUnity:d}=(0,s.useContext)(g.V),[p,I]=(0,s.useState)(),[P,w]=(0,s.useState)(),[O,_]=(0,s.useState)(null),[y,B]=(0,s.useState)(),[q,F]=(0,s.useState)(),[M,R]=(0,s.useState)(!1),[V,A]=(0,s.useState)(),[L,W]=(0,s.useState)(!1),[T,X]=(0,s.useState)([]),[z,U]=(0,s.useState)([]),[G,H]=(0,s.useState)(!1),J=b(),K=J.pathname,{setValue:Q,register:Y,handleSubmit:$,reset:ee,getValues:eo,control:et,formState:{errors:ei}}=(0,r.cI)(),es=async e=>{let o={id:l,unidadeID:d.unidadeID,model:e.model,header:e.header,blocks:e.blocks,arrRemovedBlocks:z,arrRemovedItems:T,orientacoes:e.orientations};w(null);try{await n.h.put("".concat(K,"/updateData"),o).then(e=>{k.ZP.success(j.OD.successUpdate),W(!L)})}catch(t){console.log(t)}},en=(e,o,t,i)=>{let s=i.itens;s=s.filter(o=>{let t=e.itens.some(e=>e.item&&o.id===e.item.id);return!t});let n=[...t];n[o].optionsBlock.itens=s,B(n)},el=e=>{var o;let t=[...y];t[e].itens.push({ordem:(null===(o=t[e].itens)||void 0===o?void 0:o.length)+1,obs:1,status:1,obrigatorio:1}),B(t),Q("blocks.[".concat(e,"].itens.[").concat(t[e].itens.length-1,"].new"),!0),en(t[e],e,y,O)},ea=(e,o,t)=>{if(1===y[o].itens.length){k.ZP.error("Voc\xea deve ter ao menos um item!");return}let i=[...T];i.push(e),X(i);let s=[...eo("blocks")];s[o].itens.splice(t,1),Q("blocks",s),B(s),en(y[o],o,y,O),H(!G)},ed=(e,o)=>{let t=!0;if(e&&e.itens.map(e=>{1==e.hasPending&&(t=!1)}),!t){k.ZP.error("Este bloco n\xe3o pode ser removido pois possui itens respondidos em um formul\xe1rio");return}let i=[...z];i.push(e.dados.parFornecedorModeloBlocoID),U(i);let s=[...y];s.splice(o,1),B(s),Q("blocks",s),k.ZP.success("Bloco pr\xe9-removido. Salve para concluir!")},er=()=>{let e=[...eo("blocks")];e.push({dados:{ordem:e.length+1,nome:"",status:1},categorias:[],atividades:[],optionsBlock:{itens:[...O.itens],alternativas:[...O.alternativas]},itens:[{parFormularioID:1,new:!0,ordem:"1",nome:"",status:1,item:null,alternativa:null}]}),Q("blocks",e),B(e)},ec=()=>{try{n.h.post("".concat(K,"/getData"),{id:l,unidadeID:d.unidadeID}).then(e=>{var o,t;console.log("\uD83D\uDE80 ~ getData: ",e.data),I(e.data.model),w(e.data.header),B(e.data.blocks),_({itens:null===(o=e.data.options)||void 0===o?void 0:o.itens,alternativas:null===(t=e.data.options)||void 0===t?void 0:t.alternativas}),F(e.data.orientations),ee(e.data),setTimeout(()=>{e.data.blocks&&e.data.blocks.map((o,t)=>{en(o,t,e.data.blocks,e.data.options)})},3e3)})}catch(e){console.log(e)}};return(0,s.useEffect)(()=>{ec()},[l,L]),(0,i.jsx)(i.Fragment,{children:P?(0,i.jsxs)("form",{onSubmit:$(es),children:[p&&(0,i.jsxs)(c.Z,{children:[(0,i.jsx)(Z.Z,{partialRoute:!0,btnCancel:!0,btnSave:!0,handleSubmit:()=>$(es),type:"edit"}),(0,i.jsx)(u.Z,{children:(0,i.jsxs)(m.ZP,{container:!0,spacing:4,children:[(0,i.jsx)(C.Z,{className:"order-1",xs:12,md:8,title:"Modelo",name:"model.nome",value:p.nome,required:!0,control:et,errors:null==ei?void 0:null===(o=ei.model)||void 0===o?void 0:o.nome}),(0,i.jsx)(C.Z,{className:"order-1",xs:12,md:3,type:"number",title:"Ciclo (dias)",name:"model.ciclo",value:p.ciclo,required:!0,control:et,errors:null==ei?void 0:null===(t=ei.model)||void 0===t?void 0:t.ciclo,help:{text:"opaopoaspoasp opaso",position:"top",gapLeft:"10px"}}),(0,i.jsx)(D.Z,{className:"order-2 md:order-3",xs:2,md:1,title:"Ativo",name:"model.status",value:p.status,register:Y})]})})]}),P&&(0,i.jsx)(c.Z,{sx:{mt:4},children:(0,i.jsx)(u.Z,{children:(0,i.jsx)(v.Z,{component:"nav","aria-label":"main mailbox",children:(0,i.jsxs)(m.ZP,{container:!0,spacing:2,children:[(0,i.jsx)(m.ZP,{item:!0,md:4,xs:4,children:(0,i.jsx)(x.Z,{variant:"subtitle1",sx:{fontWeight:600},children:"Nome do Campo"})}),(0,i.jsx)(m.ZP,{item:!0,md:3,xs:4,children:(0,i.jsx)(x.Z,{variant:"subtitle1",sx:{fontWeight:600},children:"Mostra no Formul\xe1rio"})}),(0,i.jsx)(m.ZP,{item:!0,md:3,xs:4,children:(0,i.jsx)(x.Z,{variant:"subtitle1",sx:{fontWeight:600},children:"Obrigat\xf3rio"})}),P.map((e,o)=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(m.ZP,{item:!0,md:4,xs:6,children:e.nomeCampo}),(0,i.jsx)(m.ZP,{item:!0,md:3,xs:3,children:(0,i.jsx)(N.Z,{title:"",name:"header.[".concat(o,"].mostra"),value:e.mostra,register:Y,disabled:"cnpj"==e.nomeColuna})}),(0,i.jsx)(m.ZP,{item:!0,md:3,xs:3,children:(0,i.jsx)(N.Z,{title:"",name:"header.[".concat(o,"].obrigatorio"),value:e.obrigatorio,register:Y,disabled:"cnpj"==e.nomeColuna})})]}))]})})})}),!y&&(0,i.jsx)(f.Z,{}),y&&(0,i.jsx)(E,{blocks:y,errors:ei,control:et,register:Y,removeItem:ea,addItem:el,getValues:eo,removeBlock:ed,setValue:Q,allOptions:O,openModalConfirmScore:M,setOpenModalConfirmScore:R,itemScore:V,setItemScore:!0},G),(0,i.jsx)(m.ZP,{item:!0,xs:12,md:12,sx:{mt:4},children:(0,i.jsx)(h.Z,{variant:"outlined",color:"primary",startIcon:(0,i.jsx)(S.Z,{icon:"material-symbols:add-circle-outline-rounded"}),onClick(){er()},children:"Inserir Bloco"})}),q&&(0,i.jsx)(c.Z,{md:12,sx:{mt:4},children:(0,i.jsx)(u.Z,{children:(0,i.jsx)(m.ZP,{container:!0,spacing:4,children:(0,i.jsx)(C.Z,{xs:12,md:12,title:"Orienta\xe7\xf5es",name:"orientations.obs",required:!1,value:null==q?void 0:q.obs,multiline:!0,rows:4,control:et})})})})]}):(0,i.jsx)(f.Z,{})})},_=()=>{console.log("lista...");let[e,o]=(0,s.useState)(null),t=(0,p.useRouter)(),r=t.pathname,{setTitle:c}=(0,s.useContext)(a.f),{id:u,setId:m}=(0,s.useContext)(d.X),{loggedUnity:v}=(0,s.useContext)(g.V);(0,s.useEffect)(()=>{let e=async()=>{console.log("getList"),await n.h.get("".concat(r,"/getList/").concat(v.unidadeID)).then(e=>{o(e.data),c({title:"Formul\xe1rios de Fornecedor",subtitle:{id:u,count:e.data.length,new:!1}})})};e()},[u]),(0,s.useEffect)(()=>{m(null)},[]);let x=(0,j.OL)(r,[{title:"ID",field:"id",size:.2},{title:"Nome",field:"nome",size:.8}]);return(0,i.jsx)(i.Fragment,{children:e?u&&u>0?(0,i.jsx)(O,{id:u}):(0,i.jsx)(l.Z,{result:e,columns:x,btnBack:!0}):(0,i.jsx)(f.Z,{show:!0})})};var y=_}},function(e){e.O(0,[4186,1445,1111,5999,7536,6668,2187,7630,9516,2708,8233,9774,2888,179],function(){return e(e.s=66371)}),_N_E=e.O()}]);