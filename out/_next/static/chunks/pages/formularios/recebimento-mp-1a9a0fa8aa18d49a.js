(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2752],{18377:function(e,o,a){"use strict";var t=a(61354);let n=(0,t.Z)();o.Z=n},68374:function(e,o,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/formularios/recebimento-mp",function(){return a(69932)}])},93250:function(e,o,a){"use strict";var t=a(85893),n=a(49837),s=a(91359),r=a(95722);let i=e=>{let{result:o,columns:a,btnNew:i=!0,btnPrint:l=!0,btnBack:d,openModal:c}=e;return(0,t.jsx)(n.Z,{children:(0,t.jsx)(s.Z,{sx:{pt:"0"},children:(0,t.jsx)(r.Z,{rows:o,columns:a,buttonsHeader:{btnNew:i,btnPrint:l,btnBack:d,openModal:c}})})})};o.Z=i},69932:function(e,o,a){"use strict";a.r(o),a.d(o,{default:function(){return G}});var t=a(85893),n=a(67294),s=a(60664),r=a(93250),i=a(87536),l=a(56531),d=a(99734),c=a(34282),u=a(29308),p=a(23895),m=a(30120),x=a(19604),f=a(49837),h=a(91359),v=a(29630),g=a(79072),D=a(55343),b=a(11163),j=a.n(b),I=a(46749),Z=a(86887),y=a(83830),C=a(40039),w=a(39976),S=a(47842),F=a(86501),E=a(66136),P=a(80377);a(27304);var A=a(50287),N=a(84220),H=a(3893),k=a(18377);let M=e=>{var o,a,r,i;let{modeloID:d,values:c,fields:p,getValues:m,fornecedor:x,setFornecedor:f,disabled:h,register:v,errors:D,setValue:b,control:j,getAddressByCep:Z}=e;console.log("\uD83D\uDE80 ~~~ fornecedor:",x);let{loggedUnity:y}=(0,n.useContext)(C.V),[w,S]=(0,n.useState)({}),[F,E]=(0,n.useState)([]),[P,H]=(0,n.useState)([]),M=(e,o,a,t)=>{let n=new Date(a),s=(0,I.HD)(e,n,t);S(e=>({...e,[o]:s}))},V=async()=>{let e=await s.h.post("/cadastros/profissional/getProfissionaisAssinatura",{formularioID:2,modeloID:d});E(e.data.preenche)},R=async()=>{let e=await s.h.post("/formularios/fornecedor/getFornecedoresAprovados",{unidadeID:y.unidadeID});H(e.data)};return(0,n.useEffect)(()=>{V(),R()},[]),(0,t.jsxs)(g.ZP,{container:!0,spacing:4,children:[(0,t.jsx)(A.Z,{xs:12,md:2,title:"Data da avalia\xe7\xe3o",name:"fieldsHeader.data",type:"date",value:null==c?void 0:c.data,disabled:h,register:v,control:j,setDateFormat:M,typeValidation:"dataPassado",daysValidation:365,dateStatus:w,errors:null==D?void 0:null===(o=D.fieldsHeader)||void 0===o?void 0:o.data}),(0,t.jsx)(u.Z,{xs:12,md:2,title:"Hora da avalia\xe7\xe3o",name:"fieldsHeader.hora",type:"time",disabled:h,register:v,control:j,errors:null==D?void 0:null===(a=D.fieldsHeader)||void 0===a?void 0:a.hora}),(0,t.jsx)(N.Z,{xs:12,md:8,title:"Profissional preenchimento",name:"fieldsHeader.profissional",type:"string",options:F,value:null==c?void 0:c.profissional,disabled:h,register:v,setValue:b,control:j,errors:null==D?void 0:null===(r=D.fieldsHeader)||void 0===r?void 0:r.profissional}),(0,t.jsx)(l.Z,{register:v,errors:D,setValue:b,control:j,fields:p,values:p,getAddressByCep:Z,disabled:h}),(0,t.jsx)(N.Z,{xs:12,md:4,title:"Fornecedor",name:"fieldsHeader.fornecedor",type:"string",options:P,onChange:e=>f(e),value:null==c?void 0:c.fornecedor,disabled:h,register:v,setValue:b,control:j,errors:null==D?void 0:null===(i=D.fieldsHeader)||void 0===i?void 0:i.fornecedor}),(0,t.jsx)(g.ZP,{item:!0,xs:12,md:8,children:m("fieldsHeader.fornecedor")&&m("fieldsHeader.fornecedor.id")>0&&(0,t.jsxs)(k.Z,{display:"flex",flexDirection:"column",children:[(0,t.jsx)("p",{className:"text-xs",children:"Dados do Fornecedor"}),(0,t.jsxs)(k.Z,{display:"flex",alignItems:"center",gap:4,children:[m("fieldsHeader.fornecedor.telefone")&&(0,t.jsxs)("p",{children:["Telefone: ",m("fieldsHeader.fornecedor.telefone")]}),m("fieldsHeader.fornecedor.cidade")&&(0,t.jsxs)("p",{children:["Cidade: ",m("fieldsHeader.fornecedor.cidade")]})]})]})})]})},V=e=>{var o,a,r;let{modeloID:i,values:l,disabled:d,register:c,errors:p,setValue:m,control:x}=e,[v,D]=(0,n.useState)({}),[b,j]=(0,n.useState)([]),Z=(e,o,a,t)=>{let n=new Date(a),s=(0,I.HD)(e,n,t);D(e=>({...e,[o]:s}))},y=async()=>{let e=await s.h.post("/cadastros/profissional/getProfissionaisAssinatura",{formularioID:2,modeloID:i});console.log("\uD83D\uDE80 ~ response.data:",e.data),j(e.data.aprova)};return(0,n.useEffect)(()=>{y()},[]),(0,t.jsx)(f.Z,{children:(0,t.jsx)(h.Z,{children:(0,t.jsxs)(g.ZP,{container:!0,spacing:4,children:[(0,t.jsx)(A.Z,{xs:12,md:2,title:"Data da conclus\xe3o",name:"fieldsFooter.dataConclusao",type:"date",value:null==l?void 0:l.dataConclusao,disabled:d,register:c,control:x,setDateFormat:Z,typeValidation:"dataPassado",daysValidation:365,dateStatus:v,errors:null==p?void 0:null===(o=p.fieldsFooter)||void 0===o?void 0:o.dataConclusao}),(0,t.jsx)(u.Z,{xs:12,md:2,title:"Hora da conclus\xe3o",name:"fieldsFooter.horaConclusao",type:"time",disabled:d,register:c,control:x,errors:null==p?void 0:null===(a=p.fieldsFooter)||void 0===a?void 0:a.horaConclusao}),(0,t.jsx)(N.Z,{xs:12,md:8,title:"Profissional que aprova",name:"fieldsFooter.profissional",type:"string",options:null!=b?b:[],value:null==l?void 0:l.profissional,disabled:d,register:c,setValue:m,control:x,errors:null==p?void 0:null===(r=p.fieldsFooter)||void 0===r?void 0:r.profissional})]})})})};var R=a(75084),z=a(44373),_=a(21609);let B=e=>{var o,a,n,s,r,i,l,d,c,p,m,x;let{value:f,index:h,apresentacoes:v,setValue:g,register:D,control:b,errors:j}=e;return console.log("\uD83D\uDE80 ~ value:",f),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.Z,{xs:12,md:2,title:"Quantidade",name:"produtos[".concat(h,"].quantidade"),register:D,control:b,required:!0,errors:null==j?void 0:null===(o=j.produtos)||void 0===o?void 0:null===(a=o[h])||void 0===a?void 0:a.quantidade}),(0,t.jsx)(A.Z,{xs:12,md:2,required:!0,title:"Data da fabrica\xe7\xe3o",value:f.dataFabricacao,name:"produtos[".concat(h,"].dataFabricacao"),control:b,errors:null==j?void 0:null===(n=j.produtos)||void 0===n?void 0:null===(s=n[h])||void 0===s?void 0:s.dataFabricacao}),(0,t.jsx)(u.Z,{xs:12,md:2,title:"N\xba Lote",name:"produtos[".concat(h,"].lote"),required:!0,register:D,control:b,errors:null==j?void 0:null===(r=j.produtos)||void 0===r?void 0:null===(i=r[h])||void 0===i?void 0:i.lote}),(0,t.jsx)(N.Z,{xs:12,md:2,title:"Apresenta\xe7\xe3o",name:"produtos[".concat(h,"].apresentacao"),type:"string",options:null!=v?v:[],required:!0,register:D,setValue:g,control:b,errors:null==j?void 0:null===(l=j.produtos)||void 0===l?void 0:null===(d=l[h])||void 0===d?void 0:d.apresentacao}),(0,t.jsx)(u.Z,{xs:12,md:2,title:"NF",name:"produtos[".concat(h,"].nf"),required:!0,register:D,control:b,errors:null==j?void 0:null===(c=j.produtos)||void 0===c?void 0:null===(p=c[h])||void 0===p?void 0:p.nf}),(0,t.jsx)(A.Z,{xs:12,md:2,required:!0,title:"Data de validade",value:f.dataValidade,name:"produtos[".concat(h,"].dataValidade"),control:b,errors:null==j?void 0:null===(m=j.produtos)||void 0===m?void 0:null===(x=m[h])||void 0===x?void 0:x.dataValidade})]})},O=e=>{let{recebimentoMpID:o,fornecedorID:a,getValues:r,setValue:i,register:l,control:d,errors:c}=e;console.log("\uD83D\uDE80 ~ recebimentoMpID, fornecedorID:",o,a);let[u,p]=(0,n.useState)([]),[x,f]=(0,n.useState)([]),[h,D]=(0,n.useState)(!1),b=async()=>{try{if(a&&a>0){let e=await s.h.post("/cadastros/produto/getProdutosFornecedor",{recebimentoMpID:o,fornecedorID:a});console.log("\uD83D\uDE80 ~ renderiza response.data:",e.data[0]),p(e.data),i("produtos",e.data)}else p([])}catch(t){console.log("\uD83D\uDE80 ~ error:",t)}},j=async()=>{try{let e=await s.h.get("/cadastros/apresentacao");f(e.data)}catch(o){console.log("\uD83D\uDE80 ~ error:",o)}},I=e=>{D(!h),i("produtos[".concat(e,"].checked"),!r("produtos[".concat(e,"].checked")));let o=[...u];o[e].checked=!o[e].checked,p(o)};return(0,n.useEffect)(()=>{b(),j()},[a]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v.Z,{color:"primary",variant:"subtitle1",sx:{fontWeight:700,mb:2},children:"Produtos aprovados do fornecedor"}),!a&&(0,t.jsx)(v.Z,{color:"warning",variant:"subtitle1",className:"italic",children:(0,t.jsxs)(m.Z,{display:"flex",alignItems:"center",sx:{gap:1},children:[(0,t.jsx)(_.Z,{icon:"typcn:warning",color:"#FFC107"}),(0,t.jsx)("p",{children:"Nenhum fornecedor selecionado!"})]})}),a&&!u.length&&(0,t.jsx)(v.Z,{color:"warning",variant:"subtitle1",className:"italic",children:(0,t.jsxs)(m.Z,{display:"flex",alignItems:"center",sx:{gap:1},children:[(0,t.jsx)(_.Z,{icon:"typcn:warning",color:"#FFC107"}),(0,t.jsx)("p",{children:"Nenhum produto aprovado para o fornecedor selecionado!"})]})}),u&&u.length>0&&u.map((e,o)=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("input",{type:"hidden",value:e.produtoID,name:"produtos[".concat(o,"].produtoID"),...l("produtos[".concat(o,"].produtoID"))}),(0,t.jsxs)(g.ZP,{container:!0,spacing:4,sx:{pb:2},children:[(0,t.jsx)(g.ZP,{item:!0,xs:12,md:4,children:(0,t.jsx)(H.Z,{title:e.nome,name:"produtos[".concat(o,"].checked"),value:u[o].checked,onClick:()=>I(o),register:l})}),(0,t.jsx)(g.ZP,{item:!0,xs:12,md:8,children:(0,t.jsxs)(m.Z,{display:"flex",alignItems:"center",justifyContent:"end",sx:{gap:4,mt:3},children:[(0,t.jsxs)(v.Z,{variant:"body2",children:["\xdaltima avalia\xe7\xe3o: ",e.ultimaAvaliacao]}),(0,t.jsxs)(v.Z,{variant:"body2",children:["Pr\xf3xima avalia\xe7\xe3o: ",e.proximaAvialacao," (",1==e.diasRestantes?"".concat(e.diasRestantes," dia"):"".concat(e.diasRestantes," dias"),")"]}),(0,t.jsx)(R.Z,{variant:"outlined",size:"small",children:(0,t.jsxs)(m.Z,{display:"flex",alignItems:"center",sx:{gap:1},children:[(0,t.jsx)(_.Z,{icon:"fluent:form-new-20-regular",width:18,height:18}),"Nova avalia\xe7\xe3o"]})}),(0,t.jsx)(R.Z,{variant:"outlined",size:"small",children:(0,t.jsxs)(m.Z,{display:"flex",alignItems:"center",sx:{gap:1},children:[(0,t.jsx)(_.Z,{icon:"raphael:lab",width:18,height:18}),"Laborat\xf3rio (dev)"]})})]})}),u&&u[o].checked&&(0,t.jsx)(B,{value:e,apresentacoes:x,index:o,setValue:i,register:l,control:d,errors:c},o)]}),o<u.length-1&&(0,t.jsx)(z.Z,{})]}))]})};var q=a(41088);let T=e=>{let o,{id:a}=e;console.log("\uD83D\uDE80 ~ id:",a);let{menu:r,user:l,loggedUnity:b}=(0,n.useContext)(C.V),[A,N]=(0,n.useState)(!1),[H,k]=(0,n.useState)(!1),[R,z]=(0,n.useState)(!1),[_,B]=(0,n.useState)(!1),[T,L]=(0,n.useState)(!1),[X,G]=(0,n.useState)(!1),[W,U]=(0,n.useState)(!0),[J,K]=(0,n.useState)(!0),[Q,Y]=(0,n.useState)(null),[$,ee]=(0,n.useState)(null),[eo,ea]=(0,n.useState)([]),[et,en]=(0,n.useState)([]),[es,er]=(0,n.useState)(null),{createNewNotification:ei}=(0,n.useContext)(w.u),[el,ed]=(0,n.useState)(!1),[ec,eu]=(0,n.useState)([]),[ep,em]=(0,n.useState)([]),[ex,ef]=(0,n.useState)([]),[eh,ev]=(0,n.useState)(null),[eg,eD]=(0,n.useState)([]),[eb,ej]=(0,n.useState)(null),[eI,eZ]=(0,n.useState)(""),[ey,eC]=(0,n.useState)(!1),[ew,eS]=(0,n.useState)(!1),[eF,eE]=(0,n.useState)({status:!1,errors:[]}),{settings:eP}=(0,n.useContext)(E.J6),{setId:eA}=(0,n.useContext)(y.X),{startLoading:eN,stopLoading:eH}=(0,q.Z)(),[ek,eM]=(0,n.useState)({status:!1,message:"Voc\xea n\xe3o tem permiss\xf5es",messageType:"info"}),eV=j(),eR=a&&a>0?"edit":"new",ez=eV.pathname;console.log("\uD83D\uDE80 ~ staticUrl:",ez);let{reset:e_,register:eB,getValues:eO,setValue:eq,control:eT,watch:eL,handleSubmit:eX,clearErrors:eG,setError:eW,formState:{errors:eU}}=(0,i.cI)();console.log("errors: ",eU);let eJ=()=>{eA($.parRecebimentoMpModeloID),eV.push("/configuracoes/formularios/fornecedor/")},eK={id:4,name:"Formul\xe1rio do fornecedor",type:"report",papelID:l.papelID,fornecedorID:a,unidadeID:b.unidadeID,icon:"fluent:print-24-regular"},eQ=[];eQ.push(eK),1==l.papelID&&(o=!1,r.map(e=>{e.menu.map(e=>{e.submenu&&e.submenu.length>0&&e.submenu.map(e=>{"/configuracoes/formularios"==e.rota&&(o=!0)})})}),o)&&eQ.push({id:5,name:"Configura\xe7\xf5es do formul\xe1rio",description:"Alterar as configura\xe7\xf5es do modelo de formul\xe1rio.",route:null,type:null,action:eJ,modal:!1,icon:"bi:gear",identification:null});let eY=async()=>{},e$=()=>{N(!0);try{s.h.post("".concat(ez,"/getData/").concat(a),{type:eR,unidadeID:b.unidadeID}).then(e=>{var o,a;console.log("getData: ",e.data),N(!1),eu(e.data.fieldsHeader),Y(e.data.fieldsHeader.fornecedor),em(e.data.fieldsFooter),ef(e.data.fields),ea(e.data.produtos),eD(e.data.blocos),en(e.data.grupoAnexo),eZ(e.data.info),ee(e.data.unidade),ev(e.data.link),ej(e.data.ultimaMovimentacao),e8(e.data.blocos),e_(e.data);let t=I.WR[null==e?void 0:null===(o=e.data)||void 0===o?void 0:null===(a=o.info)||void 0===a?void 0:a.status];er(t),eM({status:e.data.info.status<40,message:e.data.info.status>40?"Esse formul\xe1rio j\xe1 foi conclu\xeddo, n\xe3o \xe9 mais poss\xedvel alterar as informa\xe7\xf5es!":e.data.info.status<40?"Formul\xe1rio aberto para preenchimento!":40==e.data.info.status?"Este formul\xe1rio est\xe1 aguardando aprova\xe7\xe3o!":null,messageType:"info"}),eY()}).catch(e=>{console.log("\uD83D\uDE80 ~ error:",e),N(!1)})}catch(e){console.log("\uD83D\uDE80 ~ error:",e),N(!1)}},e0=()=>{eG();let e=!1,o=[];null==ex||ex.forEach((a,t)=>{let n=a.tabela?"fields[".concat(t,"].").concat(a.tabela):"fields[".concat(t,"].").concat(a.nomeColuna),s=eO(n);1!==a.obrigatorio||s||(eW(n,{type:"manual",message:"Campo obrigat\xf3rio"}),o.push(null==a?void 0:a.nomeCampo),e=!0)}),eo&&eo.length>0&&eo.forEach((a,t)=>{a.produtoAnexosDescricao.forEach((n,s)=>{1===n.obrigatorio&&0==n.anexos.length&&(eW("produtos[".concat(t,"].produtoAnexosDescricao[").concat(s,"].anexos"),{type:"manual",message:"Campo obrigat\xf3rio"}),o.push("Anexo: ".concat(null==a?void 0:a.nome," / ").concat(null==n?void 0:n.nome)),e=!0)})}),eg.forEach((a,t)=>{a.itens.forEach((a,n)=>{console.log("\uD83D\uDE80 ~ checkErrors -> item: ",a);let s=eO("blocos[".concat(t,"].itens[").concat(n,"].resposta"));(null==a?void 0:a.obrigatorio)!==1||s||(eW("blocos[".concat(t,"].itens[").concat(n,"].resposta"),{type:"manual",message:"Campo obrigat\xe1rio"}),o.push(null==a?void 0:a.nome),e=!0),a.respostaConfig&&1==a.respostaConfig.anexo&&a.respostaConfig.anexosSolicitados.length>0&&a.respostaConfig.anexosSolicitados.forEach((s,r)=>{1==s.obrigatorio&&s.anexos&&0==s.anexos.length&&(eW("blocos[".concat(t,"].itens[").concat(n,"].respostaConfig.anexosSolicitados[").concat(r,"].anexos"),{type:"manual",message:"Campo obrigat\xe1rio"}),o.push("Anexo: ".concat(null==a?void 0:a.nome," / ").concat(null==s?void 0:s.nome)),e=!0)})})}),et&&et.length>0&&et.forEach((a,t)=>{a.itens.forEach((n,s)=>{1===n.obrigatorio&&0==n.anexos.length&&(console.log("gera erro grupo"),eW("grupoAnexo[".concat(t,"].itens[").concat(s,"].anexos"),{type:"manual",message:"Campo obrigat\xe1rio"}),o.push("Anexo: ".concat(null==a?void 0:a.nome," / ").concat(null==n?void 0:n.nome)),e=!0)})}),eE({status:e,errors:o})},e1=async e=>{if(9===e.length){let o=e.replace(/[^0-9]/g,"");try{let a=await s.h.get("https://viacep.com.br/ws/".concat(o,"/json/"));a.data.localidade?(ex.forEach(async(e,o)=>{("logradouro"===e.nomeColuna||"bairro"===e.nomeColuna||"cidade"===e.nomeColuna||"estado"===e.nomeColuna)&&(await eq("fields[".concat(o,"].logradouro"),a.data.logradouro),await eq("fields[".concat(o,"].bairro"),a.data.bairro),await eq("fields[".concat(o,"].cidade"),a.data.localidade),await eq("fields[".concat(o,"].estado"),a.data.uf))}),F.ZP.success("Endere\xe7o encontrado!")):F.ZP.error("Endere\xe7o n\xe3o encontrado!")}catch(t){console.error(t)}}},e3=()=>{e0(),eC(!0),G(!0)},e8=e=>{let o=!0;e.forEach(e=>{e.itens.forEach(e=>{e.respostaConfig&&1==e.respostaConfig.bloqueiaFormulario&&(o=!1)})}),K(o)},e2=async e=>{e.conclusion=!0,await eX(e7)(e)},e4=(e,o,t)=>{let n=30==e?"Em preenchimento":40==e?"Conclu\xeddo":50==e?"Reprovado":60==e?"Aprovado parcialmente":70==e?"Aprovado":"Pendente",s={titulo:"Formul\xe1rio de Fornecedor ".concat(n),descricao:"O formul\xe1rio de Fornecedor #".concat(a," est\xe1 ").concat(n,"."),url:"/formularios/fornecedor/",urlID:a,tipoNotificacaoID:6,usuarioGeradorID:l.usuarioID,usuarioID:0,unidadeID:b.unidadeID,papelID:1};if(s&&(ei(s),o)){let r={titulo:"Fornecedor gerado",descricao:"O formul\xe1rio de Fornecedor #".concat(a," est\xe1 ").concat(n," e gerou uma n\xe3o conformidade."),url:"/formularios/fornecedor/nao-conformidade/",urlID:t,tipoNotificacaoID:5,usuarioGeradorID:l.usuarioID,usuarioID:0,unidadeID:b.unidadeID,papelID:1};ei(r)}},e7=async function(e){var o;let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];eN(),!0===t.conclusion&&(e.status=t.status,e.obsConclusao=t.obsConclusao);let n={form:e,auth:{usuarioID:l.usuarioID,profissionalID:null!==(o=l.profissionalID)&&void 0!==o?o:0,papelID:l.papelID,unidadeID:b.unidadeID}};console.log("\uD83D\uDE80 ~ onSubmit: ",n);try{"edit"==eR?(L(!0),await s.h.post("".concat(ez,"/updateData/").concat(a),n).then(o=>{F.ZP.success(I.OD.successUpdate),L(!1),e4(e.status,e.naoConformidade,null)})):"new"==eR?await s.h.post("".concat((0,I.g_)(ez),"/insertData"),n).then(e=>{eV.push("".concat((0,I.g_)(ez))),eA(e.data),F.ZP.success(I.OD.successNew)}):F.ZP.error(I.OD.error)}catch(r){console.log(r)}finally{eH()}},e6=async(e,o)=>{k(!0);let t=e.target.files;if(t&&t.length>0){var n;let r=new FormData;for(let i=0;i<t.length;i++)r.append("files[]",t[i]);r.append("usuarioID",l.usuarioID),r.append("unidadeID",b.unidadeID),r.append("grupoAnexoItemID",null!==(n=o.grupoAnexoItemID)&&void 0!==n?n:null),await s.h.post("".concat(ez,"/saveAnexo/").concat(a,"/grupo-anexo/").concat(l.usuarioID,"/").concat($.unidadeID),r).then(e=>{k(!1);let o=eO();e7(o)}).catch(e=>{var o,a,t;k(!1),F.ZP.error(null!==(t=null===(o=e.response)||void 0===o?void 0:null===(a=o.data)||void 0===a?void 0:a.message)&&void 0!==t?t:"Erro ao atualizar anexo, tente novamente!")})}},e9=async(e,o)=>{B(!0);let t=e.target.files;if(console.log("\uD83D\uDE80 ~ selectedFile:",t),t&&t.length>0){var n,r;let i=new FormData;for(let d=0;d<t.length;d++)i.append("files[]",t[d]);i.append("usuarioID",l.usuarioID),i.append("unidadeID",b.unidadeID),i.append("parRecebimentoMpModeloBlocoID",null!==(n=o.parRecebimentoMpModeloBlocoID)&&void 0!==n?n:null),i.append("itemOpcaoAnexoID",null!==(r=o.itemOpcaoAnexoID)&&void 0!==r?r:null),console.log("\uD83D\uDE80 ~ item:",o),await s.h.post("".concat(ez,"/saveAnexo/").concat(a,"/item/").concat(l.usuarioID,"/").concat($.unidadeID),i).then(e=>{B(!1);let o=eO();e7(o)}).catch(e=>{var o,a,t;B(!1),F.ZP.error(null!==(t=null===(o=e.response)||void 0===o?void 0:null===(a=o.data)||void 0===a?void 0:a.message)&&void 0!==t?t:"Erro ao atualizar anexo, tente novamente!!!!")})}},e5=async e=>{console.log("\uD83D\uDE80 ~ setItemResposta ~ value:",e);try{let o=await s.h.post("/cadastros/item/getItemConfigs",{itemID:e.itemID,alternativaItemID:e.alternativa.id}),a=eg.map(a=>({...a,itens:a.itens.map(a=>a.itemID==e.itemID?(console.log("setItemResposta IGUAL: ",a),{...a,respostaConfig:{...o.data}}):a)}));console.log("\uD83D\uDE80 ~ updatedBlocos:",a),eD(a)}catch(t){console.log("error",t)}},oe=async e=>{e&&await s.h.delete("".concat(ez,"/deleteAnexo/").concat(a,"/").concat(e.anexoID,"/").concat($.unidadeID,"/").concat(l.usuarioID,"/grupo-anexo")).then(e=>{let o=eO();e7(o)}).catch(e=>{var o,a,t;F.ZP.error(null!==(t=null===(o=e.response)||void 0===o?void 0:null===(a=o.data)||void 0===a?void 0:a.message)&&void 0!==t?t:"Erro ao remover anexo, tente novamente!")})},oo=async e=>{e&&await s.h.delete("".concat(ez,"/deleteAnexo/").concat(a,"/").concat(e.anexoID,"/").concat($.unidadeID,"/").concat(l.usuarioID,"/item")).then(e=>{let o=eO();e7(o)}).catch(e=>{var o,a,t;F.ZP.error(null!==(t=null===(o=e.response)||void 0===o?void 0:null===(a=o.data)||void 0===a?void 0:a.message)&&void 0!==t?t:"Erro ao remover anexo, tente novamente!")})};return(0,n.useEffect)(()=>{"edit"==eR&&e$()},[a,T]),(0,n.useEffect)(()=>{e0()},[]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(S.Z,{show:A}),(0,t.jsx)("form",{onSubmit:eX(e7),children:(0,t.jsxs)(m.Z,{display:"flex",flexDirection:"column",sx:{gap:4},children:[ek.message&&(0,t.jsx)(x.Z,{severity:"warning",children:ek.message}),eb&&(0,t.jsxs)(x.Z,{severity:"info",children:["\xdaltima movimenta\xe7\xe3o: Profissional ".concat(eb.nome," do(a) ").concat(eb.nomeFantasia," movimentou o formul\xe1rio de ").concat(eb.statusAnterior," para ").concat(eb.statusAtual," em ").concat(eb.dataHora,"."),eb.observacao&&(0,t.jsxs)("p",{children:[(0,t.jsx)("br",{}),'Mensagem: "',eb.observacao,'"']})]}),eI&&""!=eI.cabecalhoModelo&&(0,t.jsx)(f.Z,{children:(0,t.jsx)(h.Z,{children:(0,t.jsx)(v.Z,{variant:"subtitle1",sx:{mb:2},children:eI.cabecalhoModelo})})}),(0,t.jsxs)(f.Z,{children:[(0,t.jsx)(Z.Z,{btnCancel:!0,btnSave:eI.status<40,btnSend:eI.status>=40,btnPrint:"edit"==eR,actionsData:eQ,actions:!0,handleSubmit:()=>eX(e7),handleSend:e3,iconConclusion:"mdi:check-bold",titleConclusion:"Concluir Formul\xe1rio",title:"Recebimento de MP",handleBtnStatus:()=>ed(!0),type:eR,status:es}),(0,t.jsx)(h.Z,{children:$&&(0,t.jsxs)(m.Z,{display:"flex",flexDirection:"column",sx:{gap:1},children:[(0,t.jsx)(v.Z,{variant:"caption",sx:{pb:4},children:"Aberto por ".concat(ec.abertoPor.profissional.nome," em ").concat(ec.abertoPor.dataInicio," ").concat(ec.abertoPor.horaInicio," ")}),(0,t.jsx)(M,{modeloID:$.parRecebimentoMpModeloID,values:ec,fornecedor:Q,setFornecedor:Y,fields:ex,getValues:eO,disabled:!ek.status,register:eB,errors:eU,setValue:eq,control:eT,getAddressByCep:e1})]})})]}),(0,t.jsx)(f.Z,{children:(0,t.jsx)(h.Z,{children:(0,t.jsx)(O,{recebimentoMpID:a,fornecedorID:eO("fieldsHeader.fornecedor.id"),getValues:eO,setValue:eq,register:eB,control:eT,errors:eU},T)})}),eg&&eg.map((e,o)=>(0,t.jsx)(d.Z,{index:o,blockKey:"parRecebimentoMpModeloBlocoID",handleFileSelect:e9,setItemResposta:e5,handleRemoveAnexoItem:oo,setBlocos:eD,values:e,control:eT,register:eB,setValue:eq,errors:null==eU?void 0:eU.blocos,disabled:!ek.status},o)),et&&et.map((e,o)=>(0,t.jsx)(p.Z,{values:{grupo:e,loadingFile:H,indexGrupo:o,handleFileSelect:e6,handleRemove:oe,folder:"grupo-anexo",disabled:!ek.status,error:eU}},o)),eI&&(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(f.Z,{children:(0,t.jsx)(h.Z,{children:(0,t.jsx)(g.ZP,{container:!0,spacing:4,children:(0,t.jsx)(g.ZP,{item:!0,xs:12,md:12,children:(0,t.jsxs)(D.Z,{fullWidth:!0,children:[(0,t.jsx)(v.Z,{variant:"subtitle1",sx:{fontWeight:600,mb:2},children:"Observa\xe7\xf5es (campo de uso exclusivo da validadora)"}),(0,t.jsx)(u.Z,{title:"Observa\xe7\xe3o (opcional)",name:"info.obs",multiline:!0,rows:4,value:eI.obs,disabled:!ek.status,control:eT})]})})})})})}),$&&ep&&!ep.concluded&&(0,t.jsx)(V,{modeloID:$.parRecebimentoMpModeloID,values:ep,register:eB,disabled:!1,errors:eU,setValue:eq,control:eT}),ep&&ep.concluded&&(0,t.jsx)(v.Z,{variant:"caption",children:"Conclu\xeddo por ".concat(ep.conclusion.profissional.nome," em ").concat(ep.conclusion.dataFim," ").concat(ep.conclusion.horaFim,".")}),el&&(0,t.jsx)(c.Z,{title:"Hist\xf3rico do Formul\xe1rio",text:"Listagem do hist\xf3rico das movimenta\xe7\xf5es do formul\xe1rio ".concat(a," do Recebimento de MP."),id:a,parFormularioID:2,formStatus:eI.status,hasFormPending:W,canChangeStatus:!W&&eI.status>30,openModal:el,handleClose:()=>ed(!1),btnCancel:!0,btnConfirm:!0,handleSubmit:changeFormStatus}),(0,t.jsx)(P.Z,{openModal:ey,handleClose(){eC(!1),G(!1)},title:"Concluir Formul\xe1rio",text:"Deseja realmente concluir este formul\xe1rio?",info:eI,canChange:!W,register:eB,setValue:eq,getValues:eO,btnCancel:!0,btnConfirm:!0,btnConfirmColor:"primary",conclusionForm:e2,listErrors:eF,canApprove:J})]})})]})};var L=a(60565);let X=()=>{let{user:e,loggedUnity:o}=(0,n.useContext)(C.V),[a,i]=(0,n.useState)(null),l=(0,b.useRouter)(),d=l.pathname,{setTitle:c}=(0,n.useContext)(L.f),{id:u}=(0,n.useContext)(y.X),p=async()=>{await s.h.get("".concat(d,"/getList/").concat(o.unidadeID)).then(e=>{i(e.data),c({title:"Recebimento de MP",subtitle:{id:u,count:e.data.length,new:!1}})})};(0,n.useEffect)(()=>{p()},[u]);let m=(0,I.OL)(d,[{headerName:"ID",field:"id",size:.1},{headerName:"Data",field:"data",size:.1,type:"date"},{headerName:"Profissional",field:"profissional",size:.2},{headerName:"Modelo",field:"modelo",size:.2},{headerName:"Status",field:{name:"status",cor:"cor"},size:.2}]);return(0,t.jsx)(t.Fragment,{children:a?u&&u>0?(0,t.jsx)(T,{id:u}):(0,t.jsx)(r.Z,{result:a,columns:m}):(0,t.jsx)(S.Z,{show:!0})})};var G=X},84242:function(e,o,a){"use strict";a.d(o,{Z:function(){return I}});var t=a(85893),n=a(30120),s=a(67836),r=a(80562),i=a(50853),l=a(11163),d=a.n(l),c=a(75084),u=a(41664),p=a.n(u),m=a(40039),x=a(67294),f=a(83830),h=a(46749),v=a(21609),g=a(41088);let D=e=>{let{btnNew:o,btnPrint:a,btnSave:n,btnBack:s,handleSave:r,hasListChange:i,openModal:l}=e,u=d(),{setId:D}=(0,x.useContext)(f.X),{routes:b}=(0,x.useContext)(m.V),{isLoading:j}=(0,g.Z)();return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between my-2 w-full",children:[(0,t.jsx)("div",{}),(0,t.jsxs)("div",{className:"flex items-center gap-4 ",children:[(0,t.jsx)("div",{children:a&&(0,t.jsxs)(c.Z,{onClick:()=>window.print(),type:"button",variant:"outlined",color:"primary",size:"medium",sx:{display:"flex",gap:2},children:[(0,t.jsx)(v.Z,{icon:"mdi:printer"}),(0,t.jsx)("span",{className:"hidden sm:block",children:"Imprimir"})]})}),(0,t.jsx)("div",{className:"",children:o&&b.find(e=>(e.rota===u.pathname||e.rota===(0,h.g_)(u.pathname))&&e.inserir)&&(0,t.jsx)(p(),{href:l?"":"".concat(u.pathname,"/novo"),children:(0,t.jsxs)(c.Z,{type:"button",variant:"outlined",color:"primary",size:"medium",onClick:l||null,sx:{display:"flex",gap:2},children:[(0,t.jsx)(v.Z,{icon:"ic:outline-plus"}),(0,t.jsx)("span",{className:"hidden sm:block",children:"Novo"})]})})}),(0,t.jsx)("div",{children:n&&(0,t.jsxs)(c.Z,{onClick:r,disabled:!i||j,type:"button",variant:"outlined",color:j?"secondary":"primary",size:"medium",sx:{display:"flex",gap:2},children:[(0,t.jsx)(v.Z,{icon:"mdi:check-bold"}),(0,t.jsx)("span",{className:"hidden sm:block",children:"Salvar"})]})})]})]})})};var b=a(61225);let j=e=>{let o=d(),{setId:a}=(0,x.useContext)(f.X);return(0,b.Z)("(min-width:640px)"),(0,t.jsxs)(n.Z,{sx:{display:"flex",flexDirection:"row",gap:2,alignItems:"center",mb:2,justifyContent:"space-between",p:e=>e.spacing(8,0,0,0)},children:[(0,t.jsxs)(n.Z,{sx:{display:"flex",gap:"8px",textAlig:"end"},children:[e.buttonsHeader.btnBack&&(0,t.jsx)(c.Z,{onClick(){o.push((0,h.g_)(o.pathname)),a(null)},type:"button",variant:"outlined",color:"primary",size:"small",children:(0,t.jsx)(v.Z,{icon:"material-symbols:arrow-back-rounded"})}),(0,t.jsx)(s.Z,{size:"medium",value:e.value,onChange:e.onChange,placeholder:"Buscarâ€¦",variant:"standard",InputProps:{startAdornment:(0,t.jsx)(n.Z,{sx:{mr:2,display:"flex"},children:(0,t.jsx)(v.Z,{icon:"mdi:magnify",fontSize:20})}),endAdornment:(0,t.jsx)(r.Z,{size:"medium",title:"Clear","aria-label":"Clear",onClick:e.clearSearch,children:(0,t.jsx)(v.Z,{icon:"mdi:close",fontSize:20})})},sx:{width:{xs:1,sm:"auto"},"& .MuiInputBase-root > svg":{mr:2}}}),(0,t.jsx)("div",{className:"hidden sm:block ",children:(0,t.jsx)(i.M,{className:"!h-full"})})]}),(0,t.jsx)(D,{btnNew:e.buttonsHeader.btnNew,btnPrint:e.buttonsHeader.btnPrint,btnBack:e.buttonsHeader.btnBack,btnSave:e.buttonsHeader.btnSave,handleSave:e.buttonsHeader.handleSave,hasListChange:e.hasChange,openModal:e.buttonsHeader.openModal})]})};var I=j},95722:function(e,o,a){"use strict";var t=a(85893),n=a(67294),s=a(87630),r=a(75680),i=a(84242),l=a(60565),d=a(83830);let c=e=>{let{rows:o,columns:a,buttonsHeader:c}=e,{handleSearch:u,pageSize:p,setPageSize:m,searchText:x,filteredData:f,setData:h,data:v}=(0,n.useContext)(l.f),{setId:g}=(0,n.useContext)(d.X);function D(e){let o=e.split("/");return"".concat(o[2],"-").concat(o[1],"-").concat(o[0])}h(o);let b=v.slice().sort((e,o)=>"Inativo"===e.status&&"Inativo"!==o.status?1:"Inativo"!==e.status&&"Inativo"===o.status?-1:0),j=e=>{let o=e.row.status;return"Inativo"===o?"inativo-row":""};return a.map(e=>{"date"===e.type&&(e.sortComparator=(e,o)=>{let a=D(e),t=D(o);return a.localeCompare(t)})}),(0,t.jsx)(s._,{localeText:r.F.components.MuiDataGrid.defaultProps.localeText,autoHeight:!0,columns:a,pageSize:p,rowsPerPageOptions:[10,20,30,40,50,100],components:{Toolbar:i.Z},rows:x?f:b,onCellClick(e,o){g(e.row.id)},onPageSizeChange:e=>m(e),getRowClassName:j,sx:{"& .MuiDataGrid-cell":{cursor:"pointer",overflow:"scroll"}},componentsProps:{toolbar:{value:x,clearSearch:()=>u(""),onChange:e=>u(e.target.value),buttonsHeader:c}}})};o.Z=c}},function(e){e.O(0,[9241,1515,6319,8934,1959,477,9774,2888,179],function(){return e(e.s=68374)}),_N_E=e.O()}]);