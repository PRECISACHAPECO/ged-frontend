"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6729],{49837:function(e,o,a){a.d(o,{Z:function(){return D}});var t=a(87462),n=a(63366),r=a(67294),s=a(86010),l=a(94780),i=a(67074),d=a(78884),c=a(70918),u=a(1588),p=a(34867);function x(e){return(0,p.Z)("MuiCard",e)}(0,u.Z)("MuiCard",["root"]);var m=a(85893);let f=["className","raised"],v=e=>{let{classes:o}=e;return(0,l.Z)({root:["root"]},x,o)},h=(0,i.ZP)(c.Z,{name:"MuiCard",slot:"Root",overridesResolver:(e,o)=>o.root})(()=>({overflow:"hidden"})),g=r.forwardRef(function(e,o){let a=(0,d.Z)({props:e,name:"MuiCard"}),{className:r,raised:l=!1}=a,i=(0,n.Z)(a,f),c=(0,t.Z)({},a,{raised:l}),u=v(c);return(0,m.jsx)(h,(0,t.Z)({className:(0,s.Z)(u.root,r),elevation:l?8:void 0,ref:o,ownerState:c},i))});var D=g},18377:function(e,o,a){var t=a(61354);let n=(0,t.Z)();o.Z=n},96729:function(e,o,a){a.d(o,{Z:function(){return G}});var t=a(85893),n=a(67294),r=a(87536),s=a(56531),l=a(99734),i=a(34282),d=a(29308),c=a(23895),u=a(30120),p=a(19604),x=a(49837),m=a(91359),f=a(29630),v=a(79072),h=a(55343),g=a(11163),D=a.n(g),b=a(46749),I=a(60664),Z=a(86887),j=a(83830),y=a(40039),C=a(39976),S=a(47842),F=a(86501),E=a(66136),w=a(80377);a(69418);var P=a(50287),A=a(84220),M=a(3893),V=a(18377);let H=e=>{var o,a,r,l;let{modeloID:i,values:c,fields:u,getValues:p,fornecedor:x,setFornecedor:m,disabled:f,register:h,errors:g,setValue:D,control:Z,getAddressByCep:j}=e;console.log("\uD83D\uDE80 ~~~ fornecedor:",x);let{loggedUnity:C}=(0,n.useContext)(y.V),[S,F]=(0,n.useState)({}),[E,w]=(0,n.useState)([]),[M,H]=(0,n.useState)([]),R=(e,o,a,t)=>{let n=new Date(a),r=(0,b.HD)(e,n,t);F(e=>({...e,[o]:r}))},k=async()=>{let e=await I.h.post("/cadastros/profissional/getProfissionaisAssinatura",{formularioID:2,modeloID:i});w(e.data.preenche)},N=async()=>{let e=await I.h.post("/formularios/fornecedor/getFornecedoresAprovados",{unidadeID:C.unidadeID});H(e.data)};return(0,n.useEffect)(()=>{k(),N()},[]),(0,t.jsxs)(v.ZP,{container:!0,spacing:4,children:[(0,t.jsx)(P.Z,{xs:12,md:2,title:"Data da avalia\xe7\xe3o",name:"fieldsHeader.data",type:"date",value:null==c?void 0:c.data,disabled:f,register:h,control:Z,setDateFormat:R,typeValidation:"dataPassado",daysValidation:365,dateStatus:S,errors:null==g?void 0:null===(o=g.fieldsHeader)||void 0===o?void 0:o.data}),(0,t.jsx)(d.Z,{xs:12,md:2,title:"Hora da avalia\xe7\xe3o",name:"fieldsHeader.hora",type:"time",disabled:f,register:h,control:Z,errors:null==g?void 0:null===(a=g.fieldsHeader)||void 0===a?void 0:a.hora}),(0,t.jsx)(A.Z,{xs:12,md:8,title:"Profissional preenchimento",name:"fieldsHeader.profissional",type:"string",options:E,value:null==c?void 0:c.profissional,disabled:f,register:h,setValue:D,control:Z,errors:null==g?void 0:null===(r=g.fieldsHeader)||void 0===r?void 0:r.profissional}),(0,t.jsx)(s.Z,{register:h,errors:g,setValue:D,control:Z,fields:u,values:u,getAddressByCep:j,disabled:f}),(0,t.jsx)(A.Z,{xs:12,md:4,title:"Fornecedor",name:"fieldsHeader.fornecedor",type:"string",options:M,onChange:e=>m(e),value:null==c?void 0:c.fornecedor,disabled:f,register:h,setValue:D,control:Z,errors:null==g?void 0:null===(l=g.fieldsHeader)||void 0===l?void 0:l.fornecedor}),(0,t.jsx)(v.ZP,{item:!0,xs:12,md:8,children:p("fieldsHeader.fornecedor")&&p("fieldsHeader.fornecedor.id")>0&&(0,t.jsxs)(V.Z,{display:"flex",flexDirection:"column",children:[(0,t.jsx)("p",{className:"text-xs",children:"Dados do Fornecedor"}),(0,t.jsxs)(V.Z,{display:"flex",alignItems:"center",gap:4,children:[p("fieldsHeader.fornecedor.telefone")&&(0,t.jsxs)("p",{children:["Telefone: ",p("fieldsHeader.fornecedor.telefone")]}),p("fieldsHeader.fornecedor.cidade")&&(0,t.jsxs)("p",{children:["Cidade: ",p("fieldsHeader.fornecedor.cidade")]})]})]})})]})},R=e=>{var o,a,r;let{modeloID:s,values:l,disabled:i,register:c,errors:u,setValue:p,control:f}=e,[h,g]=(0,n.useState)({}),[D,Z]=(0,n.useState)([]),j=(e,o,a,t)=>{let n=new Date(a),r=(0,b.HD)(e,n,t);g(e=>({...e,[o]:r}))},y=async()=>{let e=await I.h.post("/cadastros/profissional/getProfissionaisAssinatura",{formularioID:2,modeloID:s});console.log("\uD83D\uDE80 ~ response.data:",e.data),Z(e.data.aprova)};return(0,n.useEffect)(()=>{y()},[]),(0,t.jsx)(x.Z,{children:(0,t.jsx)(m.Z,{children:(0,t.jsxs)(v.ZP,{container:!0,spacing:4,children:[(0,t.jsx)(P.Z,{xs:12,md:2,title:"Data da conclus\xe3o",name:"fieldsFooter.dataConclusao",type:"date",value:null==l?void 0:l.dataConclusao,disabled:i,register:c,control:f,setDateFormat:j,typeValidation:"dataPassado",daysValidation:365,dateStatus:h,errors:null==u?void 0:null===(o=u.fieldsFooter)||void 0===o?void 0:o.dataConclusao}),(0,t.jsx)(d.Z,{xs:12,md:2,title:"Hora da conclus\xe3o",name:"fieldsFooter.horaConclusao",type:"time",disabled:i,register:c,control:f,errors:null==u?void 0:null===(a=u.fieldsFooter)||void 0===a?void 0:a.horaConclusao}),(0,t.jsx)(A.Z,{xs:12,md:8,title:"Profissional que aprova",name:"fieldsFooter.profissional",type:"string",options:null!=D?D:[],value:null==l?void 0:l.profissional,disabled:i,register:c,setValue:p,control:f,errors:null==u?void 0:null===(r=u.fieldsFooter)||void 0===r?void 0:r.profissional})]})})})};var k=a(75084),N=a(44373),q=a(21609);let O=e=>{var o,a,n,r,s,l,i,c,u,p,x,m;let{value:f,index:v,apresentacoes:h,setValue:g,register:D,control:b,errors:I}=e;return console.log("\uD83D\uDE80 ~ value:",f),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.Z,{xs:12,md:2,title:"Quantidade",name:"produtos[".concat(v,"].quantidade"),register:D,control:b,required:!0,errors:null==I?void 0:null===(o=I.produtos)||void 0===o?void 0:null===(a=o[v])||void 0===a?void 0:a.quantidade}),(0,t.jsx)(P.Z,{xs:12,md:2,required:!0,title:"Data da fabrica\xe7\xe3o",value:f.dataFabricacao,name:"produtos[".concat(v,"].dataFabricacao"),control:b,errors:null==I?void 0:null===(n=I.produtos)||void 0===n?void 0:null===(r=n[v])||void 0===r?void 0:r.dataFabricacao}),(0,t.jsx)(d.Z,{xs:12,md:2,title:"N\xba Lote",name:"produtos[".concat(v,"].lote"),required:!0,register:D,control:b,errors:null==I?void 0:null===(s=I.produtos)||void 0===s?void 0:null===(l=s[v])||void 0===l?void 0:l.lote}),(0,t.jsx)(A.Z,{xs:12,md:2,title:"Apresenta\xe7\xe3o",name:"produtos[".concat(v,"].apresentacao"),type:"string",options:null!=h?h:[],required:!0,register:D,setValue:g,control:b,errors:null==I?void 0:null===(i=I.produtos)||void 0===i?void 0:null===(c=i[v])||void 0===c?void 0:c.apresentacao}),(0,t.jsx)(d.Z,{xs:12,md:2,title:"NF",name:"produtos[".concat(v,"].nf"),required:!0,register:D,control:b,errors:null==I?void 0:null===(u=I.produtos)||void 0===u?void 0:null===(p=u[v])||void 0===p?void 0:p.nf}),(0,t.jsx)(P.Z,{xs:12,md:2,required:!0,title:"Data de validade",value:f.dataValidade,name:"produtos[".concat(v,"].dataValidade"),control:b,errors:null==I?void 0:null===(x=I.produtos)||void 0===x?void 0:null===(m=x[v])||void 0===m?void 0:m.dataValidade})]})},B=e=>{let{recebimentoMpID:o,fornecedorID:a,getValues:r,setValue:s,register:l,control:i,errors:d}=e;console.log("\uD83D\uDE80 ~ recebimentoMpID, fornecedorID:",o,a);let[c,p]=(0,n.useState)([]),[x,m]=(0,n.useState)([]),[h,g]=(0,n.useState)(!1),D=async()=>{try{if(a&&a>0){let e=await I.h.post("/cadastros/produto/getProdutosFornecedor",{recebimentoMpID:o,fornecedorID:a});console.log("\uD83D\uDE80 ~ renderiza response.data:",e.data[0]),p(e.data),s("produtos",e.data)}else p([])}catch(t){console.log("\uD83D\uDE80 ~ error:",t)}},b=async()=>{try{let e=await I.h.get("/cadastros/apresentacao");m(e.data)}catch(o){console.log("\uD83D\uDE80 ~ error:",o)}},Z=e=>{g(!h),s("produtos[".concat(e,"].checked"),!r("produtos[".concat(e,"].checked")));let o=[...c];o[e].checked=!o[e].checked,p(o)};return(0,n.useEffect)(()=>{D(),b()},[a]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.Z,{color:"primary",variant:"subtitle1",sx:{fontWeight:700,mb:2},children:"Produtos aprovados do fornecedor"}),!a&&(0,t.jsx)(f.Z,{color:"warning",variant:"subtitle1",className:"italic",children:(0,t.jsxs)(u.Z,{display:"flex",alignItems:"center",sx:{gap:1},children:[(0,t.jsx)(q.Z,{icon:"typcn:warning",color:"#FFC107"}),(0,t.jsx)("p",{children:"Nenhum fornecedor selecionado!"})]})}),a&&!c.length&&(0,t.jsx)(f.Z,{color:"warning",variant:"subtitle1",className:"italic",children:(0,t.jsxs)(u.Z,{display:"flex",alignItems:"center",sx:{gap:1},children:[(0,t.jsx)(q.Z,{icon:"typcn:warning",color:"#FFC107"}),(0,t.jsx)("p",{children:"Nenhum produto aprovado para o fornecedor selecionado!"})]})}),c&&c.length>0&&c.map((e,o)=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("input",{type:"hidden",value:e.produtoID,name:"produtos[".concat(o,"].produtoID"),...l("produtos[".concat(o,"].produtoID"))}),(0,t.jsxs)(v.ZP,{container:!0,spacing:4,sx:{pb:2},children:[(0,t.jsx)(v.ZP,{item:!0,xs:12,md:4,children:(0,t.jsx)(M.Z,{title:e.nome,name:"produtos[".concat(o,"].checked"),value:c[o].checked,onClick:()=>Z(o),register:l})}),(0,t.jsx)(v.ZP,{item:!0,xs:12,md:8,children:(0,t.jsxs)(u.Z,{display:"flex",alignItems:"center",justifyContent:"end",sx:{gap:4,mt:3},children:[(0,t.jsxs)(f.Z,{variant:"body2",children:["\xdaltima avalia\xe7\xe3o: ",e.ultimaAvaliacao]}),(0,t.jsxs)(f.Z,{variant:"body2",children:["Pr\xf3xima avalia\xe7\xe3o: ",e.proximaAvialacao," (",1==e.diasRestantes?"".concat(e.diasRestantes," dia"):"".concat(e.diasRestantes," dias"),")"]}),(0,t.jsx)(k.Z,{variant:"outlined",size:"small",children:(0,t.jsxs)(u.Z,{display:"flex",alignItems:"center",sx:{gap:1},children:[(0,t.jsx)(q.Z,{icon:"fluent:form-new-20-regular",width:18,height:18}),"Nova avalia\xe7\xe3o"]})}),(0,t.jsx)(k.Z,{variant:"outlined",size:"small",children:(0,t.jsxs)(u.Z,{display:"flex",alignItems:"center",sx:{gap:1},children:[(0,t.jsx)(q.Z,{icon:"raphael:lab",width:18,height:18}),"Laborat\xf3rio (dev)"]})})]})}),c&&c[o].checked&&(0,t.jsx)(O,{value:e,apresentacoes:x,index:o,setValue:s,register:l,control:i,errors:d},o)]}),o<c.length-1&&(0,t.jsx)(N.Z,{})]}))]})};var _=a(41088);let z=e=>{let o,{id:a}=e;console.log("\uD83D\uDE80 ~ id:",a);let{menu:s,user:g,loggedUnity:P}=(0,n.useContext)(y.V),[A,M]=(0,n.useState)(!1),[V,k]=(0,n.useState)(!1),[N,q]=(0,n.useState)(!1),[O,z]=(0,n.useState)(!1),[G,L]=(0,n.useState)(!1),[W,T]=(0,n.useState)(!1),[U,J]=(0,n.useState)(!0),[K,Q]=(0,n.useState)(!0),[X,Y]=(0,n.useState)(null),[$,ee]=(0,n.useState)(null),[eo,ea]=(0,n.useState)([]),[et,en]=(0,n.useState)([]),[er,es]=(0,n.useState)(null),{createNewNotification:el}=(0,n.useContext)(C.u),[ei,ed]=(0,n.useState)(!1),[ec,eu]=(0,n.useState)([]),[ep,ex]=(0,n.useState)([]),[em,ef]=(0,n.useState)([]),[ev,eh]=(0,n.useState)(null),[eg,eD]=(0,n.useState)([]),[eb,eI]=(0,n.useState)(null),[eZ,ej]=(0,n.useState)(""),[ey,eC]=(0,n.useState)(!1),[eS,eF]=(0,n.useState)(!1),[eE,ew]=(0,n.useState)({status:!1,errors:[]}),{settings:eP}=(0,n.useContext)(E.J6),{setId:eA}=(0,n.useContext)(j.X),{startLoading:eM,stopLoading:eV}=(0,_.Z)(),[eH,eR]=(0,n.useState)({status:!1,message:"Voc\xea n\xe3o tem permiss\xf5es",messageType:"info"}),ek=D(),eN=a&&a>0?"edit":"new",eq=ek.pathname;console.log("\uD83D\uDE80 ~ staticUrl:",eq);let{reset:eO,register:eB,getValues:e_,setValue:ez,control:eG,watch:eL,handleSubmit:eW,clearErrors:eT,setError:eU,formState:{errors:eJ}}=(0,r.cI)();console.log("errors: ",eJ);let eK=()=>{eA($.parRecebimentoMpModeloID),ek.push("/configuracoes/formularios/fornecedor/")},eQ={id:4,name:"Formul\xe1rio do fornecedor",type:"report",papelID:g.papelID,fornecedorID:a,unidadeID:P.unidadeID,icon:"fluent:print-24-regular"},eX=[];eX.push(eQ),1==g.papelID&&(o=!1,s.map(e=>{e.menu.map(e=>{e.submenu&&e.submenu.length>0&&e.submenu.map(e=>{"/configuracoes/formularios"==e.rota&&(o=!0)})})}),o)&&eX.push({id:5,name:"Configura\xe7\xf5es do formul\xe1rio",description:"Alterar as configura\xe7\xf5es do modelo de formul\xe1rio.",route:null,type:null,action:eK,modal:!1,icon:"bi:gear",identification:null});let eY=async()=>{},e$=()=>{M(!0);try{I.h.post("".concat(eq,"/getData/").concat(a),{type:eN,unidadeID:P.unidadeID}).then(e=>{var o,a;console.log("getData: ",e.data),M(!1),eu(e.data.fieldsHeader),Y(e.data.fieldsHeader.fornecedor),ex(e.data.fieldsFooter),ef(e.data.fields),ea(e.data.produtos),eD(e.data.blocos),en(e.data.grupoAnexo),ej(e.data.info),ee(e.data.unidade),eh(e.data.link),eI(e.data.ultimaMovimentacao),e3(e.data.blocos),eO(e.data);let t=b.WR[null==e?void 0:null===(o=e.data)||void 0===o?void 0:null===(a=o.info)||void 0===a?void 0:a.status];es(t),eR({status:e.data.info.status<40,message:e.data.info.status>40?"Esse formul\xe1rio j\xe1 foi conclu\xeddo, n\xe3o \xe9 mais poss\xedvel alterar as informa\xe7\xf5es!":e.data.info.status<40?"Formul\xe1rio aberto para preenchimento!":40==e.data.info.status?"Este formul\xe1rio est\xe1 aguardando aprova\xe7\xe3o!":null,messageType:"info"}),eY()}).catch(e=>{console.log("\uD83D\uDE80 ~ error:",e),M(!1)})}catch(e){console.log("\uD83D\uDE80 ~ error:",e),M(!1)}},e0=()=>{eT();let e=!1,o=[];null==em||em.forEach((a,t)=>{let n=a.tabela?"fields[".concat(t,"].").concat(a.tabela):"fields[".concat(t,"].").concat(a.nomeColuna),r=e_(n);1!==a.obrigatorio||r||(eU(n,{type:"manual",message:"Campo obrigat\xf3rio"}),o.push(null==a?void 0:a.nomeCampo),e=!0)}),eo&&eo.length>0&&eo.forEach((a,t)=>{a.produtoAnexosDescricao.forEach((n,r)=>{1===n.obrigatorio&&0==n.anexos.length&&(eU("produtos[".concat(t,"].produtoAnexosDescricao[").concat(r,"].anexos"),{type:"manual",message:"Campo obrigat\xf3rio"}),o.push("Anexo: ".concat(null==a?void 0:a.nome," / ").concat(null==n?void 0:n.nome)),e=!0)})}),eg.forEach((a,t)=>{a.itens.forEach((a,n)=>{console.log("\uD83D\uDE80 ~ checkErrors -> item: ",a);let r=e_("blocos[".concat(t,"].itens[").concat(n,"].resposta"));(null==a?void 0:a.obrigatorio)!==1||r||(eU("blocos[".concat(t,"].itens[").concat(n,"].resposta"),{type:"manual",message:"Campo obrigat\xe1rio"}),o.push(null==a?void 0:a.nome),e=!0),a.respostaConfig&&1==a.respostaConfig.anexo&&a.respostaConfig.anexosSolicitados.length>0&&a.respostaConfig.anexosSolicitados.forEach((r,s)=>{1==r.obrigatorio&&r.anexos&&0==r.anexos.length&&(eU("blocos[".concat(t,"].itens[").concat(n,"].respostaConfig.anexosSolicitados[").concat(s,"].anexos"),{type:"manual",message:"Campo obrigat\xe1rio"}),o.push("Anexo: ".concat(null==a?void 0:a.nome," / ").concat(null==r?void 0:r.nome)),e=!0)})})}),et&&et.length>0&&et.forEach((a,t)=>{a.itens.forEach((n,r)=>{1===n.obrigatorio&&0==n.anexos.length&&(console.log("gera erro grupo"),eU("grupoAnexo[".concat(t,"].itens[").concat(r,"].anexos"),{type:"manual",message:"Campo obrigat\xe1rio"}),o.push("Anexo: ".concat(null==a?void 0:a.nome," / ").concat(null==n?void 0:n.nome)),e=!0)})}),ew({status:e,errors:o})},e1=async e=>{if(9===e.length){let o=e.replace(/[^0-9]/g,"");try{let a=await I.h.get("https://viacep.com.br/ws/".concat(o,"/json/"));a.data.localidade?(em.forEach(async(e,o)=>{("logradouro"===e.nomeColuna||"bairro"===e.nomeColuna||"cidade"===e.nomeColuna||"estado"===e.nomeColuna)&&(await ez("fields[".concat(o,"].logradouro"),a.data.logradouro),await ez("fields[".concat(o,"].bairro"),a.data.bairro),await ez("fields[".concat(o,"].cidade"),a.data.localidade),await ez("fields[".concat(o,"].estado"),a.data.uf))}),F.ZP.success("Endere\xe7o encontrado!")):F.ZP.error("Endere\xe7o n\xe3o encontrado!")}catch(t){console.error(t)}}},e8=()=>{e0(),eC(!0),T(!0)},e3=e=>{let o=!0;e.forEach(e=>{e.itens.forEach(e=>{e.respostaConfig&&1==e.respostaConfig.bloqueiaFormulario&&(o=!1)})}),Q(o)},e2=async e=>{e.conclusion=!0,await eW(e4)(e)},e7=(e,o,t)=>{let n=30==e?"Em preenchimento":40==e?"Conclu\xeddo":50==e?"Reprovado":60==e?"Aprovado parcialmente":70==e?"Aprovado":"Pendente",r={titulo:"Formul\xe1rio de Fornecedor ".concat(n),descricao:"O formul\xe1rio de Fornecedor #".concat(a," est\xe1 ").concat(n,"."),url:"/formularios/fornecedor/",urlID:a,tipoNotificacaoID:6,usuarioGeradorID:g.usuarioID,usuarioID:0,unidadeID:P.unidadeID,papelID:1};if(r&&(el(r),o)){let s={titulo:"Fornecedor gerado",descricao:"O formul\xe1rio de Fornecedor #".concat(a," est\xe1 ").concat(n," e gerou uma n\xe3o conformidade."),url:"/formularios/fornecedor/nao-conformidade/",urlID:t,tipoNotificacaoID:5,usuarioGeradorID:g.usuarioID,usuarioID:0,unidadeID:P.unidadeID,papelID:1};el(s)}},e4=async function(e){var o;let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];eM(),!0===t.conclusion&&(e.status=t.status,e.obsConclusao=t.obsConclusao);let n={form:e,auth:{usuarioID:g.usuarioID,profissionalID:null!==(o=g.profissionalID)&&void 0!==o?o:0,papelID:g.papelID,unidadeID:P.unidadeID}};console.log("\uD83D\uDE80 ~ onSubmit: ",n);try{"edit"==eN?(L(!0),await I.h.post("".concat(eq,"/updateData/").concat(a),n).then(o=>{F.ZP.success(b.OD.successUpdate),L(!1),e7(e.status,e.naoConformidade,null)})):"new"==eN?await I.h.post("".concat((0,b.g_)(eq),"/insertData"),n).then(e=>{ek.push("".concat((0,b.g_)(eq))),eA(e.data),F.ZP.success(b.OD.successNew)}):F.ZP.error(b.OD.error)}catch(r){console.log(r)}finally{eV()}},e6=async(e,o)=>{k(!0);let t=e.target.files;if(t&&t.length>0){var n;let r=new FormData;for(let s=0;s<t.length;s++)r.append("files[]",t[s]);r.append("usuarioID",g.usuarioID),r.append("unidadeID",P.unidadeID),r.append("grupoAnexoItemID",null!==(n=o.grupoAnexoItemID)&&void 0!==n?n:null),await I.h.post("".concat(eq,"/saveAnexo/").concat(a,"/grupo-anexo/").concat(g.usuarioID,"/").concat($.unidadeID),r).then(e=>{k(!1);let o=e_();e4(o)}).catch(e=>{var o,a,t;k(!1),F.ZP.error(null!==(t=null===(o=e.response)||void 0===o?void 0:null===(a=o.data)||void 0===a?void 0:a.message)&&void 0!==t?t:"Erro ao atualizar anexo, tente novamente!")})}},e9=async(e,o)=>{z(!0);let t=e.target.files;if(console.log("\uD83D\uDE80 ~ selectedFile:",t),t&&t.length>0){var n,r;let s=new FormData;for(let l=0;l<t.length;l++)s.append("files[]",t[l]);s.append("usuarioID",g.usuarioID),s.append("unidadeID",P.unidadeID),s.append("parRecebimentoMpModeloBlocoID",null!==(n=o.parRecebimentoMpModeloBlocoID)&&void 0!==n?n:null),s.append("itemOpcaoAnexoID",null!==(r=o.itemOpcaoAnexoID)&&void 0!==r?r:null),console.log("\uD83D\uDE80 ~ item:",o),await I.h.post("".concat(eq,"/saveAnexo/").concat(a,"/item/").concat(g.usuarioID,"/").concat($.unidadeID),s).then(e=>{z(!1);let o=e_();e4(o)}).catch(e=>{var o,a,t;z(!1),F.ZP.error(null!==(t=null===(o=e.response)||void 0===o?void 0:null===(a=o.data)||void 0===a?void 0:a.message)&&void 0!==t?t:"Erro ao atualizar anexo, tente novamente!!!!")})}},e5=async e=>{console.log("\uD83D\uDE80 ~ setItemResposta ~ value:",e);try{let o=await I.h.post("/cadastros/item/getItemConfigs",{itemID:e.itemID,alternativaItemID:e.alternativa.id}),a=eg.map(a=>({...a,itens:a.itens.map(a=>a.itemID==e.itemID?(console.log("setItemResposta IGUAL: ",a),{...a,respostaConfig:{...o.data}}):a)}));console.log("\uD83D\uDE80 ~ updatedBlocos:",a),eD(a)}catch(t){console.log("error",t)}},oe=async e=>{e&&await I.h.delete("".concat(eq,"/deleteAnexo/").concat(a,"/").concat(e.anexoID,"/").concat($.unidadeID,"/").concat(g.usuarioID,"/grupo-anexo")).then(e=>{let o=e_();e4(o)}).catch(e=>{var o,a,t;F.ZP.error(null!==(t=null===(o=e.response)||void 0===o?void 0:null===(a=o.data)||void 0===a?void 0:a.message)&&void 0!==t?t:"Erro ao remover anexo, tente novamente!")})},oo=async e=>{e&&await I.h.delete("".concat(eq,"/deleteAnexo/").concat(a,"/").concat(e.anexoID,"/").concat($.unidadeID,"/").concat(g.usuarioID,"/item")).then(e=>{let o=e_();e4(o)}).catch(e=>{var o,a,t;F.ZP.error(null!==(t=null===(o=e.response)||void 0===o?void 0:null===(a=o.data)||void 0===a?void 0:a.message)&&void 0!==t?t:"Erro ao remover anexo, tente novamente!")})};return(0,n.useEffect)(()=>{"edit"==eN&&e$()},[a,G]),(0,n.useEffect)(()=>{e0()},[]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(S.Z,{show:A}),(0,t.jsx)("form",{onSubmit:eW(e4),children:(0,t.jsxs)(u.Z,{display:"flex",flexDirection:"column",sx:{gap:4},children:[eH.message&&(0,t.jsx)(p.Z,{severity:"warning",children:eH.message}),eb&&(0,t.jsxs)(p.Z,{severity:"info",children:["\xdaltima movimenta\xe7\xe3o: Profissional ".concat(eb.nome," do(a) ").concat(eb.nomeFantasia," movimentou o formul\xe1rio de ").concat(eb.statusAnterior," para ").concat(eb.statusAtual," em ").concat(eb.dataHora,"."),eb.observacao&&(0,t.jsxs)("p",{children:[(0,t.jsx)("br",{}),'Mensagem: "',eb.observacao,'"']})]}),eZ&&""!=eZ.cabecalhoModelo&&(0,t.jsx)(x.Z,{children:(0,t.jsx)(m.Z,{children:(0,t.jsx)(f.Z,{variant:"subtitle1",sx:{mb:2},children:eZ.cabecalhoModelo})})}),(0,t.jsxs)(x.Z,{children:[(0,t.jsx)(Z.Z,{btnCancel:!0,btnSave:eZ.status<40,btnSend:eZ.status>=40,btnPrint:"edit"==eN,actionsData:eX,actions:!0,handleSubmit:()=>eW(e4),handleSend:e8,iconConclusion:"mdi:check-bold",titleConclusion:"Concluir Formul\xe1rio",title:"Recebimento de MP",handleBtnStatus:()=>ed(!0),type:eN,status:er}),(0,t.jsx)(m.Z,{children:$&&(0,t.jsxs)(u.Z,{display:"flex",flexDirection:"column",sx:{gap:1},children:[(0,t.jsx)(f.Z,{variant:"caption",sx:{pb:4},children:"Aberto por ".concat(ec.abertoPor.profissional.nome," em ").concat(ec.abertoPor.dataInicio," ").concat(ec.abertoPor.horaInicio," ")}),(0,t.jsx)(H,{modeloID:$.parRecebimentoMpModeloID,values:ec,fornecedor:X,setFornecedor:Y,fields:em,getValues:e_,disabled:!eH.status,register:eB,errors:eJ,setValue:ez,control:eG,getAddressByCep:e1})]})})]}),(0,t.jsx)(x.Z,{children:(0,t.jsx)(m.Z,{children:(0,t.jsx)(B,{recebimentoMpID:a,fornecedorID:e_("fieldsHeader.fornecedor.id"),getValues:e_,setValue:ez,register:eB,control:eG,errors:eJ},G)})}),eg&&eg.map((e,o)=>(0,t.jsx)(l.Z,{index:o,blockKey:"parRecebimentoMpModeloBlocoID",handleFileSelect:e9,setItemResposta:e5,handleRemoveAnexoItem:oo,setBlocos:eD,values:e,control:eG,register:eB,setValue:ez,errors:null==eJ?void 0:eJ.blocos,disabled:!eH.status},o)),et&&et.map((e,o)=>(0,t.jsx)(c.Z,{values:{grupo:e,loadingFile:V,indexGrupo:o,handleFileSelect:e6,handleRemove:oe,folder:"grupo-anexo",disabled:!eH.status,error:eJ}},o)),eZ&&(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(x.Z,{children:(0,t.jsx)(m.Z,{children:(0,t.jsx)(v.ZP,{container:!0,spacing:4,children:(0,t.jsx)(v.ZP,{item:!0,xs:12,md:12,children:(0,t.jsxs)(h.Z,{fullWidth:!0,children:[(0,t.jsx)(f.Z,{variant:"subtitle1",sx:{fontWeight:600,mb:2},children:"Observa\xe7\xf5es (campo de uso exclusivo da validadora)"}),(0,t.jsx)(d.Z,{title:"Observa\xe7\xe3o (opcional)",name:"info.obs",multiline:!0,rows:4,value:eZ.obs,disabled:!eH.status,control:eG})]})})})})})}),$&&ep&&!ep.concluded&&(0,t.jsx)(R,{modeloID:$.parRecebimentoMpModeloID,values:ep,register:eB,disabled:!1,errors:eJ,setValue:ez,control:eG}),ep&&ep.concluded&&(0,t.jsx)(f.Z,{variant:"caption",children:"Conclu\xeddo por ".concat(ep.conclusion.profissional.nome," em ").concat(ep.conclusion.dataFim," ").concat(ep.conclusion.horaFim,".")}),ei&&(0,t.jsx)(i.Z,{title:"Hist\xf3rico do Formul\xe1rio",text:"Listagem do hist\xf3rico das movimenta\xe7\xf5es do formul\xe1rio ".concat(a," do Recebimento de MP."),id:a,parFormularioID:2,formStatus:eZ.status,hasFormPending:U,canChangeStatus:!U&&eZ.status>30,openModal:ei,handleClose:()=>ed(!1),btnCancel:!0,btnConfirm:!0,handleSubmit:changeFormStatus}),(0,t.jsx)(w.Z,{openModal:ey,handleClose(){eC(!1),T(!1)},title:"Concluir Formul\xe1rio",text:"Deseja realmente concluir este formul\xe1rio?",info:eZ,canChange:!U,register:eB,setValue:ez,getValues:e_,btnCancel:!0,btnConfirm:!0,btnConfirmColor:"primary",conclusionForm:e2,listErrors:eE,canApprove:K})]})})]})};var G=z}}]);